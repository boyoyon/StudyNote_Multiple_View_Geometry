<!doctype html>
<html lang="ja">
    <head>
        <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
        <meta charset="utf-8" />
        <title>2章</title>
        <style type="text/css">
            p
            {
                padding-left: 2em;
            }
            .margin-large
            {
                margin-left: 30px;
            }
           .margin-abstract {
               margin-left: 60px; /* 左マージンを広くする */
               margin-right: 60px; /* 右マージンを広くする */
           }
        </style>
    <style>
        .two-columns {
            display: flex;
            flex-direction: row;
            gap: 20px; /* 列間のスペース */
        }
        .column {
            flex: 1; /* 各列が均等に幅を取る */
        }
    </style>
<style>
.three-columns {
  display: flex;
  gap: 10px; /* 列間の余白を設定 */
}
.column {
  flex: 1; /* 各列の幅を均等にする */
  padding: 10px; /* 内側の余白を設定 */
}
</style>
    <style>
        .styleRef { 
            text-indent: -40px; /* 最初の行の字下げを逆方向に */
            margin-left: 10px; /* 2行目以降の字下げを調整 */
            ul {
                  list-style-type: none; /* 箇条書き記号を非表示 */
                  padding-left: 40px; /* 全体の左余白 */
            }
            li {
            }
        }
    </style>
    <style>
        .styleBullet { 
            text-indent: -20px; /* 最初の行の字下げを逆方向に */
            margin-left: 30px; /* 2行目以降の字下げを調整 */
            ul {
                  list-style-type: none; /* 箇条書き記号を非表示 */
                  padding-left: 0px; /* 全体の左余白 */
            }
            li {
            }
        }
    </style>
    <style>
            ol
            {
                margin-left: 30px;
            }
            ul
            {
                margin-left: 30px;
            }
    </style>
    </head>
    <body>
<h1><center>2章 射影幾何学と2次元の変換</center></h1>
<p>
この章では、本書で扱う内容を理解するために必要な主要な幾何学的概念と表記法を紹介します。消失点の形成や円錐曲線の表現など、比較的馴染みのある概念もあれば、円点を用いて画像の遠近法の歪みを除去するなど、より難解な概念もあります。これらの概念は、平面（2次元）の場合の方が視覚的に分かりやすいため、より容易に理解できます。本書の後半で扱う3次元空間の幾何学は、この平面の場合を単純に一般化したものにすぎません。
<!-- This chapter introduces the main geometric ideas and notation that are required to understand
the material covered in this book. Some of these ideas are relatively familiar,
such as vanishing point formation or representing conics, whilst others are more esoteric,
such as using circular points to remove perspective distortion from an image.
These ideas can be understood more easily in the planar (2D) case because they are
more easily visualized here. The geometry of 3-space, which is the subject of the later
parts of this book, is only a simple generalization of this planar case. -->
</p><p>
特に、本章では平面の射影変換の幾何学について解説します。これらの変換は、平面を透視カメラで撮影する際に生じる幾何学的歪みをモデル化します。透視撮影では、共線性（直線は直線として撮影される）などの特定の幾何学的特性は保持されますが、他の特性は保持されません。例えば、平行線は一般に平行線として撮影されません。射影幾何学は、この撮影をモデル化し、計算に適した数学的表現も提供します。
<!-- In particular, the chapter covers the geometry of projective transformations of the
plane. These transformations model the geometric distortion which arises when a plane
is imaged by a perspective camera. Under perspective imaging certain geometric properties
are preserved, such as collinearity (a straight line is imaged as a straight line),
whilst others are not, for example parallel lines are not imaged as parallel lines in
general. Projective geometry models this imaging and also provides a mathematical
representation appropriate for computations.-->
</p><p>
まず、同次表記法による点、直線、円錐曲線の表現と、これらの実体が射影変換の下でどのように写像されるかを説明します。無限遠直線と円点を導入し、これらが平面のアフィン特性と距離特性を捉えていることを示します。次に、平面を平行化するアルゴリズムを示し、画像からアフィン特性と距離特性を計算できるようにします。最後に、射影変換の下での不動点について説明します。
<!-- We begin by describing the representation of points, lines and conics in homogeneous
notation, and how these entities map under projective transformations. The line
at infinity and the circular points are introduced, and it is shown that these capture the
affine and metric properties of the plane. Algorithms for rectifying planes are then
given which enable affine and metric properties to be computed from images. We end
with a description of fixed points under projective transformations. -->
</p>
<h2><center>2.1 平面幾何学</center></h2>
<p>
平面幾何学の基本概念は、たとえ初等レベルであっても数学を学んだ人なら誰でもよく知っています。実際、それらは私たちの日常生活に深く根付いており、当たり前のこととして捉えられています。初等レベルにおいて、幾何学とは点と線、そしてそれらの関係を研究する学問です。
<!-- The basic concepts of planar geometry are familiar to anyone who has studied mathematics
even at an elementary level. In fact, they are so much a part of our everyday
experience that we take them for granted. At an elementary level, geometry is the study
of points and lines and their relationships.-->
</p><p>
純粋主義者にとって、幾何学の研究は「幾何学的」、すなわち座標に依存しない観点から行われるべきである。このアプローチでは、定理は代数を用いない幾何学的プリミティブのみを用いて述べられ、証明される。ユークリッドの古典的なアプローチはこの方法の一例である。しかし、デカルト以来、幾何学は代数化可能であり、実際、幾何学の理論は代数的観点から展開され得ることが明らかにされてきた。本書におけるアプローチは、時には幾何学的手法を用い、時には代数的手法を用いるハイブリッドなアプローチである。代数的アプローチでは、幾何学的実体は座標と代数的実体によって記述される。例えば、点は何らかの座標基底を用いてベクトルと同一視される。直線もまたベクトルと同一視され、円錐曲線（より簡潔に言えば円錐曲線）は対称行列によって表される。実際、この同一視は、少なくとも言語上の便宜上、ベクトルが実際には点であるとか、対称行列が円錐曲線であるなどとまで考えてしまうことがよくあります。幾何学への代数的アプローチの大きな利点は、このようにして得られた結果を用いて、アルゴリズムや実用的な計算手法をより容易に導出できることです。本書では計算とアルゴリズムが主要な関心事であり、それが代数的手法の使用を正当化しています。
<!-- 
To the purist, the study of geometry ought properly to be carried out from a “geometric”
or coordinate-free viewpoint. In this approach, theorems are stated and proved in
terms of geometric primitives only, without the use of algebra. The classical approach
of Euclid is an example of this method. Since Descartes, however, it has been seen that
geometry may be algebraicized, and indeed the theory of geometry may be developed
from an algebraic viewpoint. Our approach in this book will be a hybrid approach,
sometimes using geometric, and sometimes algebraic methods. In the algebraic approach,
geometric entities are described in terms of coordinates and algebraic entities.
Thus, for instance a point is identified with a vector in terms of some coordinate basis.
A line is also identified with a vector, and a conic section (more briefly, a conic) is
represented by a symmetric matrix. In fact, we often carry this identification so far as
to consider that the vector actually is a point, or the symmetric matrix is a conic, at
least for convenience of language. A significant advantage of the algebraic approach
to geometry is that results derived in this way may more easily be used to derive algorithms
and practical computational methods. Computation and algorithms are a major
concern in this book, which justifies the use of the algebraic method.
-->
</p>
<h2><center>2.2 2次元射影平面</center></h2>
<p>
ご存知のとおり、平面上の点は \(\mathbb R^2\) 内の座標対 \((x, y)\) で表すことができます。したがって、平面を \(\mathbb R^2\) と同一視するのが一般的です。\(\mathbb R^2\) をベクトル空間と考えると、座標対 \((x, y)\) はベクトルとなり、点はベクトルとして同一視されます。この節では、平面上の点と直線の同次表記法を紹介します。
<!-- 
As we all know, a point in the plane may be represented by the pair of coordinates
\((x, y)\) in \(\mathbb R^2\). Thus, it is common to identify the plane with \(\mathbb R^2\). Considering \(\mathbb R^2\) as a
vector space, the coordinate pair (x, y) is a vector – a point is identified as a vector. In
this section we introduce the homogeneous notation for points and lines on a plane.
-->
</p><p>
<strong>行ベクトルと列ベクトル</strong>　後ほど、ベクトル空間間の線型写像を考え、そのような写像を行列として表します。通常、行列とベクトルの積は別のベクトル、つまり写像の下の像になります。行列は右側に列ベクトル、左側に行ベクトルを掛けることができるため、「列」ベクトルと「行」ベクトルの区別が重要になります。幾何学的実体は、デフォルトでは列ベクトルで表されます。\(\mathbf x\) などの太字の記号は常に列ベクトルを表し、その転置は行ベクトル \(\mathbf x^T\) です。この規則に従い、平面上の点は、転置である行ベクトル \((x, y)\) ではなく、列ベクトル \((x, y)^T\) で表されます。 \(\mathbf x = (x, y)^T\) と書きます。この式の両辺は列ベクトルを表します。
<!--
<strong>Row and column vectors</strong>　Later on, we will want to consider linear mappings between
vector spaces, and represent such mappings as matrices. In the usual manner, the
product of a matrix and a vector is another vector, the image under the mapping. This
brings up the distinction between “column” and “row” vectors, since a matrix may be
multiplied on the right by a column and on the left by a row vector. Geometric entities
will by default be represented by column vectors. A bold-face symbol such as x always
represents a column vector, and its transpose is the row vector \(\mathbf x^T\). In accordance with
this convention, a point in the plane will be represented by the column vector \((x, y)^T\),
rather than its transpose, the row vector \((x, y)\). We write \(\mathbf x = (x, y)^T\), both sides of this
equation representing column vectors.
-->
</p>
<h3>2.2.1 点と線</h3>
<p>
<strong>直線の同次表現</strong>　平面上の直線は、\(ax+by+c = 0\) のような方程式で表されます。\(a, b\) と \(c\) の取り方によって、直線の型は異なります。したがって、直線は自然にベクトル \((a, b, c)^T\) で表すことができます。直線とベクトル \((a, b, c)^T\) の対応は 1 対 1 ではありません。なぜなら、直線 \(ax + by + c = 0\) と \((ka)x + (kb)y + (kc) = 0\) は、定数 \(k\) が 0 でない任意の値に対して同じだからです。したがって、ベクトル \((a, b, c)^T\) と \(k(a, b, c)^T\) は、\(k\) が 0 でない任意の値に対して同じ直線を表します。実際、全体的なスケーリングによって関連付けられた2つのベクトルは同値であるとみなされます。この同値関係にあるベクトルの同値類は、同次ベクトルと呼ばれます。任意の特定のベクトル \((a, b, c)^T\) は、同値類の代表です。\(\mathbb R^3 − (0, 0, 0)^T\) 内のベクトルの同値類の集合は、射影空間 \(\mathbb P^2\) を形成します。\(−(0, 0, 0)^T\) という表記は、どの直線にも対応しないベクトル \((0, 0, 0)^T\) が除外されることを示します。
<!--
<strong>Homogeneous representation of lines</strong>　A line in the plane is represented by an equation
such as \(ax+by+c = 0\), different choices of \(a, b\) and \(c\) giving rise to different lines.
Thus, a line may naturally be represented by the vector \((a, b, c)^T\). The correspondence
between lines and vectors \((a, b, c)^T\) is not one-to-one, since the lines \(ax + by + c = 0\)
and \((ka)x + (kb)y + (kc) = 0\) are the same, for any non-zero constant k. Thus, the
vectors \((a, b, c)^T\) and \(k(a, b, c)^T\) represent the same line, for any non-zero k. In fact,
two such vectors related by an overall scaling are considered as being equivalent. An
equivalence class of vectors under this equivalence relationship is known as a homogeneous
vector. Any particular vector \((a, b, c)^T\) is a representative of the equivalence
class. The set of equivalence classes of vectors in \(\mathbb R^3 − (0, 0, 0)^T\) forms the projective
space \(\mathbb P^2\). The notation \(−(0, 0, 0)^T\) indicates that the vector \((0, 0, 0)^T\), which does not
correspond to any line, is excluded.
-->
</p><p>
<strong>点の同次表現</strong>　点 \(\mathbf x = (x, y)^T\) が直線 \(\mathbf l = (a, b, c)^T\) 上にある場合と、\(ax + by + c = 0\) が成り立つ場合とは同値です。これは、点を表すベクトルの内積として \((x, y, 1)(a, b, c)^T = (x, y, 1)\mathbf l = 0\) と表すことができます。つまり、\(\mathbb R^2\) 内の点 \((x, y)^T\) は、最終座標に 1 を加えた 3 次元ベクトルとして表されます。
任意の非ゼロ定数 \(k\) と直線 \(\mathbf l\) に対して、方程式 \((kx, ky, k)\mathbf l = 0\) が成り立つのは、\((x, y, 1)\mathbf l = 0\) の場合に限ります。したがって、\(k\) の値を変化させた場合のベクトルの集合 \((kx, ky, k)^T\) を、\(\mathbb R^2\) 内の点 \((x, y)^T\) の表現と考えるのが自然です。このように、直線と同様に、点は同次ベクトルで表されます。点を表す任意の同次ベクトルは、\(\mathbf x = (x_1, x_2, x_3)^T\) という形をとり、\(\mathbb R^2\) における点 \((x_1/x_3, x_2/x_3)^T\) を表します。したがって、同次ベクトルとしての点は、\(\mathbb P^2\) の要素でもあります。
点が直線上にあるかどうかを判断する簡単な式があります。
<!--
<strong>Homogeneous representation of points</strong>　A point \(\mathbf x = (x, y)^T\) lies on the line \(\mathbf l =
(a, b, c)^T\) if and only if \(ax + by + c = 0\). This may be written in terms of an inner
product of vectors representing the point as \((x, y, 1)(a, b, c)^T = (x, y, 1)\mathbf l = 0\); that is
the point \((x, y)^T\) in \(\mathbb R^2\) is represented as a 3-vector by adding a final coordinate of 1.
Note that for any non-zero constant \(k\) and line \(\mathbf l\) the equation \((kx, ky, k)\mathbf l = 0\) if and
only if \((x, y, 1)\mathbf l = 0\). It is natural, therefore, to consider the set of vectors \((kx, ky, k)^T\) for varying values of \(k\) to be a representation of the point \((x, y)^T\) in \(\mathbb R^2\). Thus, just as
with lines, points are represented by homogeneous vectors. An arbitrary homogeneous
vector representative of a point is of the form \(\mathbf x = (x_1, x_2, x_3)^T\), representing the point
 \((x_1/x_3, x_2/x_3)^T\) in \(\mathbb R^2\). Points, then, as homogeneous vectors are also elements of \(\mathbb P^2\).
One has a simple equation to determine when a point lies on a line, namely
-->
</p><p>
<strong>結果 2.1</strong>　点 \(\mathbf x\) が直線 \(\mathbf l\) 上にあるのは、\(\mathbf x^T{\mathbf l} = 0\) の場合のみです。
<!--
<strong>Result 2.1</strong>　The point \(\mathbf x\) lies on the line \(\mathbf l\) if and only if \(\mathbf x^T{\mathbf l} = 0\).
-->
</p><p>
式 \(\mathbf x^T\mathbf l\) は、2 つのベクトル \(\mathbf l\) と \(\mathbf x\) の内積またはスカラー積にすぎないことに注意してください。スカラー積は \(\mathbf x^T\mathbf l = \mathbf l^T\mathbf x = \mathbf x.\mathbf l\) です。一般に、転置表記 \(\mathbf l^T\mathbf x\) が好まれますが、内積を表すためにドット \(.\) を使用することもあります。点の同次座標 \(\mathbf x = (x_1, x_2, x_3)^T\) は3次元ベクトルであり、非同次座標 \((x, y)^T\) は2次元ベクトルであると区別します。
<!--
Note that the expression \(\mathbf x^T\mathbf l\) is just the inner or scalar product of the two vectors \(\mathbf l\) and \(\mathbf x\). The scalar product \(\mathbf x^T\mathbf l = \mathbf l^T\mathbf x = \mathbf x.\mathbf l\). In general, the transpose notation \(\mathbf l^T\mathbf x\) will be preferred, but occasionally, we will use a \(.\) to denote the inner product. We
distinguish between the homogeneous coordinates \(\mathbf x = (x_1, x_2, x_3)^T\) of a point, which
is a 3-vector, and the inhomogeneous coordinates \((x, y)^T\), which is a 2-vector.
-->
</p><p>
<strong>自由度 (dof)</strong>　点を指定するには、その \(x\) 座標と \(y\) 座標という 2 つの値を指定する必要があることは明らかです。同様に、直線は 2 つのパラメータ (2 つの独立した比 \(\{a : b : c\})\) によって指定されるため、2 つの自由度を持ちます。例えば、非同次表現では、これらの 2 つのパラメータは直線の傾きと \(y\) 切片として選択できます。
<!--
<strong>Degrees of freedom (dof)</strong>　It is clear that in order to specify a point two values must
be provided, namely its \(x\)- and \(y\)-coordinates. In a similar manner a line is specified
by two parameters (the two independent ratios \(\{a : b : c\})\) and so has two degrees
of freedom. For example, in an inhomogeneous representation, these two parameters
could be chosen as the gradient and y intercept of the line.
-->
</p><p>
<strong>直線の交点</strong>　2本の直線 \(\mathbf l = (a, b, c)^T\) と \(\mathbf l^\prime = (a^\prime, b^\prime, c^\prime)^T\) が与えられており、それらの交点を求めます。ベクトル \(\mathbf x = \mathbf l×\mathbf l^\prime\) を定義します。ここで、\(×\) はベクトル積または外積を表します。三重スカラー積の恒等式 \(\mathbf l.(\mathbf l ×\mathbf l^\prime) = \mathbf l^\prime.(\mathbf l × \mathbf l^\prime) = 0\) から、\(\mathbf l^T\mathbf x = {\mathbf l^\prime}^T\mathbf x = 0\) であることがわかります。したがって、\(\mathbf x\) が点を表すと考えられる場合、\(\mathbf x\) は直線 \(\mathbf l\) と \(\mathbf l^\prime\) の両方に存在し、したがって 2 本の直線の交点になります。これは次のことを示しています。
<!--
<strong>Intersection of lines</strong>　Given two lines \(\mathbf l = (a, b, c)^T\) and \(\mathbf l^\prime = (a^\prime, b^\prime, c^\prime)^T\), we wish to
find their intersection. Define the vector \(\mathbf x = \mathbf l×\mathbf l^\prime\), where \(×\) represents the vector or
cross product. From the triple scalar product identity \(\mathbf l.(\mathbf l ×\mathbf  l^\prime) = \mathbf l^\prime.(\mathbf l × \mathbf l^\prime) = 0\), we
see that \(\mathbf l^T\mathbf x = {\mathbf l^\prime}^T\mathbf x = 0\). Thus, if \(\mathbf x\) is thought of as representing a point, then \(\mathbf x\) lies on
both lines \(\mathbf l\) and \(\mathbf l^\prime\), and hence is the intersection of the two lines. This shows:
-->
</p><p>
<strong>結果 2.2</strong>　2直線 \(\mathbf l\) と \(\mathbf l^\prime\) の交点は点 \(\mathbf x = \mathbf l × \mathbf l^\prime\) です。
<!--
<strong>Result 2.2</strong>　The intersection of two lines \(\mathbf l\) and \(\mathbf l^\prime\) is the point \(\mathbf x = \mathbf l × \mathbf l^\prime\).
-->
</p><p>
2本の直線の交点を表すこの表現が単純であるのは、直線と点の同次ベクトル表現を使用しているためであることに注意してください。
<!--
Note that the simplicity of this expression for the intersection of the two lines is a direct
consequence of the use of homogeneous vector representations of lines and points.
-->
</p><p>
<strong>例 2.3</strong>　直線 \(x = 1\) と \(y = 1\) の交点を求める簡単な問題を考えてみましょう。直線 \(x = 1\) は \(-1x + 1 = 0\) と等価であり、したがって同次表現 \(\mathbf l = (-1, 0, 1)^T\) となります。直線 \(y = 1\) は \(-1y+1 =
0\) と等価であり、したがって同次表現 \(\mathbf l^\prime = (0,-1, 1)^T\) となります。結果 2.2 から、交点は
<!--
<strong>Example 2.3</strong>　Consider the simple problem of determining the intersection of the lines
\(x = 1\) and \(y = 1\). The line \(x = 1\) is equivalent to \(-1x + 1 = 0\), and thus has
homogeneous representation \(\mathbf l = (-1, 0, 1)^T\). The line \(y = 1\) is equivalent to \(-1y+1 =
0\), and thus has homogeneous representation \(\mathbf l^\prime = (0,-1, 1)^T\). From result 2.2 the
intersection point is
-->
\[
\mathbf x = \mathbf l × \mathbf l^\prime =
\begin{vmatrix}
i & j & k \\
-1 & 0 & 1 \\
0 & -1 & 1
\end{vmatrix}
=
\begin{pmatrix}
1 \\
1 \\
1
\end{pmatrix}
\]
これは要求通り、非同次点 \((1, 1)^T\) です。△
</p><p>
(ここから蛇足) ･･･ 3×3行列式の復習
</p><p>
<center><img src="images/fig2_0.png"></center>
</p><p>
(ここまで蛇足)
</p><p>
<strong>点を結ぶ直線</strong>　2点 \(\mathbf x\) と \(\mathbf x^\prime\) を通る直線の式は、全く同様の議論によって導かれます。直線 \(\mathbf l\) を \(\mathbf l= \mathbf x ×\mathbf x^\prime\) で定義すると、点 \(\mathbf x\) と \(\mathbf x^\prime\) の両方が \(\mathbf l\) 上にあることが証明されます。したがって、
<!--
which is the inhomogeneous point \((1, 1)^T\) as required. △
</p><p>
<strong>Line joining points</strong>　An expression for the line passing through two points \(\mathbf x\) and \(\mathbf x^\prime\) may be derived by an entirely analogous argument. Defining a line \(\mathbf l\) by \(\mathbf l\) = \mathbf x ×\mathbf  x^\prime\), it may be verified that both points \(x\) and \(x^\prime\) lie on \(\mathbf l\). Thus
-->
</p><p>
<strong>結果 2.4</strong>　2点 \(\mathbf x\) と \(\mathbf x^\prime\) を通る直線は \(\mathbf l = \mathbf x × \mathbf x^\prime\) です。
<!--
<strong>Result 2.4</strong>　The line through two points \(\mathbf x\) and \(\mathbf x^\prime\) is \(\mathbf l = \mathbf x × \mathbf x^\prime\).
-->
</p><p>
<h3>2.2.2 理想点と無限遠直線</h3>
</p><p>
<strong>平行線の交点</strong>　2本の直線 \(ax+by+c = 0\) と \(ax+by+c^\prime = 0\) を考えます。
これらはベクトル \(\mathbf l = (a, b, c)^T\) と \(\mathbf l^\prime = (a, b, c^\prime)^T\) で表され、最初の2つの座標は同じです。
結果2.2を用いれば、これらの直線の交点は容易に計算できます。交点は \(\mathbf l × \mathbf l^\prime = (c^\prime − c)(b,−a, 0)^T\) であり、スケール係数 \((c^\prime − c)\) を無視すると、点 \((b,−a, 0)^T\) となります。
</p><p>
(ここから蛇足) ･･･ 3×3行列式の復習(2)
</p><p>
<center><img src="images/fig2_02.png"></center>
</p><p>
(ここまで蛇足) 
<!--
<strong>Intersection of parallel lines</strong>　Consider two lines \(ax+by+c = 0)\) and \(ax+by+c^\prime = 0\).
These are represented by vectors \(\mathbf l = (a, b, c)^T\) and \(\mathbf l^\prime = (a, b, c^\prime)^T\) for which the first two
coordinates are the same. Computing the intersection of these lines gives no difficulty,
using result 2.2. The intersection is \(\mathbf l × \mathbf l^\prime = (c^\prime − c)(b,−a, 0)^T\), and ignoring the scale
factor \((c^\prime − c)\), this is the point \((b,−a, 0)^T\).
-->
</p><p>
さて、この点の非同次表現を求めると、\((b/0,−a/0)^T\) という式が得られます。これは、交点が無限大の座標を持つという以外には意味をなさない表現です。一般に、同次座標を持つ点
\((x, y, 0)^T\) は、\(\mathbb R^2\) 内のどの有限点にも対応しません。この観察結果は、平行線は無限遠点で交わるという一般的な考えと一致します。
<!--
Now if we attempt to find the inhomogeneous representation of this point, we obtain
\((b/0,−a/0)^T\), which makes no sense, except to suggest that the point of intersection
has infinitely large coordinates. In general, points with homogeneous coordinates
\((x, y, 0)^T\) do not correspond to any finite point in \(\mathbb R^2\). This observation agrees with the
usual idea that parallel lines meet at infinity.
-->
</p><p>
<strong>例 2.5</strong>　2本の直線 \(x = 1\) と \(x = 2\) を考える。ここで2本の直線は平行であり、したがって「無限遠点」で交わる。同次記法では、これらの直線は \(\mathbf l =(-1, 0, 1)^T, \mathbf l^\prime = (-1, 0, 2)^T\) であり、結果 2.2 から、それらの交点は
<!--
<strong>Example 2.5</strong>　Consider the two lines \(x = 1\) and \(x = 2\). Here the two lines are parallel,
and consequently intersect “at infinity”. In homogeneous notation the lines are \(\mathbf l =(-1, 0, 1)^T, \mathbf l^\prime = (-1, 0, 2)^T\), and from result 2.2 their intersection point is
-->
\[
\mathbf x=\mathbf l\times \mathbf l^\prime=
\begin{vmatrix}
i & j & k \\
-1 & 0 & 1 \\
-1 & 0 & 2
\end{vmatrix}
=
\begin{pmatrix}
0 \\
1 \\
0
\end{pmatrix}
\]
これは\(y\)軸方向の無限遠点である。△
<!--
which is the point at infinity in the direction of the \(y\)-axis. △
-->
</p><p>
<strong>理想点と無限遠直線</strong>　\(x_3\neq 0\) となるような同次ベクトル \(\mathbf x = (x_1, x_2, x_3)^T\) は、\(\mathbb R^2\) 内の有限点に対応する。\(\mathbb R^2\) に、最後の座標 \(x_3 = 0\) の点を追加することで拡張できる。結果として得られる空間は、すべての同次 3 次元ベクトルの集合、つまり射影空間 \(\mathbb P^2\) である。最後の座標 \(x_3 = 0\) の点は、理想点または無限遠点と呼ばれる。すべての理想点の集合は、\((x_1, x_2, 0)^T\) と表記され、特定の点は比 \(x_1 : x_2\) で指定される。この集合は、ベクトル \(\mathbf l_∞ = (0, 0, 1)^T\) で表される単一の直線、すなわち無限遠直線上にあることに注意してください。実際、\((0, 0, 1)(x_1, x_2, 0)^T = 0\) であることが証明されています。
<!--
<strong>Ideal points and the line at infinity</strong>　Homogeneous vectors \(\mathbf x = (x_1, x_2, x_3)^T\) such that \(x_3\neq 0\)  correspond to finite points in \(\mathbb R^2\). One may augment \(\mathbb R^2\) by adding points
with last coordinate \(x_3 = 0\). The resulting space is the set of all homogeneous 3-vectors, namely the projective space \(\mathbb P^2\). The points with last coordinate \(x_3 = 0\) are known as ideal points, or points at infinity. The set of all ideal points may be written
\((x_1, x_2, 0)^T\), with a particular point specified by the ratio \(x1 : x2\). Note that this set lies
on a single line, the line at infinity, denoted by the vector \(\mathbf l_∞ = (0, 0, 1)^T\). Indeed, one verifies that \((0, 0, 1)(x_1, x_2, 0)^T = 0\).
-->
</p><p>
結果2.2を用いると、直線\(\mathbf l = (a, b, c)^T\)は理想点\((b,−a, 0)^T\)で\(\mathbf l_∞\)と交差することがわかります（\((b,−a, 0)\mathbf l = 0\)であるため）。\(\mathbf l\)に平行な直線\(\mathbf l^\prime = (a, b, c^\prime)^T\)は、\(c^\prime\)の値に関わらず、同じ理想点((b,−a, 0)^T\)で\(\mathbf l_∞\)と交差します。非同次記法では、\((b,−a)^T\) は直線に接するベクトルであり、直線の法線 \((a, b)\) に直交するため、直線の方向を表します。直線の方向が変化すると、理想点 \((b,−a, 0)^T\) は \(\mathbf l_∞\) にわたって変化します。これらの理由から、無限遠直線は平面における直線の方向の集合と考えることができます。
<!--
Using result 2.2 one finds that a line \(\mathbf l = (a, b, c)^T\) intersects \(\mathbf l_∞\) in the ideal point
\((b,−a, 0)^T\) (since \((b,−a, 0)\mathbf l = 0\)). A line \(\mathbf l^\prime = (a, b, c^\prime)^T\) parallel to \(\mathbf l\) intersects \(\mathbf l_∞\) in the same ideal point((b,−a, 0)^T\) irrespective of the value of \(c^\prime\). In inhomogeneous
notation \((b,−a)^T\) is a vector tangent to the line, and orthogonal to the line normal \((a, b)\), and so represents the line's direction. As the line's direction varies the ideal point \((b,−a, 0)^T\) varies over \(\mathbf l_∞\). For these reasons the line at infinity can be thought of
as the set of directions of lines in the plane.
-->
</p><p>
無限遠点の概念の導入によって、点と直線の交差特性がいかに簡素化されているかに注目してください。射影平面 \(\mathbb P^2\) においては、異なる2本の直線が1点で交わり、異なる2本の点が1本の直線上にあると、何の制約もなく述べることができます。しかし、これは標準的なユークリッド幾何学である \(\mathbb R^2\) では当てはまりません。この幾何学では、平行線は特別なケースとなります。
<!--
Note how the introduction of the concept of points at infinity serves to simplify the intersection properties of points and lines. In the projective plane \(\mathbb P^2\), one may state without qualification that two distinct lines meet in a single point and two distinct points lie on a single line. This is not true in the standard Euclidean geometry of \(\mathbb R^2\), in which parallel lines form a special case.
-->
</p>
<center><img src="images/fig2_1.png"></center>
<p>
図2.1. 射影平面のモデル。\(\mathbb P^2\)上の点と直線は、それぞれ\(\mathbb R^3\)上の原点を通る直線と平面で表される。\(x_1x_2\)平面上の直線は理想点を表し、\(x_1x_2\)平面は\(\mathbf l_∞\)を表す。
<!--
Fig. 2.1. A model of the projective plane. Points and lines of \(\mathbb P^2\) are represented by rays and planes, respectively, through the origin in  \(\mathbb R^3\). Lines lying in the \(x_1x_2\)-plane represent ideal points, and the \(x_1x_2\)-plane represents \(\mathbf l_∞\).
-->
</p><p>
\(\mathbb P^2\) の幾何学の研究は射影幾何学として知られています。座標に依存しない純粋に幾何学的な射影幾何学の研究では、無限遠点（理想点）と通常の点を区別しません。しかし、本書では、理想点と非理想点を区別することが目的に役立つ場合があります。そのため、無限遠直線は射影空間における特別な直線とみなされることがあります。
<!--
The study of the geometry of \(\mathbb P^2\) is known as projective geometry. In a coordinatefree purely geometric study of projective geometry, one does not make any distinction between points at infinity (ideal points) and ordinary points. It will, however, serve our purposes in this book sometimes to distinguish between ideal points and non-ideal
points. Thus, the line at infinity will at times be considered as a special line in projective
space.
-->
</p><p>
<strong>射影平面のモデル</strong>　\(\mathbb P^2\) を考える上で有効な方法は、\(\mathbb R^3\) 内の半直線の集合として考えることです。\(k\) が変化するとき、すべてのベクトル \(k(x_1, x_2, x_3)^T\) の集合は、原点を通る半直線を形成します。このような半直線は、\(\mathbb P^2\) 内の一点を表すものと考えることができます。このモデルでは、\(\mathbb P^2\) 内の直線は原点を通る平面です。2 つの異なる半直線は 1 つの平面上にあり、任意の 2 つの平面は 1 つの半直線で交差することが証明されます。これは、2 つの異なる点が一意に直線を定義し、2 つの直線が常に 1 つの点で交差することと同じです。
<!--
<strong>A model for the projective plane</strong>　A fruitful way of thinking of \(\mathbb P^2\) is as a set of rays in \(\mathbb R^3\). The set of all vectors \(k(x_1, x_2, x_3)^T\) as \(k\) varies forms a ray through the origin. Such a ray may be thought of as representing a single point in \(\mathbb P^2\). In this model, the lines in \(\mathbb P^2\) are planes passing through the origin. One verifies that two nonidentical
rays lie on exactly one plane, and any two planes intersect in one ray. This
is the analogue of two distinct points uniquely defining a line, and two lines always
intersecting in a point.
-->
</p><p>
点と直線は、この光線と平面の集合を平面 \(x_3 = 1\) と交差させることで得られます。図 2.1 に示すように、理想点を表す光線と \(\mathbf l_∞\) を表す平面は平面 \(x_3 = 1\) に平行です。
<!--
Points and lines may be obtained by intersecting this set of rays and planes by the
plane \(x_3 = 1\). As illustrated in figure 2.1 the rays representing ideal points and the
plane representing \(\mathbf l_∞\) are parallel to the plane \(x_3 = 1\).
-->
</p><p>
<strong>双対性</strong>　読者は、直線と点の性質に関する記述において、点と直線の役割が入れ替わる場合があることにお気づきでしょう。特に、直線と点の基本接続方程式 \(\mathbf l^T\mathbf x\) = 0 は対称的です。\(\mathbf l^T\mathbf x = 0\) は \(\mathbf x^T\mathbf l = 0\) を意味し、直線と点の位置が入れ替わるからです。同様に、2直線の交点と2点を通る直線を示す結果2.2と結果2.4は、点と直線の役割が入れ替わっているだけで、本質的には同じです。一般的な原理である双対性原理は、次のように表現できます。
<!--
<strong>Duality</strong>　The reader has probably noticed how the role of points and lines may be interchanged in statements concerning the properties of lines and points. In particular,
the basic incidence equation \(\mathbf l^T\mathbf x\) = 0 for line and point is symmetric, since \(\mathbf l^T\mathbf x = 0\) implies \(\mathbf x^T\mathbf l = 0\), in which the positions of line and point are swapped. Similarly, result 2.2 and result 2.4 giving the intersection of two lines and the line through two points are essentially the same, with the roles of points and lines swapped. One may enunciate a general principle, the duality principle as follows:
-->
</p><p>
<strong>結果 2.6</strong>　双対性原理。2次元射影幾何学の任意の定理には双対定理が対応しており、これは元の定理における点と線の役割を入れ替えることで導くことができる。
<!--
<strong>Result 2.6</strong>　Duality principle. To any theorem of 2-dimensional projective geometry there corresponds a dual theorem, which may be derived by interchanging the roles of points and lines in the original theorem.
-->
</p><p>
この原理を適用する際には、入射の概念も適切に翻訳する必要があります。例えば、2点を通る直線は、2直線の交点を通る点と双対です。
<!--
In applying this principle, concepts of incidence must be appropriately translated as well. For instance, the line through two points is dual to the point through (that is the point of intersection of) two lines.
-->
</p><p>
元の定理が証明された後は、与えられた定理の双対を証明する必要はないことに注意してください。双対定理の証明は、元の定理の証明の双対となります。
<!--
Note that is it not necessary to prove the dual of a given theorem once the original theorem has been proved. The proof of the dual theorem will be the dual of the proof of the original theorem.
-->
</p><p>
<h3>2.2.3 円錐曲線と双円錐曲線</h3>
<!--
<h3>2.2.3 Conics and dual conics</h3>
-->
</p><p>
円錐曲線は、平面上の2次方程式で記述される曲線です。ユークリッド幾何学では、円錐曲線には主に3つの種類があります。双曲線、楕円、放物線です（いわゆる退化円錐曲線は後で定義されます）。古典的には、これら3種類の円錐曲線は、異なる向きの平面によって生成される円錐曲線断面として生じます（退化円錐曲線は円錐の頂点を含む平面から生じます）。しかし、2次元射影幾何学では、退化していない円錐曲線はすべて射影変換に関して同値であることが分かります。
<!--
A conic is a curve described by a second-degree equation in the plane. In Euclidean
geometry conics are of three main types: hyperbola, ellipse, and parabola (apart from
so-called degenerate conics, to be defined later). Classically these three types of conic
arise as conic sections generated by planes of differing orientation (the degenerate conics
arise from planes which contain the cone vertex). However, it will be seen that
in 2D projective geometry all non-degenerate conics are equivalent under projective
transformations.
-->
</p><p>
非同次座標における円錐曲線の方程式は
<!--
The equation of a conic in inhomogeneous coordinates is
-->
\[
ax^2 + bxy + cy^2 + dx + ey + f = 0
\]
つまり2次の多項式です。これを置換によって「同次化」すると、
<!--
i.e. a polynomial of degree 2. “Homogenizing” this by the replacements:
-->
\[
\begin{align}
x\mapsto x_1/x_3, y\mapsto &x_2/x_3\;gives \\
&ax_1^2 + bx_1x_2 + cx_2^2 + dx_1x_3 + ex_2x_3 + fx_3^2 = 0 \tag{2.1}
\end{align}
\]
または行列形式で
<!--
or in matrix form
-->
\[
\mathbf x^TC\mathbf x = 0 \tag{2.2}
\]
ここで円錐係数行列\(C\)は次のように与えられる。
<!--
where the conic coefficient matrix \(C\) is given by
-->
\[
C =
\begin{bmatrix}
a & b/2 & d/2 \\
b/2 & c & e/2 \\
d/2 & e/2 & f
\end{bmatrix}
\tag{2.3}
\]
円錐曲線の係数行列は対称であることに注意してください。点や直線の同次表現の場合と同様に、行列要素の比のみが重要です。\(C\) に非ゼロのスカラーを乗じても上記の式には影響しません。したがって、\(C\) は円錐曲線の同次表現です。円錐曲線には5つの自由度があり、これは \(\{a : b : c : d : e : f\}\) の比、つまり対称行列の6つの要素からスケール分の1を引いたものと考えることができます。
<!--
Note that the conic coefficient matrix is symmetric. As in the case of the homogeneous
representation of points and lines, only the ratios of the matrix elements are important,
since multiplying \(C\) by a non-zero scalar does not affect the above equations. Thus \(C\) is
a homogeneous representation of a conic. The conic has five degrees of freedom which
can be thought of as the ratios \(\{a : b : c : d : e : f\}\) or equivalently the six elements of
a symmetric matrix less one for scale.
-->
</p><p>
<strong>5点が円錐曲線を定義する</strong>　点の集合xiを通る円錐曲線を計算したいとする。円錐曲線が一意に決定されるまでに、いくつの点を指定できるだろうか？この問いは、円錐曲線を決定するアルゴリズムを提供することで建設的に答えることができる。(2.1)から、各点xiは円錐曲線の係数に1つの制約を課す。円錐曲線が\((x_i, y_i)\)を通る場合、
<!--
<strong>Five points define a conic</strong>　Suppose we wish to compute the conic which passes
through a set of points, xi. How many points are we free to specify before the conic
is determined uniquely? The question can be answered constructively by providing an
algorithm to determine the conic. From (2.1) each point xi places one constraint on the
conic coefficients, since if the conic passes through \((x_i, y_i)\) then
-->
\[
ax_i^2 + bx_iy_i + cy_i^2 + dx_i + ey_i + f = 0
\]
この制約は次のように書ける。
<!--
This constraint can be written as
-->
\[
\left(x_i^2　x_iy_i　y_i^2　x_i　y_i　1\right)c=0
\]
ここで、\(c = (a, b, c, d, e, f)^T\) は 6 ベクトルとして表される円錐曲線 \(C\) です。
<!--
where \(c = (a, b, c, d, e, f)^T\) is the conic \(C\) represented as a 6-vector.
-->
</p><p>
制約を5つの点から積み重ねると、
<!--
Stacking the constraints from five points we obtain
-->
\[
\begin{bmatrix}
x_1^2 & x_1y_1 & y_1^2 & x_1 & y_1 & 1 \\
x_2^2 & x_2y_2 & y_2^2 & x_2 & y_2 & 1 \\
x_3^2 & x_3y_3 & y_3^2 & x_3 & y_3 & 1 \\
x_4^2 & x_4y_4 & y_4^2 & x_4 & y_4 & 1 \\
x_5^2 & x_5y_5 & y_5^2 & x_5 & y_5 & 1 \\
\end{bmatrix}
c=0
\tag{2.4}
\]
そして、円錐曲線はこの5×6行列の零ベクトルです。これは、円錐曲線が（スケールに応じて）一般的な位置にある5点によって一意に決定されることを示しています。零空間を決定することによって幾何学的実体（または関係）をフィッティングする方法は、本書の計算に関する章で頻繁に使用されます。
<!--
and the conic is the null vector of this 5 × 6 matrix. This shows that a conic is determined
uniquely (up to scale) by five points in general position. The method of fitting
a geometric entity (or relation) by determining a null space will be used frequently in
the computation chapters throughout this book.
-->
</p><p>
<strong>円錐曲線の接線</strong>　円錐曲線の点 \(\mathbf x\) における接線 \(\mathbf l\) は、同次座標において特に単純な形をとります。
<!--
<strong>Tangent lines to conics</strong>　The line \(\mathbf l\) tangent to a conic at a point \(\mathbf x\) has a particularly
simple form in homogeneous coordinates:
-->
</p><p>
<strong>結果 2.7</strong>　\(C\) 上の点 \(\mathbf x\) における \(C\) の接線 \(\mathbf l\) は \(\mathbf l = C\mathbf x\) で与えられる。
<!--
<strong>Result 2.7</strong>　The line \(\mathbf l\) tangent to \(C\) at a point \(\mathbf x\) on \(C\) is given by \(\mathbf l = C\mathbf x\).
-->
</p><p>
<strong>証明</strong>　直線 \(\mathbf l = C\mathbf x\) は \(\mathbf x\) を通ります。\(\mathbf l^T\mathbf x = \mathbf x^TC\mathbf x = 0\) です。\(\mathbf l\) が円錐曲線と 1 点で接する場合、それは接線であり、これで終わりです。そうでない場合、\(\mathbf l\) が円錐曲線と別の点 \(\mathbf y\) で接するとします。その場合、\(\mathbf y^TC\mathbf y\) = 0\) かつ \(\mathbf x^TC\mathbf y = \mathbf l^T\mathbf y = 0\) となります。このことから、すべての \(α\) に対して \((\mathbf x + α\mathbf y)^TC(\mathbf x + α\mathbf y) = 0\) が成り立ちます。これは、\(\mathbf x\) と \(\mathbf y\) を結ぶ直線 \(\mathbf l = C\mathbf x\) 全体が円錐曲線 \(C\) 上にあり、したがって円錐曲線は退化していることを意味します (以下を参照)。
<!--
<strong>Proof</strong>　The line \(\mathbf l = C\mathbf x\) passes through \(\mathbf x\), since \(\mathbf l^T\mathbf x = \mathbf x^TC\mathbf x = 0\). If \(\mathbf l\) has one-point contact with the conic, then it is a tangent, and we are done. Otherwise suppose that \(\mathbf l\) meets the conic in another point \(\mathbf y\). Then \(\mathbf y^TC\mathbf y\) = 0\) and \8\mathbf x^TC\mathbf y = \mathbf l^T\mathbf y = 0\). From this it follows that \((\mathbf x + α\mathbf y)^TC(\mathbf x + α\mathbf y) = 0\) for all \(α\), which means that the whole line
\(\mathbf l = C\mathbf x\) joining \(\mathbf x\) and \(\mathbf y\) lies on the conic \(C\), which is therefore degenerate (see below).
-->
</p><p>
<strong>双対円錐曲線</strong>　上で定義した円錐曲線 \(C\) は、点上の方程式を定義するため、より正確には点円錐曲線と呼ばれます。\(\mathbb P^2\) の双対性の結果 2.6 を考慮すると、直線上の方程式を定義する円錐曲線も存在することは驚くべきことではありません。この双対（または直線）円錐曲線は 3 × 3 行列でも表され、これを C∗ と表記します。円錐曲線 C に接する直線 l は、lTC∗l = 0 を満たします。C∗ という表記は、\(C^∗\) が \(C\) の随伴行列であることを示します（随伴行列は付録 4 のセクション A4.2 で定義されています）。特異でない対称行列 \(C^∗ = C−1\) の場合（スケールまで）。
<!--
<strong>Dual conics</strong>　The conic \(C\) defined above is more properly termed a point conic, as it defines an equation on points. Given the duality result 2.6 of \(\mathbb P^2\) it is not surprising that there is also a conic which defines an equation on lines. This dual (or line) conic
is also represented by a 3 × 3 matrix, which we denote as C∗. A line l tangent to the
conic C satisfies lTC∗l = 0. The notation C∗ indicates that \(C^∗\) is the adjoint matrix of \(C\) (the adjoint is defined in section A4.2 of appendix 4). For a non-singular symmetric matrix \(C^∗ = C−1\) (up to scale).
-->
</p><p>
双対円錐曲線の方程式は、\(C\) がフルランクの場合、簡単に導出できます。結果2.7から、\(C\) 上の点 \(\mathbf x\) における接線は \(\mathbf l = C\mathbf x\) です。これを反転すると、直線 \(\mathbf l\) が \(C\) に接する点 \(\mathbf x\) は \(\mathbf x = C^{−1}\mathbf l\) であることがわかります。 \(\mathbf x\) は \(\mathbf x^TC\mathbf x\) = 0\) を満たすので、\((C^{−1}\mathbf l)^TC(C^{−1}\mathbf l) = \mathbf l^TC^{−1}\mathbf l = 0\) が得られ、これは \(C\) が対称であるため、\(C^{−T} = C^{−1}\) から導かれる最後のステップです。
<!--
The equation for a dual conic is straightforward to derive in the case that \(C\) has full rank: From result 2.7, at a point \(\mathbf x\) on \(C\) the tangent is \(\mathbf l = C\mathbf x\). Inverting, we find the
point \(\mathbf x\) at which the line \(\mathbf l\) is tangent to \(C\) is \(\mathbf x = C^{−1}\mathbf l\). Since \(\mathbf x\) satisfies \(\mathbf x^TC\mathbf x\) = 0\) we obtain \((C^{−1}\mathbf l)^TC(C^{−1}\mathbf l) = \mathbf l^TC^{−1}\mathbf l = 0\), the last step following from \(C^{−T} = C^{−1}\) because \(C\) is symmetric.
-->
</p><p>
双円錐曲線は円錐包絡線とも呼ばれ、その理由は図2.2に示されています。双円錐曲線は5つの自由度を持ちます。点円錐曲線を定義する点と同様に、一般的な位置にある5本の直線が双円錐曲線を定義します。
<!--
Dual conics are also known as conic envelopes, and the reason for this is illustrated in figure 2.2. A dual conic has five degrees of freedom. In a similar manner to points defining a point conic, it follows that five lines in general position define a dual conic.
-->
</p>
<center><img src="images/fig2_2.png"></center>
<p>
図2.2. (a) \(\mathbf x^TC\mathbf x = 0\) を満たす点 x は円錐点上にある。(b) \(\mathbf l^TC^∗\mathbf l = 0\) を満たす直線 \(\mathbf l\) は円錐点 \(C\) に接する。円錐点 \(C\) は直線 \(\mathbf l\) の包絡線である。
<!--
Fig. 2.2. (a) Points x satisfying \(\mathbf x^TC\mathbf x = 0\) lie on a point conic. (b) Lines \(\mathbf l\) satisfying \(\mathbf l^TC^∗\mathbf l = 0\) are tangent to the point conic \(C\). The conic \(C\) is the envelope of the lines \(\mathbf l\).
-->
</p><p>
<strong>退化円錐曲線</strong>　行列 \(C\) がフルランクでない場合、円錐曲線は退化していると呼ばれます。退化した点円錐曲線には、2つの直線（ランク2）と、繰り返される直線（ランク1）が含まれます。
<!--
<strong>Degenerate conics</strong>　If the matrix \(C\) is not of full rank, then the conic is termed degenerate. Degenerate point conics include two lines (rank 2), and a repeated line (rank 1).
-->
</p><p>
例2.8. 円錐曲線
<!--
Example 2.8. The conic
-->
\[
C =\mathbf  l\mathbf m^T +\mathbf m\mathbf l^T
\]
は2本の直線 \(\mathbf l\) と \(\mathbf m\) から構成されます。\(\mathbf l\) 上の点は \(\mathbf l^T\mathbf x = 0\) を満たし、\(\mathbf x^TC\mathbf x = (\mathbf x^T\mathbf l)(\mathbf m^T\mathbf x) + (\mathbf x^T\mathbf m)(\mathbf l^T\mathbf x) = 0\) であるため、円錐曲線上にあります。同様に、\(\mathbf m^T\mathbf x = 0\) を満たす点は \(\mathbf x^TC\mathbf x = 0\) も満たします。行列 \(C\) は対称行列で階数2です。零ベクトルは \(\mathbf x = \mathbf l ×\mathbf m\) で、これは l と \(\mathbf m\) の交点です。△
<!--
is composed of two lines \(\mathbf l\) and \(\mathbf m\). Points on \(\mathbf l\) satisfy \(\mathbf l^T\mathbf x = 0\), and are on the conic
since \(\mathbf x^TC\mathbf x = (\mathbf x^T\mathbf l)(\mathbf m^T\mathbf x) + (\mathbf x^T\mathbf m)(\mathbf l^T\mathbf x) = 0\). Similarly, points satisfying \(\mathbf m^T\mathbf x = 0\) also satisfy  \(\mathbf x^TC\mathbf x = 0\). The matrix \(C\) is symmetric and has rank 2. The null vector is \(\mathbf x = \mathbf l ×\mathbf m\) which is the intersection point of l and \(\mathbf m\). △
-->
</p><p>
退化した直線円錐曲線は、2点（階数2）と1点の重複点（階数1）を含みます。例えば、直線円錐曲線 \(C^∗ = \mathbf x\mathbf y^T + \mathbf y\mathbf x^T\) は階数2で、2点 \(\mathbf x\) と \(\mathbf y\) のいずれかを通る直線で構成されます。逆行列でない行列の場合、\((C^∗)^∗\neq C\) となることに注意してください。
<!--
Degenerate line conics include two points (rank 2), and a repeated point (rank 1). For example, the line conic \(C^∗ = \mathbf x\mathbf y^T + \mathbf y\mathbf x^T\) has rank 2 and consists of lines passing
through either of the two points \(\mathbf x\) and \(\mathbf y\). Note that for matrices that are not invertible
\((C^∗)^∗\neq C\).
-->
</p>
<h2><center>2.3 射影変換</center></h2>
<!--
<h2><center>2.3 Projective transformations</center></h2>
-->
<p>
フェリックス・クラインが有名な「エアランゲン・プログラム」[Klein-39]で提唱した幾何学の見解によれば、幾何学とは変換群に対して不変な性質の研究である。この観点から、2次元射影幾何学とは、射影平面 \(\mathbb P^2\) の、射影性と呼ばれる変換群に対して不変な性質の研究である。
<!--
In the view of geometry set forth by Felix Klein in his famous “Erlangen Program”, [Klein-39], geometry is the study of properties invariant under groups of transformations. From this point of view, 2D projective geometry is the study of properties of the projective plane \(\mathbb P^2\) that are invariant under a group of transformations known as
projectivities.
-->
</p><p>
射影性は、\(\mathbb P^2\)（つまり同次3次元ベクトル）の点から\(\mathbb P^2\)の点への可逆な写像であり、直線を直線に写すものである。より正確には、
<!--
A projectivity is an invertible mapping from points in \(\mathbb P^2\) (that is homogeneous 3-vectors) to points in \(\mathbb P^2\) that maps lines to lines. More precisely, 
-->
</p><p>
<strong>定義 2.9</strong>　射影性は、\(\mathbb P^2\) からそれ自身への可逆な写像 \(h\) であり、3 つの点 \(\mathbf x_1, \mathbf x_2\)、\(\mathbf x_3\) が同じ直線上にある場合と、\(h(\mathbf x_1), h(\mathbf x_2)\)、\(h(\mathbf x_3)\) が同じ直線上にある場合に限ります。
<!--
<strong>Definition 2.9</strong>　A projectivity is an invertible mapping \(h\) from \(\mathbb P^2\) to itself such that three points \(\mathbf x_1, \mathbf x_2\) and \(\mathbf x_3\) lie on the same line if and only if \(h(\mathbf x_1), h(\mathbf x_2)\) and \(h(\mathbf x_3)\) do.
-->
</p><p>
射影性は群を形成します。射影性の逆もまた射影性であり、2つの射影性の合成もまた射影性だからです。射影性は、共線変換（便利な呼び名）、射影変換、ホモグラフィとも呼ばれ、これらの用語は同義です。
<!--
Projectivities form a group since the inverse of a projectivity is also a projectivity, and
so is the composition of two projectivities. A projectivity is also called a collineation (a helpful name), a projective transformation or a homography: the terms are synonymous.
-->
</p><p>
定義2.9において、射影性は、点と直線の入射という座標に依存しない幾何学的概念によって定義されています。以下の結果に基づいて、射影性の等価な代数的定義が考えられます。
<!--
In definition 2.9, a projectivity is defined in terms of a coordinate-free geometric
concept of point line incidence. An equivalent algebraic definition of a projectivity is
possible, based on the following result.
-->
</p><p>
定理2.10. 写像 h : \(\mathbb P^2 → \mathbb P^2\) が射影性を持つための必要十分条件は、\(\mathbb P^2\) 内のベクトル x で表される任意の点に対して、\(h(\mathbf x) = H\mathbf x\) が真となるような特異でない 3 × 3 行列 H が存在するときである。
<!--
Theorem 2.10. A mapping h : \(\mathbb P^2 → \mathbb P^2\) is a projectivity if and only if there exists a
non-singular 3 × 3 matrix H such that for any point in \(\mathbb P^2\) represented by a vector x it
is true that \(h(\mathbf x) = H\mathbf x\).
-->
</p><p>
この定理を解釈するために、\(\mathbb P^2\) 上の任意の点は同次 3 次元ベクトル \(\mathbf x\) として表され、\(H\mathbf x\) は同次座標の線型写像である。この定理は、任意の射影性は同次座標におけるそのような線型変換として生じ、逆に、そのような写像は射影性であると主張している。ここでは定理の完全な証明は行わない。同次座標の任意の可逆な線型変換は射影性であることを示すのみである。
<!--
To interpret this theorem, any point in \(\mathbb P^2\) is represented as a homogeneous 3-vector,
 \(\mathbf x\), and \(H\mathbf x\) is a linear mapping of homogeneous coordinates. The theorem asserts that
any projectivity arises as such a linear transformation in homogeneous coordinates, and
that conversely any such mapping is a projectivity. The theorem will not be proved in
full here. It will only be shown that any invertible linear transformation of homogeneous
coordinates is a projectivity.
-->
</p><p>
<strong>証明</strong>　\(\mathbf x_1, \mathbf x_2\) および \(\mathbf x_3\) が直線 \(\mathbf l\) 上にあるとします。したがって、\(i = 1, . . , 3\) に対して \(\mathbf l^T\mathbf x_i = 0\) が成り立ちます。\(H\) を特異でない 3 × 3 行列とします。\(\mathbf l^TH^{−1}H\mathbf x_i = 0\) であることが証明されます。したがって、点 \(H\mathbf x_i\) はすべて直線 \(H^{−T}\mathbf l\) 上にあり、変換によって共線性が保たれます。逆、つまり各射影性がこのようにして生じることを証明するのは、かなり困難です。
<!--
<strong>Proof</strong>　Let \(\mathbf x_1, \mathbf x_2\) and \(\mathbf x_3\) lie on a line \(\mathbf l\). Thus \(\mathbf l^T\mathbf x_i = 0\) for \(i = 1, . . . , 3\). Let \(H\) be a
non-singular 3 × 3 matrix. One verifies that \(\mathbf l^TH^{−1}H\mathbf x_i = 0\). Thus, the points \(H\mathbf x_i\) all lie
on the line \(H^{−T}\mathbf l\), and collinearity is preserved by the transformation.
The converse is considerably harder to prove, namely that each projectivity arises in this way.
-->
</p><p>
この定理の結果として、射影変換 (または共線変換) の別の定義を次のように与えることができます。
<!--
As a result of this theorem, one may give an alternative definition of a projective transformation (or collineation) as follows.
-->
</p><p>
<strong>定義 2.11. 射影変換</strong> 平面射影変換とは、3×3 行列で表される同次 3 次元ベクトル上の線型変換である。
<!--
<strong>Definition 2.11. Projective transformation</strong>　A planar projective transformation is a
linear transformation on homogeneous 3-vectors represented by a non-singular 3 × 3 matrix:
-->
\[
\begin{pmatrix}
x_1^\prime \\
x_2^\prime \\
x_3^\prime \\
\end{pmatrix}
=
\begin{bmatrix}
h_{11} & h_{12} & h_{13} \\
h_{21} & h_{22} & h_{23} \\
h_{31} & h_{32} & h_{33} 
\end{bmatrix}
\begin{pmatrix}
x_1 \\
x_2 \\
x_3 
\end{pmatrix}
\tag{2.5}
\]
またはもっと簡単に言えば、\(\mathbf x^\prime = H\mathbf x\)です。
<!--
or more briefly, \(\mathbf x^\prime = H\mathbf x\).
-->
</p><p>
この式に現れる行列Hは、任意の非ゼロのスケール係数を乗じることで、射影変換を変化させることなく変化させることができることに注意してください。したがって、点の同次表現と同様に、行列要素の比のみが重要であるため、Hは同次行列であると言えます。Hの9つの要素には8つの独立した比があり、射影変換は8つの自由度を持つことになります。
<!--
Note that the matrix H occurring in this equation may be changed by multiplication by an arbitrary non-zero scale factor without altering the projective transformation. Consequently we say that H is a homogeneous matrix, since as in the homogeneous representation of a point, only the ratio of the matrix elements is significant. There are eight independent ratios amongst the nine elements of H, and it follows that a projective transformation has eight degrees of freedom.
-->
</p><p>
射影変換は、あらゆる図形を射影的に同値な図形に射影し、その射影特性はすべて不変のままにします。図2.1の光線モデルでは、射影変換は単に\(\mathbf R^3\)の線型変換です。
<!--
A projective transformation projects every figure into a projectively equivalent figure, leaving all its projective properties invariant. In the ray model of figure 2.1 a projective transformation is simply a linear transformation of \(\mathbf R^3\).
-->
</p>
<center><img src="images/fig2_3.png"></center>
<p>
図2.3. 中心射影は、ある平面上の点を別の平面上の点に写像します。また、射影中心を通る平面を考えればわかるように、直線を直線に写像します。この平面は、2つの平面 \(pi\) と \(\pi^\prime\) と交差します。直線は直線に写像されるため、中心射影は射影性を持ち、同次座標の線型写像 \(\mathbf x\prime = H\mathbf x\) で表すことができます。
<!--
Fig. 2.3. Central projection maps points on one plane to points on another plane. The projection also maps lines to lines as may be seen by considering a plane through the projection centre which intersects
with the two planes \(pi\) and \(\pi^\prime\). Since lines are mapped to lines, central projection is a projectivity and may be represented by a linear mapping of homogeneous coordinates \(\mathbf x\prime = H\mathbf x\).
-->
</p><p>
<strong>平面間の写像</strong>　定理 2.10 の適用例として、図 2.3 を考えてみましょう。共通点 (投影の中心) を通る光線に沿った投影は、​​ある平面から別の平面への写像を定義します。この点から点への写像では、一方の平面の直線が他方の平面の直線に写像されるため、直線が保存されることは明らかです。各平面に座標系が定義され、点が同次座標で表されている場合、中心投影写像は \(\mathbf x^\prime= H\mathbf x\) で表すことができます。ここで \(H\) は特異でない 3×3 行列です。実際には、2 つの平面で定義されている 2 つの座標系がどちらもユークリッド (直線) 座標系である場合、中心投影によって定義される写像は、任意の射影変換よりも制限されます。これは完全な射影変換ではなく透視投影変換と呼ばれ、6 自由度の変換で表すことができます。セクション A7.4 で視点に戻ります。
<!--
<strong>Mappings between planes</strong>　As an example of how theorem 2.10 may be applied, consider figure 2.3. Projection along rays through a common point (the centre of projection) defines a mapping from one plane to another. It is evident that this point-topoint mapping preserves lines in that a line in one plane is mapped to a line in the other. If a coordinate system is defined in each plane and points are represented in homogeneous coordinates, then the central projection mapping may be expressed by \(\mathbf x^\prime= H\mathbf x\) where \(H\) is a non-singular 3×3 matrix. Actually, if the two coordinate systems defined
in the two planes are both Euclidean (rectilinear) coordinate systems then the mapping defined by central projection is more restricted than an arbitrary projective transformation. It is called a perspectivity rather than a full projectivity, and may be represented by a transformation with six degrees of freedom. We return to perspectivities in section A7.4.
-->
</p><p>
<strong>例 2.12. 平面の透視画像から射影歪みを除去する</strong>　透視画像では形状が歪みます。例えば、図 2.4a では、元の窓は長方形ですが、画像では長方形ではありません。一般に、シーンの平面上の平行線は画像では平行ではなく、有限の点に収束します。平面（または平面の一部）の中心投影画像は、射影変換を介して元の平面に関連付けられているため、画像は元の平面の射影歪みであることが説明されています。この射影変換を「元に戻す」には、逆変換を計算して画像に適用します。その結果、平面上のオブジェクトが正しい幾何学的形状で表示された新しい合成画像が得られます。ここでは、図 2.4a の建物の正面を例に挙げて説明します。地面と前面は同一平面上にないため、前面を補正するために適用する必要がある射影変換は、地面に使用されるものと同じではないことに注意してください。
<!--
<strong>Example 2.12. Removing the projective distortion from a perspective image of a plane</strong>　Shape is distorted under perspective imaging. For instance, in figure 2.4a the windows
are not rectangular in the image, although the originals are. In general parallel lines on a scene plane are not parallel in the image but instead converge to a finite point. We have seen that a central projection image of a plane (or section of a plane) is related to the original plane via a projective transformation, and so the image is a projective distortion of the original. It is possible to “undo” this projective transformation by computing the inverse transformation and applying it to the image. The result will be a new synthesized image in which the objects in the plane are shown with their correct geometric shape. This will be illustrated here for the front of the building of
figure 2.4a. Note that since the ground and the front are not in the same plane, the
projective transformation that must be applied to rectify the front is not the same as the
one used for the ground.
-->
</p>
<center><img src="images/fig2_4.png"></center>
<p>
図2.4. 遠近法の歪みの除去。(a) 遠近法の歪みのある元の画像。窓の線が明らかに有限の点に収束しています。(b) 正面の壁を正面から正射影的に見た合成画像。壁の画像(a)は、射影変換によって壁の実際の形状に関連付けられています。逆変換は、画像に写っている窓の4つの角を適切なサイズの長方形の角にマッピングすることで計算されます。4点の対応関係によって変換が決定されます。この変換は画像全体に適用されます。地面の画像の一部は、さらに射影歪みを受けていることに注意してください。これも射影変換によって除去できます。
<!--
Fig. 2.4. Removing perspective distortion. (a) The original image with perspective distortion – the lines of the windows clearly converge at a finite point. (b) Synthesized frontal orthogonal view of the front wall. The image (a) of the wall is related via a projective transformation to the true geometry of the wall. The inverse transformation is computed by mapping the four imaged window corners to corners of an appropriately sized rectangle. The four point correspondences determine the transformation. The transformation is then applied to the whole image. Note that sections of the image of the ground are subject to a further projective distortion. This can also be removed by a projective transformation.
-->
</p><p>
点対点の対応から射影変換を計算する方法については、第4章で詳細に考察する。ここでは、変換を計算する方法を簡単に示す。まず、画像の平面部分に対応する部分を選択する。図2.3に示すように、画像の局所的な2次元座標と世界座標を選択する。世界平面と画像平面における対応する点のペア\(\mathbf x\)と\(\mathbf x^\prime\)の非同次座標をそれぞれ\((x, y)\)と\((x^\prime, y^\prime)\)とする。ここでは、点の同次座標ではなく非同次座標を使用する。これは、画像と世界平面から直接測定されるのがこれらの非同次座標だからである。(2.5)式の射影変換は、非同次形式で次のように表すことができる。
<!--
Computation of a projective transformation from point-to-point correspondences will be considered in great detail in chapter 4. For now, a method for computing the trans formation is briefly indicated. One begins by selecting a section of the image corresponding to a planar section of the world. Local 2D image and world coordinates are selected as shown in figure 2.3. Let the inhomogeneous coordinates of a pair of matching 
points \(\mathbf x\) and \(\mathbf x^\prime\) in the world and image plane be \((x, y)\) and \((x^\prime, y^\prime)\) respectively.
We use inhomogeneous coordinates here instead of the homogeneous coordinates of the points, because it is these inhomogeneous coordinates that are measured directly from the image and from the world plane. The projective transformation of (2.5) can be written in inhomogeneous form as
-->
\[
x^\prime=\frac{x_1^\prime}{x_3^\prime}=\frac{h_{11}x+h_{12}y+h_{13}}{h_{31}x+h_{32}y+h_{33}}　y^\prime=\frac{x_2^\prime}{x_3^\prime}=\frac{h_{21}x+h_{22}y+h_{23}}{h_{31}x+h_{32}y+h_{33}}
\]
各点の対応は\(H\)の要素について2つの方程式を生成し、それらを掛け合わせると
<!--
Each point correspondence generates two equations for the elements of \(H\), which after multiplying out are
-->
\[
\begin{align}
x^\prime(h_{31}x+h_{32}y+h_{33}) &= h_{11}x+h_{12}y+h_{13} \\
y^\prime(h_{31}x+h_{32}y+h_{33}) &= h_{21}x+h_{22}y+H_{23}
\end{align}
\]
これらの方程式は \(H\) の要素について線形である。4点の対応から、\(H\) の要素に8つの線形方程式が導かれ、それらは \(H\) を無関係な乗数まで解くのに十分である。唯一の制限は、4点が「一般位置」にある必要があるということである。つまり、どの3点も同一直線上にあってはならない。このようにして計算された変換 \(H\) の逆変換が画像全体に適用され、選択された平面における遠近法の歪みの影響が打ち消される。結果は図2.4bに示している。△
<!--
These equations are linear in the elements of \(H\). Four point correspondences lead to
eight such linear equations in the entries of \(H\), which are sufficient to solve for \(H\) up to
an insignificant multiplicative factor. The only restriction is that the four points must
be in “general position”, which means that no three points are collinear. The inverse
of the transformation \(H\) computed in this way is then applied to the whole image to
undo the effect of perspective distortion on the selected plane. The results are shown
in figure 2.4b. △
-->

</p><p>
この例に関して、3つの注意点があります。第一に、この方法で平行化変換 \(H\) を計算する場合、カメラのパラメータや平面の姿勢に関する情報は必要ありません。第二に、射影歪みを除去するために4点の座標を知る必要は必ずしもありません。2.7節で説明する代替手法では、必要な情報が少なく、必要な情報の種類も異なります。第三に、射影変換を計算するためのより優れた（そして推奨される）方法については、第4章で説明します。
<!--
Three remarks concerning this example are appropriate: first, the computation of
the rectifying transformation \(H\) in this way does not require knowledge of any of the
camera's parameters or the pose of the plane; second, it is not always necessary to know coordinates for four points in order to remove projective distortion: alternative
approaches, which are described in section 2.7, require less, and different types of,
information; third, superior (and preferred) methods for computing projective transformations
are described in chapter 4.
-->
</p><p>
射影変換は、世界平面の透視投影像以外にも多くの状況を表す重要な写像です。図2.5には、他にも多くの例が示されています。これらの状況については、本書の後半でより詳しく説明します。
<!--
Projective transformations are important mappings representing many more situations
than the perspective imaging of a world plane. A number of other examples are
illustrated in figure 2.5. Each of these situations is covered in more detail later in the
book.
-->
</p>
<center><img src="images/fig2_5.png"></center>
<p>
図2.5. 透視画像に生じる射影変換 \(\mathbf x^\prime = H\mathbf x\) の例。(a)
世界平面によって誘起される2つの画像間の射影変換（2つの射影変換の連結は射影変換である）。(b)
同じカメラ中心を持つ2つの画像間の射影変換（例えば、カメラがその中心を中心に回転したり、焦点距離が変化したりする）。(c)
平面（建物の端）の像と、別の平面（地面）へのその影の像間の射影変換。図(c)はLuc Van Gool氏の提供。
<!--
Fig. 2.5. Examples of a projective transformation, \(\mathbf x^\prime = H\mathbf x\), arising in perspective images. (a)
The projective transformation between two images induced by a world plane (the concatenation of two
projective transformations is a projective transformation); (b) The projective transformation between
two images with the same camera centre (e.g. a camera rotating about its centre or a camera varying its
focal length); (c) The projective transformation between the image of a plane (the end of the building)
and the image of its shadow onto another plane (the ground plane). Figure (c) courtesy of Luc Van Gool.
-->
</p>
<h3>2.3.1 直線と円錐曲線の変換</h3>
<!--
<h3>2.3.1 Transformations of lines and conics</h3>
-->
<p>
<strong>直線の変換</strong>　定理2.10の証明において、点 \(\mathbf x_i\) が直線 \(\mathbf l\) 上にある場合、射影変換によって変換された点 \(\mathbf x_i^\prime = H\mathbf x_i\) は直線 \(\mathbf l^\prime = H^{−T}\mathbf l\) 上にあることが示されました。このように、\({\mathbf l^\prime}^T\mathbf x_i^\prime = \mathbf l^TH^{−1}H\mathbf x_i = 0\) であるため、直線上の点の入射角は保存されます。これは直線の変換規則を与える：
点変換\(\mathbf x^\prime = H\mathbf x\)のもとで、直線は次のように変換される。
<!--
<strong>Transformation of lines</strong>　It was shown in the proof of theorem 2.10 that if points \(\mathbf x_i\) lie on a line \(\mathbf l\), then the transformed points \(\mathbf x_i^\prime = H\mathbf x_i\) under a projective transformation lie on the line \(\mathbf l^\prime = H^{−T}\mathbf l\). In this way, incidence of points on lines is preserved, since \({\mathbf l^\prime}^T\mathbf x_i^\prime = \mathbf l^TH^{−1}H\mathbf x_i = 0\). This gives the transformation rule for lines:
Under the point transformation \(\mathbf x^\prime = H\mathbf x\), a line transforms as
-->
\[
\mathbf l^\prime = H^{−T}\mathbf l  \tag{2.6}
\]
\({\mathbf l^\prime}^T = \mathbf l^TH^{−1}\) と書くこともできます。直線と点の変換方法が根本的に異なることに注意してください。点は \(H\) に従って変換されますが、直線（行）は \(H^{−1}\) に従って変換されます。これは「共変」または「反変」という振る舞いによって説明できます。点は反変的に変換され、直線は共変的に変換すると言われています。この区別は、第15章でテンソルについて議論する際に再び取り上げられ、付録1で詳しく説明されています。
<!--
One may alternatively write \({\mathbf l^\prime}^T = \mathbf l^TH^{−1}\). Note the fundamentally different way
in which lines and points transform. Points transform according to \(H\), whereas lines
(as rows) transform according to \(H^{−1}\). This may be explained in terms of “covariant”or “contravariant” behaviour. One says that points transform contravariantly and lines transform covariantly. This distinction will be taken up again, when we discuss tensors in chapter 15 and is fully explained in appendix 1.
-->
</p><p>
<strong>円錐曲線の変換</strong>　点変換\(\mathbf x^\prime = H\mathbf x\)の下で、(2.2)は
<!--
<strong>Transformation of conics</strong>　Under a point transformation \(\mathbf x^\prime = H\mathbf x\), (2.2) becomes
-->
\[
\begin{align}
\mathbf x^TC\mathbf x &= {\mathbf x^\prime}^T[H^{−1}]^TCH^{−1}\mathbf x^\prime \\
&= {\mathbf x^\prime}^TH^{−T}CH^{−1}\mathbf x^\prime
\end{align}
\]
これは\({\mathbf x^\prime}^TC^\prime\mathbf x^\prime\)の二次形式であり、\(C^\prime= H^{−T}CH^{−1}\)となる。これは円錐曲線の変換規則を与える。
<!--
which is a quadratic form \({\mathbf x^\prime}^TC^\prime\mathbf x^\prime\) with \(C^\prime= H^{−T}CH^{−1}\). This gives the transformation rule for a conic:
-->
</p><p>
<strong>結果 2.13</strong>　点変換 \(\mathbf x^\prime = H\mathbf x\) により、円錐曲線 \(C\) は
\(C^\prime = H^{−T}CH^{−1}\) に変換されます。
<!--
<strong>Result 2.13</strong>　Under a point transformation \(\mathbf x^\prime = H\mathbf x\), a conic \(C\) transforms to
\(C^\prime = H^{−T}CH^{−1}\).
-->
</p><p>
この式に \(H^{−1}\) が存在することは、円錐曲線が共変変換すると言うことで表現できます。双対円錐曲線の変換則も同様の方法で導かれます。
これは次のようになります。
<!--
The presence of \(H^{−1}\) in this equation may be expressed by saying that a conic transforms covariantly. The transformation rule for a dual conic is derived in a similar manner.
This gives:
-->
</p><p>
<strong>結果 2.14</strong>　点変換 \(\mathbf x^\prime = H\mathbf x\) により、双対円錐 \(C^∗\) は
\({C^∗}^\prime = HC^∗H^T\) に変換されます。
<!--
<strong>Result 2.14</strong>　Under a point transformation \(\mathbf x^\prime = H\mathbf x\), a dual conic \(C^∗\) transforms to
\({C^∗}^\prime = HC^∗H^T\).
-->
</p>
<center><img src="images/fig2_6.png"></center>
<p>
図2.6. 中心投影時に生じる歪み。タイル張りの床の画像。(a) 相似：円形のパターンは円として画像化されます。正方形のタイルは正方形として画像化されます。平行線または垂直線は、画像内で同じ相対的な方向を持ちます。(b) アフィン：円は楕円として画像化されます。直交する世界線は直交線として画像化されません。ただし、世界で平行である正方形のタイルの辺は、画像でも平行です。(c) 射影：平行な世界線は収束線として画像化されます。カメラに近いタイルは、遠いタイルよりも大きな画像になります。
<!--
Fig. 2.6. Distortions arising under central projection. Images of a tiled floor. (a) Similarity: the circular pattern is imaged as a circle. A square tile is imaged as a square. Lines which are parallel or perpendicular have the same relative orientation in the image. (b) Affine: The circle is imaged as an ellipse. Orthogonal world lines are not imaged as orthogonal lines. However, the sides of the square tiles, which are parallel in the world are parallel in the image. (c) Projective: Parallel world lines are imaged as converging lines. Tiles closer to the camera have a larger image than those further away.
-->
</p>
<h2><center>2.4 変換の階層</center></h2>
<!--
<h2><center>2.4 A hierarchy of transformations</center></h2>
-->
<p>
この節では、射影変換の重要な特殊化とその幾何学的性質について述べる。2.3節では、射影変換が群を形成することを示した。この群は射影線型群と呼ばれ、これらの特殊化はこの群の部分群であることが分かる。
<!--
In this section we describe the important specializations of a projective transformation
and their geometric properties. It was shown in section 2.3 that projective transformations
form a group. This group is called the projective linear group, and it will be seen
that these specializations are subgroups of this group.
-->
</p><p>
実元を持つ可逆なn×n行列の群は、n次元の（実）一般線型群、すなわちGL(n)です。射影線型群を得るには、スカラー乗数で関連付けられた行列を同一視し、PL(n)（これはGL(n)の商群です）を得ます。平面の射影変換の場合、n = 3となります。
<!--
The group of invertible n × n matrices with real elements is the (real) general linear
group on n dimensions, or GL(n). To obtain the projective linear group the matrices
related by a scalar multiplier are identified, giving PL(n) (this is a quotient group of
GL(n)). In the case of projective transformations of the plane n = 3.
-->
</p><p>
PL(3)の重要な部分群には、PL(3)の最終行が(0, 0, 1)となる行列からなる部分群であるアフィン群と、アフィン群の左上2×2行列が直交する部分群であるユークリッド群がある。また、左上2×2行列の行列式が1である向き付けられたユークリッド群を同一視することもできる。
<!--
The important subgroups of PL(3) include the affine group, which is the subgroup
of PL(3) consisting of matrices for which the last row is (0, 0, 1), and the Euclidean
group, which is a subgroup of the affine group for which in addition the upper left hand
2 × 2 matrix is orthogonal. One may also identify the oriented Euclidean group in
which the upper left hand 2 × 2 matrix has determinant 1.
-->
</p><p>
これらの変換を、最も特殊な等長変換から始めて、射影変換に至るまで段階的に一般化していきます。
これは変換の階層を定義します。この階層における様々な変換の歪み効果は、図2.6に示されています。
<!--
We will introduce these transformations starting from the most specialized, the
isometries, and progressively generalizing until projective transformations are reached.
This defines a hierarchy of transformations. The distortion effects of various transformations
in this hierarchy are shown in figure 2.6.
-->
</p><p>
興味深い変換の中には、群ではないものもあります。例えば、パースペクティブ性（二つのパースペクティブ性の合成はパースペクティブ性ではなく射影性であるため）などです。この点については、A7.4節で説明します。
<!--
Some transformations of interest are not groups, for example, perspectivities (because
the composition of two perspectivities is a projectivity, not a perspectivity). This
point is covered in section A7.4.
-->
</p><p>
<strong>不変量</strong>　変換を代数的に記述する（点または曲線の座標に作用する行列として記述する）代わりに、保存される、つまり不変な要素または量で変換を記述することもできます。幾何学的構成の（スカラー）不変量とは、特定の変換によって値が変化しない構成の関数です。たとえば、2点間の距離はユークリッド変換（並進と回転）では変化しませんが、相似変換（並進、回転、等方的なスケーリングなど）では変化しません。したがって、距離はユークリッド不変量ですが、相似不変量ではありません。2線間の角度はユークリッド不変量と相似不変量の両方です。
<!--
<strong>Invariants</strong>　An alternative to describing the transformation algebraically, i.e. as a matrix
acting on coordinates of a point or curve, is to describe the transformation in terms
of those elements or quantities that are preserved or invariant. A (scalar) invariant of a
geometric configuration is a function of the configuration whose value is unchanged by
a particular transformation. For example, the separation of two points is unchanged by
a Euclidean transformation (translation and rotation), but not by a similarity (e.g. translation,
rotation and isotropic scaling). Distance is thus a Euclidean, but not similarity
invariant. The angle between two lines is both a Euclidean and a similarity invariant.
-->
</p>
<h3>2.4.1 クラス I: 等長変換</h3>
<!--
<h3>2.4.1 Class I: Isometries</h3>
-->
<p>
等長変換は、ユークリッド距離（iso = 同じ、metric = 測定）を保つ平面 \(\mathbb R^2\) の変換である。等長変換は次のように表される。
<!--
Isometries are transformations of the plane \(\mathbb R^2\) that preserve Euclidean distance (from
iso = same, metric = measure). An isometry is represented as
-->
\[
\begin{pmatrix}
x^\prime \\
y^\prime \\
1
\end{pmatrix}
=
\begin{bmatrix}
\epsilon\cos\theta & -\sin\theta & t_x \\
\epsilon\sin\theta & \cos\theta & t_y \\
0 & 0 & 1
\end{bmatrix}
\begin{pmatrix}
x \\
y \\
1
\end{pmatrix}
\]
ここで、\(\epsilon = ±1\) です。\(\epsilon = 1\) の場合、等長変換は向きを保存するユークリッド変換（並進と回転の合成）です。\(\epsilon= −1\) の場合、等長変換は向きを反転します。一例として、行列 \(diag(−1, 1, 1)\) で表される鏡映変換とユークリッド変換の合成が挙げられます。
<!--
where \(\epsilon = ±1\). If \(\epsilon = 1\) then the isometry is orientation-preserving and is a Euclidean
transformation (a composition of a translation and rotation). If \(\epsilon= −1\) then the isometry
reverses orientation. An example is the composition of a reflection, represented by
the matrix \(diag(−1, 1, 1)\), with a Euclidean transformation.
-->
</p><p>
ユークリッド変換は剛体の運動をモデル化します。これらは実用上最も重要な等長変換であり、本稿ではこれらに焦点を当てます。しかしながら、方向反転等長変換は、構造復元においてしばしば曖昧さとして生じます。
<!--
Euclidean transformations model the motion of a rigid object. They are by far the
most important isometries in practice, and we will concentrate on these. However, the
orientation reversing isometries often arise as ambiguities in structure recovery.
-->
</p><p>
平面ユークリッド変換は、より簡潔にブロック形式で次のように記述できる。
<!--
A planar Euclidean transformation can be written more concisely in block form as
-->
\[
\mathbf x^\prime=H_E\mathbf x=
\begin{bmatrix}
R & t \\
0^T & 1
\end{bmatrix}
\mathbf x \tag{2.7}
\]
ここで、\(R\) は 2 × 2 回転行列（\(R^TR = RR^T = I\) となる直交行列）、
\(t\) は並進 2 次元ベクトル、0 はヌル 2 次元ベクトルです。特殊なケースとして、純粋な回転（\(t = 0\) の場合）と純粋な並進（\(R = I\) の場合）があります。ユークリッド変換は変位とも呼ばれます。
平面ユークリッド変換には 3 つの自由度があり、1 つは回転、2 つは並進です。したがって、変換を定義するには 3 つのパラメータを指定する必要があります。変換は 2 点の対応から計算できます。
<!--
where \(R\) is a 2 × 2 rotation matrix (an orthogonal matrix such that  \(R^TR = RR^T = I\)),
\(t\) a translation 2-vector, and 0 a null 2-vector. Special cases are a pure rotation (when
\(t = 0\)) and a pure translation (when \(R = I\)). A Euclidean transformation is also known
as a displacement.
A planar Euclidean transformation has three degrees of freedom, one for the rotation
and two for the translation. Thus three parameters must be specified in order to define
the transformation. The transformation can be computed from two point correspondences.
-->
</p><p>
<strong>不変量</strong>　不変量は非常によく知られています。たとえば、長さ（2点間の距離）、角度（2直線間の角度）、面積などです。
<!--
<strong>Invariants</strong>　The invariants are very familiar, for instance: length (the distance between
two points), angle (the angle between two lines), and area.
-->
</p><p>
<strong>群と向き</strong>　等長変換が向きを保存するとは、左上の2×2行列の行列式が1であることを意味する。向きを保存する等長変換は群を形成し、向きを反転させる等長変換は群を形成しない。この区別は、後述する相似変換とアフィン変換の場合にも当てはまる。
<!--
<strong>Groups and orientation</strong>　An isometry is orientation-preserving if the upper left
hand 2 × 2 matrix has determinant 1. Orientation-preserving isometries form a group,
orientation-reversing ones do not. This distinction applies also in the case of similarity
and affine transformations which now follow.
-->
</p>
<h3>2.4.2 クラス II: 相似変換</h3>
<!--
<h3>2.4.2 Class II: Similarity transformations</h3>
-->
<p>
相似変換（または単に相似）は、等方的なスケーリングと組み合わせた等長変換です。スケーリング（つまり反射なし）と組み合わせたユークリッド変換の場合、相似は行列表現を持ちます。
<!--
A similarity transformation (or more simply a similarity) is an isometry composed with
an isotropic scaling. In the case of a Euclidean transformation composed with a scaling
(i.e. no reflection) the similarity has matrix representation
-->
\[
\begin{pmatrix}
x^\prime \\
y^\prime \\
1
\end{pmatrix}
=
\begin{bmatrix}
s\cos\theta & -s\sin\theta & t_x \\
s\sin\theta & s\cos\theta & t_y \\
0 & 0 & 1
\end{bmatrix}
\begin{pmatrix}
x \\
y \\
1
\end{pmatrix}
\tag{2.8}
\]
これをブロック形式で簡潔に書くと、
<!--
This can be written more concisely in block form as
-->
\[
\mathbf x^\prime = H_s\mathbf x=
\begin{bmatrix}
sR & t \\
0^T & 1
\end{bmatrix}
\mathbf x
\tag{2.9}
\]
ここで、スカラーsは等方的なスケーリングを表します。相似変換は「形状」（form）を保存するため、等形式変換とも呼ばれます。平面相似変換には4つの自由度があり、スケーリングはユークリッド変換よりも1つ多い自由度を占めます。相似度は2点の対応から計算できます。
<!--
where the scalar s represents the isotropic scaling. A similarity transformation is also
known as an equi-form transformation, because it preserves “shape” (form). A planar
similarity transformation has four degrees of freedom, the scaling accounting for one
more degree of freedom than a Euclidean transformation. A similarity can be computed
from two point correspondences.
-->
</p><p>
<strong>不変量</strong>　不変量は、追加のスケーリング自由度を適切に考慮すれば、ユークリッド不変量から構築できます。線分の角度は回転、並進、等方的なスケーリングの影響を受けず、相似不変量も同様です。特に平行線は平行線に写像されます。2点間の長さは相似不変量ではありませんが、2つの長さの比は不変量です。これは、長さのスケーリングが打ち消されるためです。同様に、面積の比も不変量です。これは、スケーリング（2乗）が打ち消されるためです。
<!--
<strong>Invariants</strong>　The invariants can be constructed from Euclidean invariants with suitable
provision being made for the additional scaling degree of freedom. Angles between
lines are not affected by rotation, translation or isotropic scaling, and so are similarity
invariants. In particular parallel lines are mapped to parallel lines. The length between
two points is not a similarity invariant, but the ratio of two lengths is an invariant,
because the scaling of the lengths cancels out. Similarly a ratio of areas is an invariant
because the scaling (squared) cancels out.
-->
</p><p>
メトリック構造。再構成（第10章）の議論で頻繁に使用される用語がメトリックです。メトリック構造という記述は、構造が類似性に基づいて定義されていることを意味します。
<!--
Metric structure. A term that will be used frequently in the discussion on reconstruction
(chapter 10) is metric. The description metric structure implies that the structure
is defined up to a similarity.
-->
</p>
<h3>2.4.3 クラス III: アフィン変換</h3>
<!--
<h3>2.4.3 Class III: Affine transformations</h3>
-->
<p>
アフィン変換（またはより簡潔にアフィニティ）は、特異でない線形変換に平行移動を加えたものである。これは行列表現で表すことができる。
<!--
An affine transformation (or more simply an affinity) is a non-singular linear transformation
followed by a translation. It has the matrix representation
-->
\[
\begin{pmatrix}
x^\prime \\
y^\prime \\
1
\end{pmatrix}
=
\begin{bmatrix}
a_{11} & a_{12} & t_x \\
a_{21} & a_{22} & t_y \\
0 & 0 & 1
\end{bmatrix}
\begin{pmatrix}
x \\
y \\
1
\end{pmatrix}
\tag{2.10}
\]
またはブロック形式で
<!--
or in block form
-->
\[
\mathbf x^\prime = H_A\mathbf x=
\begin{bmatrix}
A & t \\
0^T & I
\end{bmatrix}
\mathbf x
\tag{2.11}
\]
ここで、Aは2×2の非特異行列である。平面アフィン変換は、6つの行列要素に対応する6つの自由度を持つ。この変換は3点の対応から計算できる。
<!--
with A a 2 × 2 non-singular matrix. A planar affine transformation has six degrees of freedom corresponding to the six matrix elements. The transformation can be computed from three point correspondences.
-->
</p><p>
アフィン変換の線形成分Aの幾何学的効果を理解する上で役立つ方法は、回転と非等方的なスケーリングという2つの基本的な変換の合成として考えることである。アフィン行列Aは常に次のように分解できる。
<!--
A helpful way to understand the geometric effects of the linear component A of an affine transformation is as the composition of two fundamental transformations, namely rotations and non-isotropic scalings. The affine matrix A can always be decomposed as
-->
\[
A = R(θ) R(−\phi) D R(\phi) \tag{2.12}
\]
ここで\(R(θ)\)と\(R(\phi)\)はそれぞれ\(θ\)と\(\phi\)による回転であり、\(D\)は対角行列です。
<1--
where \(R(θ)\) and \(R(\phi)\) are rotations by \(θ\) and \(\phi\) respectively, and \(D\) is a diagonal matrix:
-->
\[
D =
\begin{bmatrix}
\lambda_1 & 0 \\
0 & \lambda_2
\end{bmatrix}
\]
この分解はSVD（セクションA4.4）から直接導かれます。\(A =UDV^T = (UV^T)(VDV^T) = R(θ) (R(−\phi) D R(\phi))\)と書きます。これは\(U\)と\(V\)が直交行列だからです。
<!--
This decomposition follows directly from the SVD (section A4.4): writing \(A =UDV^T = (UV^T)(VDV^T) = R(θ) (R(−\phi) D R(\phi))\), since \(U\) and \(V\) are orthogonal matrices.
-->
</p><p>
したがって、アフィン行列 \(A\) は、回転 (\(\phi\) による)、それぞれ \(λ_1\) と \(λ_2\) による (回転した) \(x\) と \(y\) 方向のスケーリング、逆回転 (\(−\phi\) による)、そして最後にもう 1 つの回転 (θ による) を結合したものとみなされます。相似行列と比較して、唯一「新しい」幾何学的形状は、非等方的なスケーリングです。これにより、相似行列には相似行列よりも 2 つの自由度が追加されます。その 2 つは、スケーリング方向を指定する角度 \(\phi\) と、スケーリング パラメータの比 \(λ_1:λ_2\) です。相似行列の本質は、特定の角度で配向された直交方向へのスケーリングです。図 2.7 に模式図を示します。
<!--
The affine matrix \(A\) is hence seen to be the concatenation of a rotation (by \(\phi\)); a scaling by \(λ_1\) and \(λ_2\) respectively in the (rotated) \(x\) and \(y\) directions; a rotation back (by \(−\phi\)); and finally another rotation (by θ). The only “new” geometry, compared to a similarity, is the non-isotropic scaling. This accounts for the two extra degrees of freedom possessed by an affinity over a similarity. They are the angle \(\phi\) specifying the scaling direction, and the ratio of the scaling parameters \(λ_1:λ_2\). The essence of an affinity is this scaling in orthogonal directions, oriented at a particular angle. Schematic
examples are given in figure 2.7.
-->
</p>
<center><img src="images/fig2_7.png"></center>
<p>
図2.7. 平面アフィン変換によって生じる歪み。(a) \(R(θ)\)による回転。(b) 変形\(R(−\phi)DR(\phi)\)。変形におけるスケーリング方向は直交していることに注意。
<!--
Fig. 2.7. Distortions arising from a planar affine transformation. (a) Rotation by \(R(θ)\). (b) A deformation \(R(−\phi)DR(\phi)\). Note, the scaling directions in the deformation are orthogonal.
-->
</p><p>
<strong>不変量</strong>　アフィン変換には非等方的なスケーリングが含まれるため、直線間の長さの比と角度の相似不変量はアフィン変換では保持されません。重要な不変量は以下の3つです。
(i) <strong>平行線</strong>　2本の平行線を考えます。これらは無限遠点で点
\((x_1, x_2, 0)^T\) で交差します。アフィン変換では、この点は無限遠点の別の点に写像されます。したがって、平行線は依然として無限遠点で交差する直線に写像され、したがって変換後も平行になります。
(ii) <strong>平行線分の長さの比</strong>　線分の長さのスケーリングは、線の方向とスケーリング方向の間の角度のみに依存します。直線が直交スケーリング方向のx軸に対して角度\(α\)をなすと仮定すると、スケーリングの大きさは
\(\sqrt{λ_1^2\cos^2 α + λ_2^2 \sin^2 α}\) となります。このスケーリングは、同じ方向を持つすべての直線に共通であるため、平行線の長さの比で相殺されます。
(iii) <strong>面積の比</strong>　この不変性は、分解(2.12)から直接導かれます。回転と並進は面積に影響を与えないため、ここでは\(λ_1\)と\(λ_2\)によるスケーリングのみが重要になります。その結果、面積は\(λ_1λ_2\)でスケーリングされ、これはdet Aに等しくなります。したがって、任意の図形の面積は\(det\, A\)でスケーリングされるため、スケーリングは面積の比で相殺されます。これは射影変換には当てはまらないことがわかります。
<!--
<strong>Invariants</strong>　Because an affine transformation includes non-isotropic scaling, the similarity invariants of length ratios and angles between lines are not preserved under an affinity. Three important invariants are:
(i) <strong>Parallel lines</strong>　Consider two parallel lines. These intersect at a point
\((x_1, x_2, 0)^T\) at infinity. Under an affine transformation this point is mapped to another point at infinity. Consequently, the parallel lines are mapped to lines which still intersect at infinity, and so are parallel after the transformation.
(ii) <strong>Ratio of lengths of parallel line segments</strong>　The length scaling of a line segment depends only on the angle between the line direction and scaling directions. Suppose the line is at angle \(α\) to the x-axis of the orthogonal scaling direction, then the scaling magnitude is
\(\sqrt{λ_1^2\cos^2 α + λ_2^2 \sin^2 α}\). This scaling is
common to all lines with the same direction, and so cancels out in a ratio of
parallel segment lengths.
(iii) <strong>Ratio of areas</strong>　This invariance can be deduced directly from the decomposition
(2.12). Rotations and translations do not affect area, so only the scalings by
\(λ_1\) and \(λ_2\) matter here. The effect is that area is scaled by \(λ_1λ_2\) which is equal to
det A. Thus the area of any shape is scaled by \(det\, A\), and so the scaling cancels
out for a ratio of areas. It will be seen that this does not hold for a projective
transformation.
-->
</p><p>
親和性は、det A が正か負かに応じて、それぞれ向きを保存するか、向きを反転するかを決定します。\(det\, A = λ_1λ_2\) なので、この性質はスケーリングの符号のみに依存します。
<!--
An affinity is orientation-preserving or -reversing according to whether det A is positive
or negative respectively. Since \(det\, A = λ_1λ_2\) the property depends only on the sign of
the scalings.
-->
</p>
<h3>2.4.4 クラスIV: 射影変換</h3>
<!--
<h3>2.4.4 Class IV: Projective transformations</h3>
-->
<p>
射影変換は(2.5)で定義されました。これは、同次座標の一般的な非特異線型変換です。これは、同次でない座標の一般的な非特異線型変換と平行移動の合成であるアフィン変換を一般化したものです。射影変換の作用については既に見ました（2.3節）。ここでは、そのブロック形式を調べます。
<!--
A projective transformation was defined in (2.5). It is a general non-singular linear
transformation of homogeneous coordinates. This generalizes an affine transformation,
which is the composition of a general non-singular linear transformation of inhomogeneous
coordinates and a translation. We have earlier seen the action of a projective
transformation (in section 2.3). Here we examine its block form
-->
\[
\mathbf x^\prime = HP\mathbf x =
\begin{bmatrix}
A & t \\
\mathbf v^T & v
\end{bmatrix}
\mathbf x
\tag{2.13}
\]
ここでベクトル \(\mathbf v = (v_1, v_2)^T\) です。行列には9つの要素があり、それらの比のみが重要なので、変換は8つのパラメータで指定されます。\(v\) が0になる可能性もあるため、行列を \(v\) が1になるようにスケーリングすることが常に可能であるとは限らないことに注意してください。2つの平面間の射影変換は、どちらの平面にも3点が同一線上にない4点の対応から計算できます。図2.4を参照してください。
<!--
where the vector \(\mathbf v = (v_1, v_2)^T\). The matrix has nine elements with only their ratio
significant, so the transformation is specified by eight parameters. Note, it is not always
possible to scale the matrix such that \(v\) is unity since \(v\) might be zero. A projective
transformation between two planes can be computed from four point correspondences,
with no three collinear on either plane. See figure 2.4.
-->
</p><p>
アフィニティの場合とは異なり、\(\mathbb P^2\) においては、向きを保存する射影性と向きを反転させる射影性を区別することはできません。この点については2.6節で再度説明します。
<!--
Unlike the case of affinities, it is not possible to distinguish between orientation
preserving and orientation reversing projectivities in \(\mathbb P^2\). We will return to this point in section 2.6.
-->
</p><p>
<strong>不変量</strong>　最も基本的な射影不変量は、同一直線上にある4点の交差比です。直線上の長さの比は、アフィニティに対しては不変ですが、射影性に対しては不変ではありません。しかし、直線上の長さの比、つまり交差比は射影不変量です。この不変量の性質については、2.5節で改めて説明します。
<!--
<strong>Invariants</strong>　The most fundamental projective invariant is the cross ratio of four collinear points: a ratio of lengths on a line is invariant under affinities, but not under
projectivities. However, a ratio of ratios or cross ratio of lengths on a line is a
projective invariant. We return to properties of this invariant in section 2.5.
-->
</p>
<h3>2.4.5 まとめと比較</h3>
<!--
<h3>2.4.5 Summary and comparison</h3>
-->
<p>
親和性 (6 自由度) は、相似性 (4 自由度) と射影性 (8 自由度) の中間に位置します。親和性は相似性を一般化したものであって、角度は保存されないため、変換によって形状が歪むという性質を持ちます。一方で、親和性の作用は平面上で一様です。つまり、親和性が与えられた場合、オブジェクト (正方形など) の面積の det A スケーリングは平面上のどこでも同じです。また、変換された線の向きは、平面上の位置ではなく、初期の向きにのみ左右されます。これに対し、射影変換が与えられた場合、面積のスケーリングは位置によって変化します (たとえば、透視図法では、平面上のより遠い正方形は、図 2.6 に示すように、より近い正方形よりも像が小さくなります)。また、変換された線の向きは、元の線の向きと位置の両方に左右されます (ただし、線の消失点は線の向きにのみ左右され、位置には左右されないことが、第 8.6 節で後ほど説明します)。
<!--
Affinities (6 dof) occupy the middle ground between similarities (4 dof) and projectivities (8 dof). They generalize similarities in that angles are not preserved, so that shapes are skewed under the transformation. On the other hand their action is homogeneous over the plane: for a given affinity the det A scaling in area of an object (e.g. a square) is the same anywhere on the plane; and the orientation of a transformed line depends only on its initial orientation, not on its position on the plane. In contrast, for a given projective transformation, area scaling varies with position (e.g. under perspective a more distant square on the plane has a smaller image than one that is nearer, as in figure 2.6); and the orientation of a transformed line depends on both the orientation and position of the source line (however, it will be seen later in section 8.6 that a line's vanishing point depends only on line orientation, not position).
-->
</p><p>
射影変換とアフィン変換の主な違いは、射影性を持つベクトル\(\mathbf v\)が零ではないことです。これが射影性の非線形効果の原因です。アフィニティと射影性を持つ理想点\((x_1, x_2, 0)^T\)の写像を比較してみましょう。まず、アフィン変換は
<!--
The key difference between a projective and affine transformation is that the vector 
\(\mathbf v\) is not null for a projectivity. This is responsible for the non-linear effects of the
projectivity. Compare the mapping of an ideal point \((x_1, x_2, 0)^T\) under an affinity and
projectivity: First the affine transformation
-->
\[
\begin{bmatrix}
A & t \\
0^T & 1
\end{bmatrix}
\begin{pmatrix}
x_1 \\
x_2 \\
0
\end{pmatrix}
\begin{pmatrix}
A
\begin{pmatrix}
x_1 \\
x_2
\end{pmatrix} \\
0
\end{pmatrix}
\tag{2.14}
\]
第二に射影変換
<!--
Second the projective transformation
-->
\[
\begin{bmatrix}
A & t \\
\mathbf v^T & v
\end{bmatrix}
\begin{pmatrix}
x_1 \\
x_2 \\
0
\end{pmatrix}
\begin{pmatrix}
A
\begin{pmatrix}
x_1 \\
x_2
\end{pmatrix} \\
v_1x_1+v_2x_2
\end{pmatrix}
\tag{2.15}
\]
前者の場合、理想点は理想点のまま（つまり無限遠）です。後者の場合、理想点は有限点に写像されます。この性質により、射影変換によって消失点をモデル化することが可能になります。
<!--
In the first case the ideal point remains ideal (i.e. at infinity). In the second it is mapped
to a finite point. It is this ability which allows a projective transformation to model
vanishing points.
-->
</p>
<h3>2.4.6 射影変換の分解</h3>
<!--
<h3>2.4.6 Decomposition of a projective transformation</h3>
-->
<p>
射影変換は、変換の連鎖に分解できます。連鎖内の各行列は、前の変換よりも階層的に上位の変換を表します。
<!--
A projective transformation can be decomposed into a chain of transformations, where
each matrix in the chain represents a transformation higher in the hierarchy than the
previous one.
-->
\[
H = H_S H_A H_P =
\begin{bmatrix}
sR & t \\
0^T & 1
\end{bmatrix}
\begin{bmatrix}
K & 0 \\
0^T & 1
\end{bmatrix}
\begin{bmatrix}
I & 0 \\
\mathbf v^T & v
\end{bmatrix}
=
\begin{bmatrix}
A & t \\
\mathbf v^T & v
\end{bmatrix}
\tag{2.16}
\]
ここで、\(A\)は\(A = sRK+tv^T\)で与えられる非特異行列であり、\(K\)は\(det K = 1\)で正規化された上三角行列である。この分解は\(v\neq 0\)の条件で有効であり、\(s\)が正の場合には一意である。
<!--
with \(A\) a non-singular matrix given by \(A = sRK+tv^T\), and \(K\) an upper-triangular matrix
normalized as \(det K = 1\). This decomposition is valid provided \(v\neq 0\), and is unique if \(s\) is chosen positive.
-->
</p><p>
各行列 \(H_S, H_A, H_P\) は、そのタイプの変換の「本質」です（添え字 S、A、P で示されます）。例 2.12 に示すように、平面の透視像を平行化する処理を考えてみましょう。\(H_P\) (2 自由度) は無限遠直線を移動します。\(H_A\) (2 自由度) はアフィン変換の性質に影響を与えますが、無限遠直線は移動しません。最後に、\(H_S\) は一般的な相似変換 (4 自由度) であり、アフィン変換の性質や射影変換の性質には影響を与えません。変換 \(H_P\) は、セクション A7.3 で説明されている消去です。
<!--
Each of the matrices \(H_S, H_A, H_P\) is the “essence” of a transformation of that type (as
indicated by the subscripts S, A, P). Consider the process of rectifying the perspective
image of a plane as in example 2.12: \(H_P\) (2 dof) moves the line at infinity; \(H_A\) (2 dof)
affects the affine properties, but does not move the line at infinity; and finally, \(H_S\) is a
general similarity transformation (4 dof) which does not affect the affine or projective
properties. The transformation \(H_P\) is an elation, described in section A7.3.
-->
</p><p>
<strong>例2.15</strong>　射影変換
<!--
<strong>Example 2.15</strong>　The projective transformation
-->
\[
H =
\begin{bmatrix}
1.707 & 0.586 & 1.0 \\
2.707 & 8.242 & 2.0 \\
1.0 & 2.0 & 1.0
\end{bmatrix}
\]
は次のように分解できる。
<!--
may be decomposed as
-->
\[
H =
\begin{bmatrix}
2\cos 45^{\circ} & -2\sin 45^{\circ} & 1\\
2\sin 45^{\circ} & 2\cos 45^{\circ} & 2 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
0.5 & 1 & 0 \\
0 & 2 & 0 \\
0 & 0 & 1
\end{bmatrix}
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
1 & 2 & 1
\end{bmatrix}
\]
この分解は、変換を部分的にのみ決定することが目的である場合に使用できます。例えば、平面の透視図から長さの比を測定したい場合、相似までの変換を決定（補正）するだけで済みます。このアプローチについては、2.7節で説明します。
<!--
This decomposition can be employed when the objective is to only partially determine
the transformation. For example, if one wants to measure length ratios from the
perspective image of a plane, then it is only necessary to determine (rectify) the transformation
up to a similarity. We return to this approach in section 2.7.
-->
</p><p>
(2.16) の \(H\) の逆変換をとると \(H^{−1} = H_p^{−1}H_A^{−1}H_S^{−1}\) が得られる。\(H_P^{−1}, H_A^{−1}\)、\(H_S^{−1}\) はそれぞれ射影変換、アフィン変換、相似変換であるため、一般的な射影変換は次の形に分解することもできる。
<!--
Taking the inverse of \(H\) in (2.16) gives \(H^{−1} = H_p^{−1}H_A^{−1}H_S^{−1}\) . Since \(H_P^{−1}, H_A^{−1}\) and \(H_S^{−1}\) are
still projective, affine and similarity transformations respectively, a general projective
transformation may also be decomposed in the form
-->
\[
H = H_P H_A H_S =
\begin{bmatrix}
I & 0 \\
\mathbf v^T & 1
\end{bmatrix}
\begin{bmatrix}
K & 0 \\
0^T & 1
\end{bmatrix}
\begin{bmatrix}
sR & t \\
0^T & 1
\end{bmatrix}
\tag{2.17}
\]
\(K, R, t\)と\(v\)の実際の値は(2.16)の値とは異なることに注意してください。
<!--
Note that the actual values of \(K, R, t\) and \(v\) will be different from those of (2.16).
-->
</p>
<h3>2.4.7 不変量の数</h3>
<!--
<h3>2.4.7 The number of invariants</h3>
-->
<p>
特定の変換のもとで、与えられた幾何学的構成に対して不変量がいくつ存在するかという疑問が自然に生じる。まず、「数」という用語をより正確にする必要がある。なぜなら、ユークリッド変換のもとで長さのように量が不変であれば、その量の任意の関数も不変だからである。したがって、関数的に独立な不変量の数を数える議論を求める。不変量を形成するために除去しなければならない変換パラメータの数を考慮すると、次のことがわかる。
<!--
The question naturally arises as to how many invariants there are for a given geometric
configuration under a particular transformation. First the term “number” needs to be
made more precise, for if a quantity is invariant, such as length under Euclidean transformations,
then any function of that quantity is invariant. Consequently, we seek a
counting argument for the number of functionally independent invariants. By considering
the number of transformation parameters that must be eliminated in order to form
an invariant, it can be seen that:
-->
</p><p>
<strong>結果 2.16</strong>　機能的に独立な不変量の数は、配置の自由度の数から変換の自由度の数を引いた数と等しいか、それより大きくなります。
<!--
<strong>Result 2.16</strong>　The number of functionally independent invariants is equal to, or greater
than, the number of degrees of freedom of the configuration less the number of degrees
of freedom of the transformation.
-->
</p><p>
例えば、一般的な位置にある4点の配置には8つの自由度（各点につき2つ）があり、これらの変換はそれぞれ4、6、8つの自由度を持つため、相似度は4つ、類似度は2つ、射影不変量は0となります。
<!--
For example, a configuration of four points in general position has 8 degrees of freedom
(2 for each point), and so 4 similarity, 2 affinity and zero projective invariants since
these transformations have respectively 4, 6 and 8 degrees of freedom.
-->
</p><p>
表2.1は、2次元変換群とその不変特性をまとめたものです。表の下の方にある変換は、上方にある変換の特殊化です。表の下の方にある変換は、上方にある変換の不変特性を継承します。
<!--
Table 2.1 summarizes the 2D transformation groups and their invariant properties.
Transformations lower in the table are specializations of those above. A transformation
lower in the table inherits the invariants of those above.
-->
</p>
<center><img src="images/table2_1.png"></center>
<p>
表 2.1. 一般的な平面変換に対して不変な幾何学的性質。行列 \(A = [a_{ij} ]\) は可逆な 2 × 2 行列、\(R = [r_{ij} ]\) は 2 次元回転行列、\((t_x, t_y)\) は 2 次元並進行列である。
歪みの列は、正方形に対する変換の典型的な効果を示している。表の上位にある変換は、下位の変換のすべての作用を引き起こす可能性がある。これらは、並進と回転のみが発生するユークリッド変換から、正方形を任意の四辺形（3 点が同一直線上にない場合）に変換できる射影変換までの範囲である。
<!--
Table 2.1. Geometric properties invariant to commonly occurring planar transformations. The
matrix \(A = [a_{ij} ]\) is an invertible 2 × 2 matrix, \(R = [r_{ij} ]\) is a 2D rotation matrix, and \((t_x, t_y)\) a 2D translation.
The distortion column shows typical effects of the transformations on a square. Transformations
higher in the table can produce all the actions of the ones below. These range from Euclidean, where
only translations and rotations occur, to projective where the square can be transformed to any arbitrary
quadrilateral (provided no three points are collinear).
-->
</p>
<h2><center>2.5 1次元の射影幾何学</center></h2>
<!--
<h2><center>2.5 The projective geometry of 1D</center></h2>
-->
<p>
直線の射影幾何学 \(\mathbb P^1\) の展開は、平面の展開とほぼ同じように進む。直線上の点 \(x\) は同次座標 \((x_1, x_2)^T\) で表され、\(x_2 = 0\) となる点は直線の理想点である。2次元ベクトル \((x_1, x_2)^T\) を表すために、表記法 \(\overline{x}\) を用いる。直線の射影変換は、2 × 2 の同次行列で表される。
<!--
The development of the projective geometry of a line, \(\mathbb P^1\), proceeds in much the same
way as that of the plane. A point \(x\) on the line is represented by homogeneous coordinates
\((x_1, x_2)^T\), and a point for which \(x_2 = 0\) is an ideal point of the line. We will use
the notation \(\overline{x}\) to represent the 2-vector \((x_1, x_2)^T\). A projective transformation of a line
is represented by a 2 × 2 homogeneous matrix,
-->
\[
\overline{x}^\prime = H_{2×2}\overline{x}
\]
行列の4つの要素から全体のスケーリングのための1を引いた3つの自由度を持ちます。直線の射影変換は、対応する3つの点から決定できます。
<!--
and has 3 degrees of freedom corresponding to the four elements of the matrix less one
for overall scaling. A projective transformation of a line may be determined from three
corresponding points.
-->
</p>
<center><img src="images/fig2_8.png"></center>
<p>
図2.8. 直線間の射影変換。この図には、同一線上にある4点の集合が4つあります。各集合は、直線間の射影性によって互いに関連しています。複比は射影性に関して不変量であるため、示されているすべての集合において複比は同じ値を持ちます。
<!--
Fig. 2.8. Projective transformations between lines. There are four sets of four collinear points in this
figure. Each set is related to the others by a line-to-line projectivity. Since the cross ratio is an invariant
under a projectivity, the cross ratio has the same value for all the sets shown.
-->
</p><p>
<strong>複比</strong>　複比は\(\mathbb P^1\)の基本的な射影不変量です。4点\(\overline{x}_i\)が与えられたとき、複比は次のように定義されます。
<!--
<strong>The cross ratio</strong>　The cross ratio is the basic projective invariant of \(\mathbb P^1\). Given 4 points
\(\overline{x}_i\) the cross ratio is defined as
-->
\[
Cross(\overline{x}_1, \overline{x}_2,\overline{x}_3, \overline{x}_4) =\frac{|\overline{x}_1\overline{x}_2||\overline{x}_3\overline{x}_4|}{|\overline{x}_1\overline{x}_3||\overline{x}_2\overline{x}_4|}
\]
ここで
<!-- where -->
\[
|\overline{x}_i\overline{x}_j|=det
\begin{bmatrix}
x_{i1} & x_{j1} \\
x_{i2} & x_{j2}
\end{bmatrix}
\]
複比についていくつかコメントします。
(i) 複比の値は、点 \(\overline{x}_i\) のどの同次代表点が使用されるかには依存しません。これは、分子と分母の間でスケールが打ち消されるためです。
(ii) 各点 \(\overline{x}_i\) が有限点であり、同次代表点が \(x_2 = 1\) となるように選択される場合、\(|\overline{x}_i\overline{x}_j|\) は \(\overline{x}_i\) から \(\overline{x}_j\) までの符号付き距離を表します。
(iii) 複比の定義は、点 \(\overline{x}_i\) の1つが理想点である場合にも有効です。
(iv) 複比の値は直線の任意の射影変換に対して不変である: \(\overline{x}^\prime= H_{2×2}\overline{x}\) ならば
<!--
A few comments on the cross ratio:
(i) The value of the cross ratio is not dependent on which particular homogeneous
representative of a point \(\overline{x}_i\) is used, since the scale cancels between numerator
and denominator.
(ii) If each point \(\overline{x}_i\) is a finite point and the homogeneous representative is chosen
such that \(x_2 = 1\), then \(|\overline{x}_i\overline{x}_j|\) represents the signed distance from \(\overline{x}_i\) to \(\overline{x}_j\).
(iii) The definition of the cross ratio is also valid if one of the points \(\overline{x}_i\) is an ideal point.
(iv) The value of the cross ratio is invariant under any projective transformation of the line: if \(\overline{x}^\prime= H_{2×2}\overline{x}\) then
-->
\[
Cross(\overline{x}_1^\prime,\overline{x}_2^\prime, \overline{x}_3^\prime, \overline{x}_4^\prime)=Cross(\overline{x}_1,\overline{x}_2, \overline{x}_3. \overline{x}_4) \tag{2.18}
\]
証明は演習問題として残しておきます。等価的に言えば、複比は直線に選択された射影座標系に対して不変です。
<!--
The proof is left as an exercise. Equivalently stated, the cross ratio is invariant
to the projective coordinate frame chosen for the line.
-->
</p><p>
図2.8は、等価な複比を持つ直線間の射影変換をいくつか示しています。
<!--
Figure 2.8 illustrates a number of projective transformations between lines with equivalent
cross ratios.
-->
</p><p>
平面の射影変換のもとでは、平面上の任意の直線上に1次元の射影変換が誘導されます。
<!--
Under a projective transformation of the plane, a 1D projective transformation is
induced on any line in the plane.
-->
</p><p>
<strong>並行直線</strong>　並行直線の配置は、直線上の共線点と双対である。これは、平面上の並行直線も \(\mathbb P^1\) の幾何学を持つことを意味する。特に、4本の並行直線は図2.9aに示すように複比を持つ。
<!--
<strong>Concurrent lines</strong>　A configuration of concurrent lines is dual to collinear points on
a line. This means that concurrent lines on a plane also have the geometry \(\mathbb P^1\). In
particular four concurrent lines have a cross ratio as illustrated in figure 2.9a.
-->
</p>
<center><img src="images/fig2_9.png"></center>
<p>
図 2.9. 共線。(a) 4本の共線 li は、直線 l と4点 \(\overline{x}_i\) で交差する。これらの直線の複比は平面の射影変換に対して不変である。その値は、点の複比 \(Cross(\overline{x}_1, \overline{x}_2, \overline{x}_3, \overline{x}_4)\) によって与えられる。(b) 共面上の点 xi は、中心 c への射影によって、直線 l (これも平面上にある) 上に結像される。結像点 ¯xi の複比は、結像直線 l の位置に対して不変である。
<!--
Fig. 2.9. Concurrent lines. (a) Four concurrent lines li intersect the line l in the four points \(\overline{x}_i\). The
cross ratio of these lines is an invariant to projective transformations of the plane. Its value is given
by the cross ratio of the points, \(Cross(\overline{x}_1, \overline{x}_2, \overline{x}_3, \overline{x}_4)\). (b) Coplanar points xi are imaged onto a line l
(also in the plane) by a projection with centre c. The cross ratio of the image points ¯xi is invariant to
the position of the image line l.
-->
</p><p>
図2.9bは、IP2内の点を1次元画像に投影したものとして考えることができることに注意してください。特に、cがカメラ中心、線lが画像線（画像平面の1次元版）を表す場合、点\(\overline{x}_i\)は点\(x_i\)の画像への投影です。点\(\overline{x}_i\)の複比は、4つの画像点の射影配置を特徴付けます。4つの画像点の射影配置に関しては、画像線の実際の位置は無関係であることに注意してください。異なる画像線の選択は、射影的に等価な画像点配置を生み出します。
<!--
Note how figure 2.9b may be thought of as representing projection of points in IP2
into a 1-dimensional image. In particular, if c represents a camera centre, and the line
l represents an image line (1D analogue of the image plane), then the points \(\overline{x}_i\) are the
projections of points \(x_i\) into the image. The cross ratio of the points \(\overline{x}_i\) characterizes
the projective configuration of the four image points. Note that the actual position
of the image line is irrelevant as far as the projective configuration of the four image
points is concerned – different choices of image line give rise to projectively equivalent
configurations of image points.
-->
</p><p>
並行直線の射影幾何学は、第9章のエピポーラ直線の射影幾何学を理解する上で重要です。
<!--
The projective geometry of concurrent lines is important to the understanding of the
projective geometry of epipolar lines in chapter 9.
-->
</p>
<h2><center>2.6 射影平面の位相</center></h2>
<!--
<h2><center>2.6 Topology of the projective plane</center></h2>
-->
<p>
\(\mathbb P^2\) の位相について簡単に触れます。このセクションの理解は、本書の残りの部分を理解するために必須ではありません。
<!--
We make brief mention of the topology of \(\mathbb P^2\). Understanding of this section is not
required for following the rest of the book.
-->
</p><p>
射影平面 \(\mathbb P^2\) は、すべての同次 3 次元ベクトルの集合として考えることができることを既に見てきました。この型のベクトル \(mathbf x = (x_1, x_2, x_3)^T\) は、非ゼロの係数を乗じて \(x_1^2 + x_2^2 + x_3^2= 1\) となるように正規化できます。このような点は、\(\mathbb R^3\) の単位球面上に存在します。しかし、任意のベクトル \(\mathbf x\) と \(−\mathbf x\) は、\(\mathbb P^2\) 内の同じ点を表します。なぜなら、それらのベクトルは乗法係数 −1 だけ異なるからです。したがって、\(\mathbb R^3\) 内の単位球面 \(S^2\) と射影平面 \(\mathbb P^2\) の間には2対1の対応関係があります。射影平面は、対点が同一視された単位球面として描くことができます。この表現では、\(\mathbb P^2\) 上の直線は、単位球面上の大円としてモデル化されます（これまでと同様に、対点が同一視されます）。球面上の任意の2つの異なる（非対心点の）点は、ちょうど1つの大円上にあり、任意の2つの大円は1点で交差することが確認できます（対心点は同一視されているため）。
<!--
We have seen that the projective plane \(\mathbb P^2\) may be thought of as the set of all homogeneous
3-vectors. A vector of this type \(mathbf x = (x_1, x_2, x_3)^T\) may be normalized by
multiplication by a non-zero factor so that \(x_1^2 + x_2^2 + x_3^2= 1\). Such a point lies on the
unit sphere in \(\mathbb R^3\). However, any vector \(\mathbf x\) and \(−\mathbf x\) represent the same point in \(\mathbb P^2\), since
they differ by a multiplicative factor, −1. Thus, there is a two-to-one correspondence
between the unit sphere \(S^2\) in \(\mathbb R^3\) and the projective plane \(\mathbb P^2\). The projective plane
may be pictured as the unit sphere with opposite points identified. In this representation,
a line in \(\mathbb P^2\) is modelled as a great circle on the unit sphere (as ever, with opposite
points identified). One may verify that any two distinct (non-antipodal) points on the
sphere lie on exactly one great circle, and any two great circles intersect in one point
(since antipodal points are identified).
-->
</p><p>
位相幾何学の用語で言えば、球面 \(S^2\) は \(\mathbb P^2\) の2層被覆空間です。これは、\(\mathbb P^2\) が単連結ではないことを意味し、\(\mathbb P^2\) には \(\mathbb P^2\) 内の点に縮約できないループが存在することを意味します。厳密に言えば、\(\mathbb P^2\) の基本群は位数2の巡回群です。
<!--
In the language of topology, the sphere \(S^2\) is a 2-sheeted covering space of \(\mathbb P^2\). This
implies that \(\mathbb P^2\) is not simply-connected, which means that there are loops in \(\mathbb P^2\) which
cannot be contracted to a point inside \(\mathbb P^2\). To be technical, the fundamental group of
\(\mathbb P^2\) is the cyclic group of order 2.
-->
</p>
<center><img src="images/fig2_10.png"></center>
<p>
図2.10. 曲面の位相。一般的な曲面は、正方形の紙（位相的には円盤）の辺を貼り合わせることで構築できます。いずれの場合も、正方形の対応する矢印の辺は、矢印の方向が一致するように貼り合わせます。こうして得られるのは、(a) 球面、(b) トーラス、(c) クラインの壺、(d) 射影平面です。実際の紙で実現できるのは球面とトーラスだけです。球面とトーラスは向きを変えることができますが、射影平面とクラインの壺は向きを変えることができません。
<!--
Fig. 2.10. Topology of surfaces. Common surfaces may be constructed from a paper square (topologically
a disk) with edges glued together. In each case, the matching arrow edges of the square are to
be glued together in such a way that the directions of the arrows match. One obtains (a) a sphere, (b)
a torus, (c) a Klein bottle and (d) a projective plane. Only the sphere and torus are actually realizable
with a real sheet of paper. The sphere and torus are orientable but the projective plane and Klein bottle
are not.
-->
</p><p>
射影平面を球面として対点を同一視するモデルでは、\(S^2\) の下半球面は省略できる。なぜなら、この半球面上の点は上半球面上の対点と同一だからである。この場合、\(\mathbb P^2\) は赤道上の対点を同一視することにより上半球面から構成できる。\(S^2\) の上半球面は位相的に円板と同じであるため、\(\mathbb P^2\) は単に境界上の対点を同一視した、つまり貼り合わせた円板に過ぎない。これは物理的に不可能である。円板の境界を貼り合わせることで位相空間を構成することは位相幾何学において一般的な方法であり、実際、任意の 2 次元多様体はこの方法で構成できる。これは図 2.10 に示されている。
<!--
In the model for the projective plane as a sphere with opposite points identified one
may dispense with the lower hemisphere of \(S^2\), since points in this hemisphere are
the same as the opposite points in the upper hemisphere. In this case, \(\mathbb P^2\) may be
constructed from the upper hemisphere by identifying opposite points on the equator.
Since the upper hemisphere of \(S^2\) is topologically the same as a disk, \(\mathbb P^2\) is simply
a disk with opposite points on its boundary identified, or glued together. This is not
physically possible. Constructing topological spaces by gluing the boundary of a disk
is a common method in topology, and in fact any 2-manifold may be constructed in this
way. This is illustrated in figure 2.10.
-->
</p><p>
射影平面 \(\mathbb P^2\) の注目すべき特徴は、向き付け不可能であることです。これは、面全体にわたって一貫した局所的な向き（例えば、向き付けされた座標軸のペアで表される）を定義することが不可能であることを意味します。これは図 2.11 に示されており、射影平面には向きを反転するパスが含まれていることが示されています。
<!--
A notable feature of the projective plane \(\mathbb P^2\) is that it is non-orientable. This means
that it is impossible to define a local orientation (represented for instance by a pair of
oriented coordinate axes) that is consistent over the whole surface. This is illustrated
in figure 2.11 in which it is shown that the projective plane contains an orientationreversing
path.
-->
</p><p>
\(\mathbb P^1\) の位相。同様に、1次元射影直線は、対点が同一視された1次元球面 \(S^1\)（つまり円）として同定できる。円の下半分は上半分と重複するため省略すると、円の上半分は線分と位相的に同値となる。したがって、\(\mathbb P^1\) は、2つの端点が同一視された線分、つまり円 \(S^1\) と位相的に同値である。
<!--
The topology of \(\mathbb P^1\). In a similar manner, the 1-dimensional projective line may be
identified as a 1-sphere \(S^1\) (that is, a circle) with opposite points identified. If we omit
the lower half of the circle, as being duplicated by the top half, then the top half of a
circle is topologically equivalent to a line segment. Thus \(\mathbb P^1\) is topologically equivalent
to a line segment with the two endpoints identified – namely a circle, \(S^1\).
-->
</p>
<h2><center>2.7 画像からのアフィン特性と距離特性の回復</center></h2>
<!--
<h2><center>2.7 Recovery of affine and metric properties from images</center></h2>
-->
<p>
例2.12の射影平行化の例に戻りましょう。ここでは、平面の透視像における射影歪みを、元の平面上で相似特性（角度、長さの比）を測定できる程度まで除去することを目的としました。この例では、平面上の4つの参照点（合計8つの自由度）の位置を指定し、参照点をそれらの像に写像する変換を明示的に計算することで、射影歪みを完全に除去しました。実際には、これは幾何学を過剰に指定しています。射影変換は相似変換よりも4つの自由度だけ多いため、計量特性を決定するには4つの自由度（8つではなく）を指定するだけで済みます。射影幾何学において、これらの4つの自由度は、幾何学的対象、すなわち無限遠直線 \(\mathbf l_∞\) (2自由度) と \(\mathbf l_∞\) 上の2つの円点 (2自由度) と関連付けられることで「物理的実体」を付与されます。この関連付けは、分解連鎖 (2.16) における行列の特定による同等の記述よりも、問題を推論する上でより直感的な方法となることがよくあります。
<!--
We return to the example of projective rectification of example 2.12 where the
aim was to remove the projective distortion in the perspective image of a plane to the
extent that similarity properties (angles, ratios of lengths) could be measured on the
original plane. In that example the projective distortion was completely removed by
specifying the position of four reference points on the plane (a total of 8 degrees of
freedom), and explicitly computing the transformation mapping the reference points to
their images. In fact this overspecifies the geometry – a projective transformation has
only 4 degrees of freedom more than a similarity, so it is only necessary to specify 4 degrees of freedom (not 8) in order to determine metric properties. In projective geometry
these 4 degrees of freedom are given “physical substance” by being associated with
geometric objects: the line at infinity \(\mathbf l_∞\) (2 dof), and the two circular points (2 dof)
on \(\mathbf l_∞\). This association is often a more intuitive way of reasoning about the problem
than the equivalent description in terms of specifying matrices in the decomposition
chain (2.16).
-->
</p><p>
以下では、\(\mathbf l_∞\) の像を指定すれば射影歪みを、円点の像を指定すればアフィン歪みを除去できることを示します。こうすると、残る歪みは相似性のみとなります。
<!--
In the following it is shown that the projective distortion may be removed once the
image of \(\mathbf l_∞\) is specified, and the affine distortion removed once the image of the circular
points is specified. Then the only remaining distortion is a similarity.
-->
</p>
<center><img src="images/fig2_11.png"></center>
<p>
図2.11. 面の向き。座標フレーム（図ではLで表されている）は、面上の経路に沿って移動し、最終的には開始点に戻る。(a)
は射影平面を表す。図示されている経路では、座標フレーム（一対の軸で表される）は、同じ点に戻る際に反転する。これは、正方形の境界における同一視によって一方の軸の方向が入れ替わるためである。このような経路は向き反転経路と呼ばれ、このような経路を含む面は向き付け不可能と呼ばれる。(b)は、長方形の2つの対角辺を結合して得られるメビウスの帯のよく知られた例を示している（M.C. エッシャー作「メビウスの帯 II [赤い蟻]」、1963年。
c 2000 Cordon Art B.V. – Baarn-Holland. All rights reserved）。検証すると、ストリップを一周する経路は方向反転になります。
<!--
Fig. 2.11. Orientation of surfaces. A coordinate frame (represented by an L in the diagram) may
be transported along a path in the surface eventually coming back to the point where it started. (a)
represents a projective plane. In the path shown, the coordinate frame (represented by a pair of axes) is
reversed when it returns to the same point, since the identification at the boundary of the square swaps
the direction of one of the axes. Such a path is called an orientation-reversing path, and a surface that
contains such a path is called non-orientable. (b) shows the well known example of a M¨obius strip
obtained by joining two opposite edges of a rectangle (M.C. Escher's “Moebius Strip II [Red Ants]”,
1963. 
c 2000 Cordon Art B.V. – Baarn-Holland. All rights reserved). As can be verified, a path once
around the strip is orientation-reversing.
-->
</p>
<h3>2.7.1 無限遠直線</h3>
<!--
<h3>2.7.1 The line at infinity</h3>
-->
<p>
射影変換の下では、イデアル点は有限点に写像される可能性がある (2.15)。したがって、\(\mathbf l_∞\) は有限直線に写像される。しかし、この変換が親和変換である場合、\(\mathbf l_∞\) は有限直線に写像されず、無限遠に留まる。これは直線変換 (2.6) から直接明らかである。
<!--
Under a projective transformation ideal points may be mapped to finite points (2.15),
and consequently \(\mathbf l_∞\) is mapped to a finite line. However, if the transformation is an
affinity, then \(\mathbf l_∞\) is not mapped to a finite line, but remains at infinity. This is evident
directly from the line transformation (2.6):
-->
\[
\mathbf l_\infty^\prime=H_A^{-T}\mathbf I_\infty=
\begin{bmatrix}
A^{-T} & 0 \\
-t^TA^{-T} & 1
\end{bmatrix}
\begin{pmatrix}
0 \\
0 \\
1
\end{pmatrix}
=
\begin{pmatrix}
0 \\
0 \\
1
\end{pmatrix}
=\mathbf l_\infty
\]
逆もまた真であり、アフィン変換は\(\mathbf l_∞\)を固定する最も一般的な線型変換であり、次のように考えることができます。無限遠点、例えば\(\mathbf x = (1, 0, 0)^T\)が無限遠点に写像されることを要求します。これは\(h_{31} = 0\)であることを必要とします。同様に、\(h_{32} = 0\)なので、この変換はアフィニティです。まとめると、
<!--
The converse is also true, i.e. an affine transformation is the most general linear transformation
that fixes \(\mathbf l_∞\), and may be seen as follows. We require that a point at infinity,
say \(\mathbf x = (1, 0, 0)^T\), be mapped to a point at infinity. This requires that \(h_{31} = 0\). Similarly,
 \(h_{32} = 0\), so the transformation is an affinity. To summarize,
-->
</p><p>
結果 2.17. 無限遠直線 \(\mathbf l_∞\) が射影変換 \(H\) に関して不動直線となるのは、\(H\) が親和性を持つ場合のみである。
<!--
Result 2.17. The line at infinity, \(\mathbf l_∞\), is a fixed line under the projective transformation
\(H\) if and only if \(H\) is an affinity.
-->
</p><p>
しかし、\(\mathbf l_∞\) はアフィン変換において点ごとに固定されません。(2.14) は、アフィニティ変換において \(\mathbf l_∞\) 上の点 (理想点) は \(\mathbf l_∞\) 上の点に写像されますが、\(A(x_1, x_2)^T = k(x_1, x_2)^T\) でない限り、同じ点ではないことを示しています。ここで、\(\mathbf l_∞\) を同一視することで、アフィン特性 (平行性、面積比) を回復できることが示されます。
<!--
However, \(\mathbf l_∞\) is not fixed pointwise under an affine transformation: (2.14) showed
that under an affinity a point on \(\mathbf l_∞\) (an ideal point) is mapped to a point on \(\mathbf l_∞\), but it is not the same point unless \(A(x_1, x_2)^T = k(x_1, x_2)^T\). It will now be shown that
identifying \(\mathbf l_∞\) allows the recovery of affine properties (parallelism, ratio of areas).
-->
</p>
<center><img src="images/fig2_12.png"></center>
<p>
図 2.12. アフィン平行化。射影変換は、ユークリッド平面 \(\pi_1\) 上の \((0, 0, 1)^T\) から平面 \(\pi_2\) 上の有限直線 \(\mathbf l\) への射影変換を構成する。射影変換が l を \((0, 0, 1)^T\) に戻すように構成される場合、結果 2.17 から、\(\mathbf l_∞\) の標準位置が保存されるため、第 1 平面と第 3 平面間の変換はアフィン変換でなければならない。これは、第 1 平面のアフィン特性が第 3 平面から測定できること、すなわち第 3 平面が第 1 平面の親和性内にあることを意味する。
<!--
Fig. 2.12. Affine rectification. A projective transformation maps \(\mathbf l_∞\) from \((0, 0, 1)^T\) on a Euclidean
plane \(\pi_1\) to a finite line \(\mathbf l\) on the plane \(\pi_2\). If a projective transformation is constructed such that l is
mapped back to \((0, 0, 1)^T\) then from result 2.17 the transformation between the first and third planes
must be an affine transformation since the canonical position of \(\mathbf l_∞\) is preserved. This means that affine
properties of the first plane can be measured from the third, i.e. the third plane is within an affinity of the
first.
-->
</p>
<h3>2.7.2 画像からのアフィン特性の回復</h3>
<!--
<h3>2.7.2 Recovery of affine properties from images</h3>
-->
<p>
平面の像において無限遠の像直線が特定されれば、元の平面上でアフィン測定が可能になります。例えば、像直線が像 \(\mathbf l_∞\) 上で交差する場合、その直線は元の平面上で平行であると特定できます。これは、ユークリッド平面上の平行直線が \(\mathbf l_∞\) 上で交差し、射影変換後も射影写像 \(\mathbf l_∞\) 上で交差するからです。これは、交差が射影性によって保存されるためです。同様に、\(\mathbf l_∞\) が特定されれば、直線上の長さの比は、長さを示す3点の複比と、直線と \(\mathbf l_∞\) の交点（これが複比の4番目の点となります）から計算できます。以下同様に続きます。
<!--
Once the imaged line at infinity is identified in an image of a plane, it is then possible to
make affine measurements on the original plane. For example, lines may be identified
as parallel on the original plane if the imaged lines intersect on the imaged \(\mathbf l_∞\). This
follows because parallel lines on the Euclidean plane intersect on \(\mathbf l_∞\), and after a projective
transformation the lines still intersect on the imaged \(\mathbf l_∞\) since intersections are
preserved by projectivities. Similarly, once \(\mathbf l_∞\) is identified a length ratio on a line may
be computed from the cross ratio of the three points specifying the lengths together
with the intersection of the line with \(\mathbf l_∞\) (which provides the fourth point for the cross
ratio), and so forth.
-->
</p><p>
しかし、計算アルゴリズムに適した、より簡便な方法は、単純に、特定された \(\mathbf l_∞\) をその標準位置 \(\mathbf l_∞ = (0, 0, 1)^T\) に変換することです。この変換を実現する（射影）行列は、画像内のすべての点に適用することができ、画像をアフィン平行化します。つまり、変換後、平行化された画像から直接アフィン測定を行うことができます。ここでの重要な考え方は、図2.12に示されています。
<!--
However, a less tortuous path which is better suited to computational algorithms is
simply to transform the identified \(\mathbf l_∞\) to its canonical position of \(\mathbf l_∞ = (0, 0, 1)^T\). The
(projective) matrix which achieves this transformation can be applied to every point
in the image in order to affinely rectify the image, i.e. after the transformation, affine
measurements can be made directly from the rectified image. The key idea here is
illustrated in figure 2.12.
-->
</p><p>
無限遠における像直線が直線 \(\mathbf l = (l_1, l_2, l_3)^T\) である場合、\(l_3\neq 0\) を仮定すると、l を \(\mathbf l_∞ = (0, 0, 1)^T\) に戻す適切な射影点変換は
<!--
If the imaged line at infinity is the line \(\mathbf l = (l_1, l_2, l_3)^T\), then provided \(l_3\neq 0\) a suitable
projective point transformation which will map l back to \(\mathbf l_∞ = (0, 0, 1)^T\) is
-->
\[
H=H_A
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
l_1 & l_2 & l_3
\end{bmatrix}
\tag{2.19}
\]
ここで\(H_A\)は任意のアフィン変換である（\(H\)の最終行は\(\mathbf l^T\)である）。直線変換(2.6)のもとで\(H^{−T}(l_1, l_2, l_3)^T = (0, 0, 1)^T = \mathbf l_∞\)が成り立つことが確認できる。
<!--
where \(H_A\) is any affine transformation (the last row of \(H\) is \(\mathbf l^T\)). One can verify that under
the line transformation (2.6) \(H^{−T}(l_1, l_2, l_3)^T = (0, 0, 1)^T = \mathbf l_∞\).
-->
</p>
<center><img src="images/fig2_13.png"></center>
<p>
図2.13. 消失線によるアフィン平行化。(a)に描かれた平面の消失線は、(c)に描かれた2組の平行線の交点から計算される。次に、この画像は射影的に歪められ、アフィン平行化画像(b)が生成される。アフィン平行化画像では、平行線は平行になる。しかし、角度はアフィン歪んでいるため、真の世界座標値を持たない。図2.17も参照のこと。
<!--
Fig. 2.13. Affine rectification via the vanishing line. The vanishing line of the plane imaged in (a) is
computed (c) from the intersection of two sets of imaged parallel lines. The image is then projectively
warped to produce the affinely rectified image (b). In the affinely rectified image parallel lines are now
parallel. However, angles do not have their veridical world value since they are affinely distorted. See
also figure 2.17.
-->
</p><p>
例 2.18. アフィン平行化
平面の透視像において、世界平面上の無限遠直線は、その平面の消失線として写像される。これについては第8章でより詳細に論じる。図2.13に示すように、消失線 l は、写像された平行線の交差によって計算できる。次に、射影ワーピング(2.19)を適用して、l をその標準位置 \(\mathbf l_∞\) = (0, 0, 1)T に写像することにより、像は平行化される。△
<!--
Example 2.18. Affine rectification
In a perspective image of a plane, the line at infinity on the world plane is imaged as the
vanishing line of the plane. This is discussed in more detail in chapter 8. As illustrated
in figure 2.13 the vanishing line l may be computed by intersecting imaged parallel
lines. The image is then rectified by applying a projective warping (2.19) such that l is
mapped to its canonical position \(\mathbf l_∞\) = (0, 0, 1)T. △
-->
</p><p>
この例は、直線（2自由度）を指定するだけでアフィン特性を復元できることを示しています。これは、変換分解連鎖（2.16）の射影成分のみを指定することと等価です。逆に、アフィン特性が既知であれば、それを用いて点と無限遠直線を決定できます。これは次の例で示されています。
<!--
This example shows that affine properties may be recovered by simply specifying a
line (2 dof). It is equivalent to specifying only the projective component of the transformation
decomposition chain (2.16). Conversely if affine properties are known, these
may be used to determine points and the line at infinity. This is illustrated in the following
example.
-->
</p><p>
例2.19. 長さの比から消失点を計算する。長さの比が既知の直線上の2つの区間が与えられれば、その直線上の無限遠点を決定できる。典型的な例としては、画像内の直線上に3つの点 \(\mathbf a^\prime, \mathbf b^\prime\)、\(\mathbf c^\prime\) が特定される場合が挙げられる。 \(\mathbf a, \mathbf b\) と \(\mathbf c\) が世界線上の対応する共線点であり、長さの比 \(d(\mathbf a, \mathbf b) : d(\mathbf b, \mathbf c) = a : b\) が既知であるとします（ここで \(d(\mathbf x, \mathbf y)\) は点 x と点 y 間のユークリッド距離です）。この複比を用いて消失点を求めることができます。同様に、以下のように進めることができます。
(i) 画像内の距離比 \(d(\mathbf a^\prime, \mathbf b^\prime) : d(\mathbf b^\prime, \mathbf c^\prime) = a^\prime : b^\prime\) を測定します。
(ii) 点 \(\mathbf a, \mathbf b\) と \(\mathbf c\) は、直線 \(\langle\mathbf a, \mathbf b, \mathbf c\rangle\) 上の座標フレームにおいて、座標 0、a、a+b として表すことができます。計算上、これらの点は同次 2 次元ベクトル \((0, 1)^T, (a, 1)^T\) と \((a + b, 1)^T\) で表されます。同様に、
\(\mathbf a^\prime, \mathbf b^\prime\) と \(\mathbf c^\prime\) は座標 0、a'、および a' + b' を持ち、次のように表すこともできます。
均一なベクトル。
(iii) これらの座標フレームを基準にして、1D 射影変換を計算します。
\(H_{2×2}\) マッピング \(\mathbf a\mapsto\mathbf a^\prime, \mathbf b\mapsto \mathbf b^\prime\) と \(\mathbf c\mapsto \mathbf c^\prime\)。
(iv) 無限遠点（座標 \((1, 0)^T\)）の \(H_{2×2}\) による像は、直線 \(\langle\mathbf a^\prime, \mathbf b^\prime, \mathbf c^\prime\rangle\) 上の消失点である。
<!--
Example 2.19. Computing a vanishing point from a length ratio. Given two intervals
on a line with a known length ratio, the point at infinity on the line may be
determined. A typical case is where three points \(\mathbf a^\prime, \mathbf b^\prime\) and \(\mathbf c^\prime\) are identified on a line in
an image. Suppose \(\mathbf a, \mathbf b\) and \(\mathbf c\) are the corresponding collinear points on the world line,
and the length ratio \(d(\mathbf a, \mathbf b) : d(\mathbf b, \mathbf c) = a : b\) is known (where \(d(\mathbf x, \mathbf y)\) is the Euclidean distance between the points x and y). It is possible to find the vanishing point using
the cross ratio. Equivalently, one may proceed as follows:
(i) Measure the distance ratio in the image, \(d(\mathbf a^\prime, \mathbf b^\prime) : d(\mathbf b^\prime, \mathbf c^\prime) = a^\prime :  b^\prime\).
(ii) Points \(\mathbf a, \mathbf b\) and \(\mathbf c\) may be represented as coordinates 0, a and a+b in a coordinate
frame on the line \(\langle\mathbf a, \mathbf b, \mathbf c\rangle\). For computational purposes, these points are represented
by homogeneous 2-vectors \((0, 1)^T, (a, 1)^T\) and \((a + b, 1)^T\). Similarly,
\(\mathbf a^\prime, \mathbf b^\prime\) and \(\mathbf c^\prime\) have coordinates 0, a′ and a′ + b′, which may also be expressed as
homogeneous vectors.
(iii) Relative to these coordinate frames, compute the 1D projective transformation
\(H_{2×2}\) mapping \(\mathbf a\mapsto\mathbf a^\prime, \mathbf b\mapsto \mathbf b^\prime\) and \(\mathbf c\mapsto \mathbf c^\prime\).
(iv) The image of the point at infinity (with coordinates \((1, 0)^T\)) under \(H_{2×2}\) is the
vanishing point on the line \(\langle\mathbf a^\prime, \mathbf b^\prime, \mathbf c^\prime\rangle\).
-->
</p><p>
この方法で計算された消失点の例を図2.14に示します。△
<!--
An example of vanishing points computed in this manner is shown in figure 2.14. △
-->
</p>
<center><img src="images/fig2_14.png"></center>
<p>
図2.14. 直線上の等長比を用いて無限遠点を求める2つの例。
使用される直線間隔は、点によって区切られた細い白線と太い白線で示されています。この作図によって平面の消失線が決定されます。図2.13cと比較してください。
<!--
Fig. 2.14. Two examples of using equal length ratios on a line to determine the point at infinity. The
line intervals used are shown as the thin and thick white lines delineated by points. This construction
determines the vanishing line of the plane. Compare with figure 2.13c.
-->
</p><p>
例 2.20. 長さの比から消失点を幾何学的に構築する。
図 2.14 に示す消失点は、以下の手順からなる純粋に幾何学的な構築によっても計算できる。
(i) 与えられたもの: 画像内の3つの共線的な点 \(\mathbf a^\prime, \mathbf b^\prime\)、\(\mathbf c^\prime\)。これらは、間隔比 a : b を持つ共線的な世界点に対応する。
(ii) \(\mathbf l\) から \(\mathbf a^\prime\) を通る直線 (\(\mathbf a^\prime \mathbf c^\prime\) とは一致しない) を描き、線分 \(\langle \mathbf a \mathbf b\rangle, \langle\mathbf b \mathbf c\rangle\) の長さ比が a : b となるように点 \(\mathbf a = \mathbf a^\prime, \mathbf b\) と \(\mathbf c\) を結び、\(\mathbf o\) で交差する。
(iv) \(\mathbf o\) を通り \(\mathbf l\) に平行な直線は消失点 \(\mathbf v^\prime\) で直線 \(\mathbf a^\prime \mathbf c^\prime\) と交わる。
<!--
Example 2.20. Geometric construction of vanishing points from a length ratio.
The vanishing points shown in figure 2.14 may also be computed by a purely geometric
construction consisting of the following steps:
(i) Given: three collinear points, \(\mathbf a^\prime, \mathbf b^\prime\) and \(\mathbf c^\prime\), in an image corresponding to
collinear world points with interval ratio a : b.
(ii) Draw any line \(\mathbf l\) through \(\mathbf a^\prime\) (not coincident with the line \(\mathbf a^\prime \mathbf c^\prime\)), and mark off
points \(\mathbf a = \mathbf a^\prime, \mathbf b\) and \(\mathbf c\) such that the line segments \(\langle \mathbf a \mathbf b\rangle, \langle\mathbf b \mathbf c\rangle\) have length ratio
a : b.
(iii) Join \(\mathbf b \mathbf b^\prime\) and \(\mathbf c \mathbf c^\prime\) and intersect in \(\mathbf o\).
(iv) The line through \(\mathbf o\) parallel to \(\mathbf l\) meets the line \(\mathbf a^\prime \mathbf c^\prime\) in the vanishing point \(\mathbf v^\prime\).
-->
</p><p>
この構造は図2.15に示されています。△
<!--
This construction is illustrated in figure 2.15. △
-->
</p>
<center><img src="images/fig2_15.png"></center>
<p>
図2.15. 長さの比が既知の直線上の無限遠点の像を決定する幾何学的作図。詳細は本文に記載されています。
<!--
Fig. 2.15. A geometric construction to determine the image of the point at infinity on a line given a
known length ratio. The details are given in the text.
-->
</p>
<h3>2.7.3 円の点とその双対</h3>
<!--
<h3>2.7.3 The circular points and their dual</h3>
-->
<p>
いかなる相似変換においても、\(\mathbf l_∞\) 上には固定された2つの点が存在する。これらは円周点（絶対点とも呼ばれる）\(\mathbf I, \mathbf J\) であり、その正準座標は
<!--
Under any similarity transformation there are two points on \(\mathbf l_∞\) which are fixed. These
are the circular points (also called the absolute points) \(\mathbf I, \mathbf J\), with canonical coordinates
-->
\[
I=
\begin{pmatrix}
1 \\
i \\
0
\end{pmatrix}
　
J=
\begin{pmatrix}
1 \\
-i \\
0
\end{pmatrix}
\]
円点は複素共役イデアル点のペアです。これらが方向保存相似則によって固定されていることを確認するには、次のようにします。
<!--
The circular points are a pair of complex conjugate ideal points. To see that they are
fixed under an orientation-preserving similarity:
-->
\[
\begin{align}
\mathbf I^\prime &= H_s\mathbf I \\
&=
\begin{bmatrix}
s\cos\theta & -s\sin\theta & t_x \\
s\sin\theta & s\cos\theta & t_y \\
0 & 0 & 1
\end{bmatrix}
\begin{pmatrix}
1 \\
i \\
0
\end{pmatrix} \\
&= se^{-i\theta}
\begin{pmatrix}
1 \\
i \\
0
\end{pmatrix}
= \mathbf I
\end{align}
\]
\(\mathbf J\) についても同様の証明が成り立ちます。鏡映変換により \(\mathbf I\) と \(\mathbf J\) が入れ替わります。逆もまた真です。つまり、円周上の点が固定されている場合、線形変換は相似です。証明は演習問題として残しておきます。まとめると、
<!--
with an analogous proof for \(\mathbf J\). A reflection swaps \(\mathbf I\) and \(\mathbf J\). The converse is also true,
i.e. if the circular points are fixed then the linear transformation is a similarity. The
proof is left as an exercise. To summarize,
-->
</p><p>
<strong>結果 2.21</strong>　円の点 \(\mathbf I\)、\(\mathbf J\) は、射影変換 \(H\) が相似である場合に限り、\(H\) の下で不動点となる。
<!--
<strong>Result 2.21</strong>　The circular points, \(\mathbf I\), \(\mathbf J\), are fixed points under the projective transformation
\(H\) if and only if \(H\) is a similarity.
-->
</p><p>
「円点」という名前は、すべての円が円点で \(\mathbf l_∞\) と交わることに由来します。これを理解するには、円錐曲線の式 (2.1) から始めましょう。円錐曲線が円の場合、\(a = c\) かつ \(b = 0\) です。すると、
<!--
The name “circular points” arises because every circle intersects \(\mathbf l_∞\) at the circular
points. To see this, start from equation (2.1) for a conic. In the case that the conic
is a circle: \(a = c\) and \(b = 0\). Then
-->
\[
x_1^2+x_2^2+dx_1x_3+ex_2x_3+fx_3^2=0
\]
ここでaは1とされている。この円錐曲線は、\(\mathbf l_∞\)と（理想的な）点で交わる。\(x_3 = 0\)、すなわち
<!--
where a has been set to unity. This conic intersects \(\mathbf l_∞\) in the (ideal) points for which
 \(x_3 = 0\), namely
-->
\[
x_1^2+x_2^2=0
\]
解は \(\mathbf I = (1, i, 0)^T, \mathbf J = (1,−i, 0)^T\) であり、すなわち任意の円は円上の点で \(\mathbf l_∞\) と交わる。ユークリッド幾何学では、円は3点で定義されることはよく知られている。円上の点は別の計算を可能にする。円は、5点で定義される円錐曲線の一般的な公式 (2.4) を用いて計算することができる。ここで、5点は、3点に2つの円上の点を加えたものである。
<!--
with solution \(\mathbf I = (1, i, 0)^T, \mathbf J = (1,−i, 0)^T\), i.e. any circle intersects \(\mathbf l_∞\) in the circular
points. In Euclidean geometry it is well known that a circle is specified by three points.
The circular points enable an alternative computation. A circle can be computed using
the general formula for a conic defined by five points (2.4), where the five points
are the three points augmented with the two circular points.
-->
</p><p>
2.7.5節では、円点（あるいはそれと等価な双対点、下記参照）を同定することで相似特性（角度、長さの比）を復元できることを示します。代数的には、円点はユークリッド幾何学の直交方向、\((1, 0, 0)^T\) と \((0, 1, 0)^T\) であり、単一の複素共役実体にパッケージ化されています。例：
<!--
In section 2.7.5 it will be shown that identifying the circular points (or equivalently
their dual, see below) allows the recovery of similarity properties (angles, ratios of
lengths). Algebraically, the circular points are the orthogonal directions of Euclidean
geometry, \((1, 0, 0)^T\) and \((0, 1, 0)^T\), packaged into a single complex conjugate entity,
e.g.
-->
\[
\mathbf I = (1, 0, 0)^T + i(0, 1, 0)^T.
\]
したがって、円形の点が特定されれば、直交性やその他の距離特性が決定されるのはそれほど驚くべきことではありません。
<!--
Consequently, it is not so surprising that once the circular points are identified, orthogonality,
and other metric properties, are then determined.
-->
</p><p>
<strong>円の点の双曲線</strong>　円の点
<!--
<strong>The conic dual to the circular points</strong>　The conic
-->
\[
C_\infty^∗ = \mathbf I\mathbf J^T + \mathbf J\mathbf I^T \tag{2.20}
\]
は円点の双対である。円錐曲線 \(C_\infty^∗\) は退化した（階数2の）直線円錐曲線である（2.2.3節参照）。これは2つの円点から構成される。ユークリッド座標系では、次のように表される。
<!--
is dual to the circular points. The conic \(C_\infty^∗\) is a degenerate (rank 2) line conic
(see section 2.2.3), which consists of the two circular points. In a Euclidean coordinate
system it is given by
-->
\[
C_\infty^* =
\begin{pmatrix}
1 \\
i \\
0
\end{pmatrix}
(1　-i　0)+
\begin{pmatrix}
1 \\
-i \\
0
\end{pmatrix}
(1　i　0)=
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 0 
\end{bmatrix}
\]
円錐曲線 \(C_\infty^∗\) は、円点の固定された性質と同様に、相似変換によって固定されます。円錐曲線が固定されるのは、変換規則の下で（スケールまで）同じ行列が得られる場合です。\(C_\infty^∗\) は双対円錐曲線であるため、結果 2.14 (\({C^∗}^\prime = HC^∗H^T\)) に従って変換されます。また、点変換 \(\mathbf x^\prime = H_S\mathbf x\) の下では、次のことが確認できます。
<!--
The conic \(C_\infty^∗\) is fixed under similarity transformations in an analogous fashion to the fixed properties of circular points. A conic is fixed if the same matrix results (up to scale) under the transformation rule. Since \(C_\infty^∗\) is a dual conic it transforms according to result 2.14 (\({C^∗}^\prime = HC^∗H^T\)), and one can verify that under the point transformation \(\mathbf x^\prime = H_S\mathbf x\),
-->
\[
{c_\infty^*}^\prime = H_sC_\infty^*H_s^T=C_\infty^*
\]
逆もまた真であり、
<!--
The converse is also true, and we have
-->
</p><p>
<strong>結果 2.22</strong> 双対円錐 \(C_\infty^∗\) が射影変換 \(H\) によって固定されるためには、\(H\) が相似である必要がある。
<!--
<strong>Result 2.22</strong>　The dual conic \(C_\infty^∗\) is fixed under the projective transformation \(H\) if and only if \(H\) is a similarity.
-->
</p><p>
任意の射影フレームにおける \(C_\infty^∗\) のいくつかの性質：
(i) \(C_\infty^∗\) は 4 つの自由度を持つ。3 × 3 の同次対称行列は 5 つの自由度を持つが、制約 det \(C_\infty^* = 0\) により自由度は 1 減少する。
(ii) \(\mathbf l_∞\) は \(C_\infty^*\) の零ベクトルである。これは定義から明らかである。円点は \(\mathbf l_∞\) 上にあり、\(\mathbf I^T\mathbf l_∞ = \mathbf J^T\mathbf l_∞ = 0\) となる。
<!--
Some properties of \(C_\infty^∗\) in any projective frame:
(i) \(C_\infty^∗\) has 4 degrees of freedom: a 3 × 3 homogeneous symmetric matrix has 5 degrees of freedom, but the constraint det \(C_\infty^* = 0\) reduces the degrees of freedom by 1.
(ii) \(\mathbf l_∞\) is the null vector of \(C_\infty^*\). This is clear from the definition: the circular points lie on \(\mathbf l_∞\), so that \(\mathbf I^T\mathbf l_∞ = \mathbf J^T\mathbf l_∞ = 0\); then
-->
\[
C_\infty^∗\mathbf l_∞ = (\mathbf I\mathbf J^T + \mathbf J\mathbf I^T)\mathbf l_∞ = \mathbf I(\mathbf J^T\mathbf l_∞) + \mathbf J(\mathbf I^T\mathbf l_∞) = 0
\]

</p>
<h3>2.7.4 射影平面上の角度</h3>
<!--
<h3>2.7.4 Angles on the projective plane</h3>
-->
<p>
ユークリッド幾何学では、2直線間の角度は、それらの法線の内積から計算されます。\(\mathbf l = (l_1, l_2, l_3)^T\) と \(\mathbf m = (m_1, m_2, m_3)^T\) の法線がそれぞれ \((l_1, l_2)^T, (m_1, m_2)^T\) に平行な場合、角度は
<!--
In Euclidean geometry the angle between two lines is computed from the dot product
of their normals. For the lines \(\mathbf l = (l_1, l_2, l_3)^T\) and \(\mathbf m = (m_1,m_2,m_3)^T\) with normals
parallel to \((l_1, l_2)^T, (m_1,m_2)^T\) respectively, the angle is
-->
\[
\cos\theta=\frac{l_1m_1+l_2m_2}{\sqrt{(l_1^2+l_2^2))m_1^2+m_2^2)}}
\tag{2.21}
\]
この表現の問題点は、\(\mathbf l\) と \(\mathbf m\) の最初の2つの成分が射影変換の下で明確に定義された変換特性を持たない（テンソルではない）ため、平面のアフィン変換または射影変換の後には(2.21)式を適用できないことである。しかし、射影変換に対して不変な(2.21)式の類似表現は、
<!--
The problem with this expression is that the first two components of \(\mathbf l\) and \(\mathbf m\) do not
have well defined transformation properties under projective transformations (they are
not tensors), and so (2.21) cannot be applied after an affine or projective transformation
of the plane. However, an analogous expression to (2.21) which is invariant to
projective transformations is
-->
\[
\cos\theta=\frac{\mathbf I^TC_\infty^*\mathbf m}{\sqrt{(\mathbf I^TC_\infty^*\mathbf I)(\mathbf m^TC_\infty^*\mathbf m)}}
\tag{2.22}
\]
ここで、\(C_\infty^∗\) は円点の双対円錐曲線である。ユークリッド座標系では、(2.22) は(2.21) に簡約されることは明らかである。(2.22) が射影変換に対して不変であることは、直線 (2.6) (\(\mathbf l^\prime = H^{−T}\mathbf l\)) と双対円錐曲線 (結果 2.14) (\({C^∗}^\prime = HC^∗H^T\)) の点変換 \(\mathbf x^\prime = H\mathbf x\) のもとでの変換規則を用いることで検証できる。例えば、分子は次のように変換される。
<!--
where \(C_\infty^∗\) is the conic dual to the circular points. It is clear that in a Euclidean coordinate
system (2.22) reduces to (2.21). It may be verified that (2.22) is invariant
to projective transformations by using the transformation rules for lines (2.6)
(\(\mathbf l^\prime = H^{−T}\mathbf l\)) and dual conics (result 2.14) (\({C^∗}^\prime = HC^∗H^T\)) under the point transformation
 \(\mathbf x^\prime = H\mathbf x\). For example, the numerator transforms as
-->
\[
\mathbf I^TC_\infty^*\mathbf m\mapsto \mathbf I^TH^{-1}HC_\infty^*H^TH^{-T}\mathbf m=\mathbf l^TC_\infty^*\mathbf m
\]
同質物体のスケールが分子と分母の間で打ち消されることも検証できる。したがって、(2.22)は射影座標系に対して不変である。まとめると、
<!--
It may also be verified that the scale of the homogeneous objects cancels between the
numerator and denominator. Thus (2.22) is indeed invariant to the projective frame. To
summarize, we have shown
-->
</p><p>
<strong>結果 2.23</strong>　円錐曲線 \(C_\infty^∗\) が射影平面上で同一視されると、ユークリッド角は (2.22) によって測定できる。
<!--
<strong>Result 2.23</strong>　Once the conic \(C_\infty^∗\) is identified on the projective plane then Euclidean
angles may be measured by (2.22).
-->
</p><p>
当然のことながら、
<!--
Note, as a corollary,
-->
</p><p>
<strong>結果 2.24</strong>　\(\mathbf l\) と \(\mathbf m\) の直線は​​、\(\mathbf l^TC_\infty^∗\mathbf m = 0\) のとき直交する。
<!--
<strong>Result 2.24</strong>　Lines \(\mathbf l\)  and \(\mathbf m\) are orthogonal if \(\mathbf l^TC_\infty^∗\mathbf m = 0\).
-->
</p><p>
幾何学的には、\(\mathbf l\) と \(\mathbf m\) が \(\mathbf l^TC_\infty^∗\mathbf m = 0\) を満たす場合、これらの直線は円錐曲線 \(C_\infty^∗\) に関して共役です（2.8.1 節参照）。
<!--
Geometrically, if \(\mathbf l\) and \(\mathbf m\) satisfy \(\mathbf l^TC_\infty^∗\mathbf m = 0\), then the lines are conjugate
(see section 2.8.1) with respect to the conic \(C_\infty^∗\).
-->
</p><p>
\(C_\infty^∗\) が特定されれば、<strong>長さの比</strong>も測定できます。図 2.16 に示す、頂点 \(\mathbf a, \mathbf b, \mathbf c\) を持つ三角形を考えます。標準的な三角関数の正弦定理から、長さの比は \(d(\mathbf b, \mathbf c) : d(\mathbf a, \mathbf c) = sin α : sin β\) となります。ここで、\(d(\mathbf x, \mathbf y)\) は、点 \(\mathbf x\) と点 \(\mathbf y\) 間のユークリッド距離を表します。 (2.22) を使用すると、cos α と cos β の両方が次のようになります。
射影フレームの線 \(\mathbf l^\prime = \mathbf a^\prime × \mathbf b^\prime, \mathbf m^\prime = \mathbf c^\prime × \mathbf a^\prime\) および \(\mathbf n^\prime = \mathbf b^\prime × \mathbf c^\prime\) から計算されます。 \(C_\infty^∗\) が指定されています。したがって、sin α、sin β、そしてそれ以降の両方が
比率 \(d(\mathbf a, \mathbf b) : d(\mathbf c, \mathbf a)\) は、射影マッピングされた点から決定できます。
<!--
<strong>Length ratios</strong> may also be measured once \(C_\infty^∗\) is identified. Consider the triangle
shown in figure 2.16 with vertices \(\mathbf a, \mathbf b, \mathbf c\). From the standard trigonometric sine rule
the ratio of lengths \(d(\mathbf b, \mathbf c) : d(\mathbf a, \mathbf c) = sin α : sin β\), where \(d(\mathbf x, \mathbf y)\) denotes the Euclidean
distance between the points \(\mathbf x\) and \(\mathbf y\). Using (2.22), both cos α and cos β may
be computed from the lines \(\mathbf l^\prime = \mathbf a^\prime × \mathbf b^\prime, \mathbf m^\prime = \mathbf c^\prime × \mathbf a^\prime\) and \(\mathbf n^\prime = \mathbf b^\prime × \mathbf c^\prime\) for any projective frame in which \(C_\infty^∗\) is specified. Consequently both sin α, sin β, and thence
the ratio \(d(\mathbf a, \mathbf b) : d(\mathbf c, \mathbf a)\), may be determined from the projectively mapped points.
-->
</p>
<center><img src="images/fig2_16.png"></center>
<p>
図2.16. <strong>長さの比</strong>　\(C_\infty^∗\) が同一視されると、射影歪んだ図形からユークリッド長さの比 \(d(\mathbf b, \mathbf c) : d(\mathbf a , \mathbf c)\) を測定できる。詳細は本文を参照。
<!--
Fig. 2.16. <strong>Length ratios</strong>　Once \(C_\infty^∗\) is identified the Euclidean length ratio \(d(\mathbf b, \mathbf c) : d(\mathbf a , \mathbf c)\) may be measured from the projectively distorted figure. See text for details.
-->
</p>
<h3>2.7.5 画像からのメトリックプロパティの回復</h3>
<!--
<h3>2.7.5 Recovery of metric properties from images</h3>
-->
<p>
セクション2.7.2と図2.12のアプローチ（\(\mathbf l_∞\) を指定することによってアフィン特性を回復する）と完全に類似したアプローチでは、平面の画像から円点をその標準位置に変換することによって計量特性を回復することができます。円点が画像内で特定され、その画像が射影変換 H によって平行化され、その射影変換 H によって円点が標準位置 (\(\mathbf l_∞\) 上の \((1,±i, 0)^T\)) に写像されるとします。結果2.21から、世界平面と平行化された画像間の変換は射影変換であり円点は固定されているため相似変換となります。
<!--
A completely analogous approach to that of section 2.7.2 and figure 2.12, where affine properties are recovered by specifying \(\mathbf l_∞\), enables metric properties to be recovered from an image of a plane by transforming the circular points to their canonical position. Suppose the circular points are identified in an image, and the image is then rectified by a projective transformation H that maps the imaged circular points to their canonical position (at \((1,±i, 0)^T\)) on \(\mathbf l_∞\). From result 2.21 the transformation between the world plane and the rectified image is then a similarity since it is projective and the circular
points are fixed.
-->
</p><p>
<strong>\(C_\infty^∗\) を用いた計量修正</strong>　双対円錐 \(C_\infty^∗\) は、計量修正に必要なすべての情報を簡潔にまとめています。これにより、射影変換の射影成分とアフィン成分の両方を決定で​​き、相似歪みのみが残ります。これは、射影性による変換から明らかです。点変換が \(\mathbf x^\prime = H\mathbf x\) であり、\(x\) 座標系がユークリッド座標系で \(\mathbf x^\prime\) が射影座標系である場合、\(C_\infty^∗\) は結果 2.14 (\({C^∗}^\prime = HC^∗H^T\)) に従って変換されます。\(H\) の分解連鎖 (2.17) を用いると、
<!--
<strong>Metric rectification using \(C_\infty^∗\)</strong>　The dual conic \(C_\infty^∗\) neatly packages all the information required for a metric rectification. It enables both the projective and affine components of a projective transformation to be determined, leaving only similarity distortions.  This is evident from its transformation under a projectivity. If the point transformation is \(\mathbf x^\prime = H\mathbf x\), where the \(x\)-coordinate frame is Euclidean and \(\mathbf x^\prime\) projective, \(C_\infty^∗\) transforms according to result 2.14 (\({C^∗}^\prime = HC^∗H^T\)). Using the decomposition chain (2.17) for \(H\)
-->
\[
\begin{align}
{C_\infty^*}^\prime &= (H_P H_A H_S)C_\infty^*(H_P H_A H_S)^T =(H_P H_A)(H_S C_\infty^*H_S^T)(H_A^TH_P^T) \\
&=(H_P H_A)C_\infty^*(H_A^T H_P^T) \\
&=
\begin{bmatrix}
KK^T & KK^T\mathbf v \\
\mathbf v^TKK^T & \mathbf v^TKK^T\mathbf v
\end{bmatrix}
\end{align}
\tag{2.23}
\]
射影成分 (\(\mathbf v\)) とアフィン成分 (K) は \(C_\infty^∗\) の像から直接決定されることは明らかであるが、(結果 2.22 により \(C_\infty^*\) は相似変換に対して不変であるため)
相似成分は未決定である。したがって、
<!--
It is clear that the projective (\(\mathbf v\)) and affine (K) components are determined directly from the image of \(C_\infty^∗\), but (since \(C_\infty^*\) is invariant to similarity transformation by result 2.22)
the similarity component is undetermined. Consequently,
-->
</p><p>
<strong>結果 2.25</strong>　円錐曲線 \(C_\infty^*\) が射影平面上で識別されると、射影歪みは相似まで修正される可能性があります。
<!--
<strong>Result 2.25</strong>　Once the conic \(C_\infty^*\) is identified on the projective plane then projective distortion may be rectified up to a similarity.
-->
</p><p>
実際、適切な平行化ホモグラフィは、画像内の特定された\({C_\infty^*}^\prime\)からSVD（セクションA4.4）を使用して直接得ることができる。\({C_\infty^*}^\prime\)のSVDは次のように書ける。
<!--
Actually, a suitable rectifying homography may be obtained directly from the identified \({C_\infty^*}^\prime\) in an image using the SVD (section A4.4): writing the SVD of \({C_\infty^*}^\prime\) as
-->
\[
{C_\infty^∗}^\prime = U
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 0
\end{bmatrix}
U^T
\]
すると(2.23)から、相似性を除いて、修正射影性は\(H = U\)となる。
<!--
then by inspection from (2.23) the rectifying projectivity is \(H = U\) up to a similarity.
-->
</p><p>
次の 2 つの例は、画像内で \(C_\infty^*\) が識別され、そこからメトリック修正が得られる典型的な状況を示しています。
<!--
The following two examples show typical situations where \(C_\infty^*\) may be identified in an image, and thence a metric rectification obtained.
-->
</p><p>
<strong>例 2.26. 計量平行化 I</strong><br>
画像がアフィン平行化されている場合（上記の例 2.18 のように）、計量平行化を決定するために、円周上の点の 2 つの自由度を指定する 2 つの制約条件が必要になります。これらの 2 つの制約条件は、世界平面上の 2 つの結像された直角から得られます。
<!--
<strong>Example 2.26. Metric rectification I</strong><br>
Suppose an image has been affinely rectified (as in example 2.18 above), then we require
two constraints to specify the 2 degrees of freedom of the circular points in order
to determine a metric rectification. These two constraints may be obtained from two
imaged right angles on the world plane.
-->
</p><p>
アフィン平行化画像内の直線\(\mathbf l^\prime\),\(\mathbf m^\prime\)が、世界平面上の直交直線対\(\mathbf l,\mathbf m\)に対応すると仮定する。結果2.24より\({\mathbf l^\prime}^T{C_\infty^*}^\prime \mathbf m^\prime = 0\)となり、(2.23)を用いて\(\mathbf v =\mathbf 0\)とする。
<!--
Suppose the lines \(\mathbf l^\prime\),\(\mathbf m^\prime\) in the affinely rectified image correspond to an orthogonal line pair \(\mathbf l,\mathbf m\) on the world plane. From result 2.24 \({\mathbf l^\prime}^T{C_\infty^*}^\prime \mathbf m^\prime = 0\), and using (2.23)
with \(\mathbf v =\mathbf  0\)
-->
\[
(l_1^\prime　l_2^\prime　l_3^\prime)
\begin{bmatrix}
KK^T & \mathbf 0 \\
\mathbf 0^T & 0
\end{bmatrix}
\begin{pmatrix}
m_1^\prime \\
m_2^\prime \\
m_3^\prime
\end{pmatrix}
= 0
\]
これは2×2行列\(\mathbf S = \mathbf K\mathbf K^T\)に対する線形制約です。行列\(\mathbf S = \mathbf K\mathbf K^T\)は3つの独立要素を持つ対称行列であり、したがって自由度は2です（全体のスケーリングは重要ではないため）。直交性条件は式(\(l_1^\prime, l_2^\prime)S(m_1^\prime,m_2^\prime)^T = 0\)に簡約され、次のように書き表すことができます。
<!--
which is a linear constraint on the 2 × 2 matrix \(\mathbf S = \mathbf K\mathbf K^T\). The matrix \(\mathbf S = \mathbf K\mathbf K^T\) is
symmetric with three independent elements, and thus 2 degrees of freedom (as the
overall scaling is unimportant). The orthogonality condition reduces to the equation
(\(l_1^\prime, l_2^\prime)S(m_1^\prime,m_2^\prime)^T = 0\) which may be written as
-->
\[
(l_1^\prime m_1^\prime,l_1^\prime m_2^\prime+l_2^\prime m_1^\prime,l_2^\prime m_2^\prime)\mathbf s=0
\]
ここで、\(\mathbf s = (s_{11}, s_{12}, s_{22})^T\) は \(\mathbf S\) を 3 次元ベクトルとして書き表したものである。このような直交直線対 2 つには 2 つの制約があり、これらを積み重ねることで 2 × 3 行列を生成できる。この場合、s は零ベクトルとして決定される。こうして \(\mathbf S\)、ひいては \(\mathbf K\) がスケールに合わせて得られる（コレスキー分解、セクション A4.2.1 による）。図 2.17 は、図 2.13 で計算されたアフィン平行化画像を計量的に平行化するために使用されている 2 つの直交直線対の例を示している。△
<!--
where \(\mathbf s = (s_{11}, s_{12}, s_{22})^T\) is \(\mathbf S\) written as a 3-vector. Two such orthogonal line pairs
provide two constraints which may be stacked to give a 2 × 3 matrix with s determined
as the null vector. Thus \(\mathbf S\), and hence \(\mathbf K\), is obtained up to scale (by Cholesky decomposition, section A4.2.1). Figure 2.17 shows an example of two orthogonal line pairs being used to metrically rectify the affinely rectified image computed in figure 2.13. △
-->
</p><p>
あるいは、計量平行化に必要な2つの制約は、像円または2つの既知の長さの比から得ることができます。円の場合、像円錐はアフィン平行化像では楕円となり、この楕円と（既知の）\(\mathbf l_∞\)との交点が、像円点を直接決定します。
<!--
Alternatively, the two constraints required for metric rectification may be obtained from
an imaged circle or two known length ratios. In the case of a circle, the image conic
is an ellipse in the affinely rectified image, and the intersection of this ellipse with the
(known) \(\mathbf l_∞\) directly determines the imaged circular points.
-->
</p><p>
円錐曲線 \(C_\infty^*\) は、次の例に示すように、最初に \(\mathbf l_∞\) を特定することなく、透視図で直接特定することもできます。
<!--
The conic \(C_\infty^*\) can alternatively be identified directly in a perspective image, without
first identifying \(\mathbf l_∞\), as is illustrated in the following example.
-->
</p><p>
<strong>例 2.27. 計量平行化 II</strong><br>
ここでは、平面の元の透視像（例 2.26 のアフィン平行化像ではない）から始める。直線 \(\mathbf l\) と m が世界平面上の直交直線の像であるとする。すると、結果 2.24 から \(\mathbf l^TC_\infty^*\mathbf m = 0\) が成り立ち、円錐曲線が点を含むという制約 (2.4) と同様に、\(C_\infty^*\) の元に線型制約が与えられる。すなわち、
<!--
<strong>Example 2.27. Metric rectification II</strong><br>
We start here from the original perspective image of the plane (not the affinely rectified image of example 2.26). Suppose lines \(\mathbf l\) and m are images of orthogonal lines on the
world plane; then from result 2.24 \(\mathbf l^TC_\infty^*\mathbf m = 0\), and in a similar manner to constraining a conic to contain a point (2.4), this provides a linear constraint on the elements of \(C_\infty^*\), namely
-->
\[
(l_1m_1, (l_1m_2 + l_2m_1)/2, l_2m_2, (l_1m_3 + l_3m_1)/2, (l_2m_3 + l_3m_2)/2, l_3m_3) \mathbf c = 0
\]
ここで、\(\mathbf c = (a, b, c, d, e, f)^T\) は、6次元ベクトルとして書かれた \(C_\infty^*\) の円錐行列 (2.3) である。このような制約条件を5つ重ねて5 × 6行列を形成でき、\(\mathbf c\)、したがって \(C_\infty^∗\) が零ベクトルとして得られる。これは、\(C_\infty^∗\) が世界平面上で直交する5本の直線対の像から線形に決定できることを示す。このような直線対制約条件を用いた計量平行化の例を図2.18に示す。△
<!--
where \(\mathbf c = (a, b, c, d, e, f)^T\) is the conic matrix (2.3) of \(C_\infty^*\) written as a 6-vector. Five such constraints can be stacked to form a 5 × 6 matrix, and \(\mathbf c\), and hence \(C_\infty^∗\), is obtained as the null vector. This shows that \(C_\infty^∗\) can be determined linearly from
the images of five line pairs which are orthogonal on the world plane. An example of
metric rectification using such line pair constraints is shown in figure 2.18. △
-->
</p><p>
<strong>層別化</strong>　例2.27では、\(C_\infty^∗\) を指定することで、アフィン歪みと射影歪みが1つのステップで決定されていることに注意してください。前の例2.26では、最初に射影歪みが除去され、次にアフィン歪みが除去されました。この2段階のアプローチは層別化と呼ばれます。同様のアプローチは3Dにも適用され、3D再構成に関する第10章と自動キャリブレーションに関する第19章で、3D射影再構成からメトリックを取得する際に用いられます。
<!--
<strong>Stratification</strong>　Note, in example 2.27 the affine and projective distortions are determined
in one step by specifying \(C_\infty^∗\). In the previous example 2.26 first the projective and subsequently the affine distortions were removed. This two-step approach is
termed stratified. Analogous approaches apply in 3D, and are employed in chapter 10 on 3D reconstruction and chapter 19 on auto-calibration, when obtaining a metric from a 3D projective reconstruction.
-->
</p>
<center><img src="images/fig2_17.png"></center>
<p>
図2.17. 直交線による計量補正 I. アフィン画像を計量補正するために必要なアフィン変換は、画像化された直交線から計算できる。(a) アフィン補正画像（図2.13）上で識別される2つの（平行でない）線分対は、世界平面上の直交線に対応する。(b) 計量補正画像。計量補正画像では、世界におけるすべての直交線は直交し、世界正方形は単位アスペクト比を持ち、世界円は円であることに注意されたい。
<!--
Fig. 2.17. Metric rectification via orthogonal lines I. The affine transformation required to metrically
rectify an affine image may be computed from imaged orthogonal lines. (a) Two (non-parallel) line pairs
identified on the affinely rectified image (figure 2.13) correspond to orthogonal lines on the world plane.
(b) The metrically rectified image. Note that in the metrically rectified image all lines orthogonal in the
world are orthogonal, world squares have unit aspect ratio, and world circles are circular.
-->
</p>
<center><img src="images/fig2_18.png"></center>
<p>
図2.18. 直交線による距離補正II。(a) 円錐曲線 \(C_\infty^*\) は、図示されている5つの直交線対を用いて、透視投影された平面（建物の正面の壁）上で決定されます。円錐曲線 \(C_\infty^*\) は円点を決定し、同様に、画像を距離補正するために必要な射影変換も決定します (b)。(a) に示されている画像は、図2.4 と同じ透視投影画像ですが、4つの画像点のワールド座標を指定することにより、透視投影の歪みが除去されています。
<!--
Fig. 2.18. Metric rectification via orthogonal lines II. (a) The conic \(C_\infty^*\) is determined on the perspectively
imaged plane (the front wall of the building) using the five orthogonal line pairs shown. The conic \(C_\infty^*\) determines the circular points, and equivalently the projective transformation necessary to metrically rectify the image (b). The image shown in (a) is the same perspective image as that of figure 2.4, where the perspective distortion was removed by specifying the world position of four image points.
-->
</p>
<center><img src="images/fig2_19.png"></center>
<p>
図 2.19. 極と極の関係。直線 \(\mathbf l = C\mathbf x\) は点 \(\mathbf x\) の円錐曲線 \(C\) に関する極であり、点 \(\mathbf x = C^{−1}\mathbf l\) は点 \(C\) に関する \(\mathbf l\) の極である。\(\mathbf x\) の極は、円錐曲線と、\(\mathbf x\) からの直線の接点で交差する。\(\mathbf y\) が \(\mathbf l\) 上にある場合、\(\mathbf y^T\mathbf l = \mathbf y^TC\mathbf x = 0\) である。 \(\mathbf x\) と \(\mathbf y\) が、\(\mathbf y^TC\mathbf x = 0\) を満たす場合、それらの点は共役である。
<!--
Fig. 2.19. The pole–polar relationship. The line \(\mathbf l = C\mathbf x\) is the polar of the point \(\mathbf x\) with respect to the
conic \(C\), and the point \(\mathbf x = C^{−1}\mathbf l\) is the pole of \(\mathbf l\) with respect to \(C\). The polar of \(\mathbf x\) intersects the conic at
the points of tangency of lines from \(\mathbf x\). If \(\mathbf y\) is on \(\mathbf l\) then \(\mathbf y^T\mathbf l = \mathbf y^TC\mathbf x = 0\). Points \(\mathbf x\) and \(\mathbf y\) which satisfy
\(\mathbf y^TC\mathbf x = 0\) are conjugate.
-->

</p>
<h2><center>2.8 双曲線のその他の性質</center></h2>
<!--
<h2><center>2.8 More properties of conics</center></h2>
-->
<p>
ここで、点、直線、円錐曲線の間にある重要な幾何学的関係、すなわち極性について紹介します。この関係の応用（直交性の表現）については、第8章で説明します。
<!--
We now introduce an important geometric relation between a point, line and conic,
which is termed polarity. Applications of this relation (to the representation of orthogonality)
are given in chapter 8.
-->
</p>
<h4>2.8.1 極と極の関係</h4>
<!--
<h3>2.8.1 The pole–polar relationship</h3>
-->
<p>
点 \(\mathbf x\) と円錐曲線 \(C\) は直線 \(\mathbf l = C\mathbf x\) を定義します。直線 \(\mathbf l\) は \(C\) に関する \(\mathbf x\) の極直線と呼ばれ、点 \(\mathbf x\) は \(C\) に関する \(\mathbf l\) の極直線です。
• 円錐曲線 C に関する点 \(\mathbf x\) の極直線 \(\mathbf l\) = C\mathbf x\) は、円錐曲線と2点で交わります。これらの点で C に接する2本の直線は、\(\mathbf x\) で交わります。
この関係は図 2.19 に示されています。
<!--
A point \(\mathbf x\) and conic \(C\) define a line \(\mathbf l = C\mathbf x\). The line \(\mathbf l\) is called the polar of \(\mathbf x\) with
respect to \(C\), and the point \(\mathbf x\) is the pole of \(\mathbf l\) with respect to \(C\).
• The polar line \(\mathbf l\) = C\mathbf x\) of the point \(\mathbf x\) with respect to a conic C intersects the conic in
two points. The two lines tangent to C at these points intersect at \(\mathbf x\).
This relationship is illustrated in figure 2.19.
-->
</p><p>
<strong>証明</strong>　\(C\)上の点\(\mathbf y\)を考えます。\(\mathbf y\)における接線は\(C\mathbf y\)であり、\(\mathbf x^TC\mathbf y = 0\)のとき、この線は\(\mathbf x\)を含みます。\(C\)の対称性を用いると、条件\(\mathbf x^TC\mathbf y = (C\mathbf x)^T\mathbf y = 0\)は、点\(\mathbf y\)が直線\(C\mathbf x\)上にあるということです。したがって、極直線\(C\mathbf x\)は、接線が\(\mathbf x\)を含む点\(\mathbf y\)で円錐曲線と交差します。
<!--
<strong>Proof</strong>　Consider a point \(\mathbf y\) on \(C\). The tangent line at \(\mathbf y\) is \(C\mathbf y\), and this line contains \(\mathbf x\) if \(\mathbf x^TC\mathbf y = 0\). Using the symmetry of \(C\), the condition \(\mathbf x^TC\mathbf y = (C\mathbf x)^T\mathbf y = 0\) is that the point \(\mathbf y\) lies on the line \(C\mathbf x\). Thus the polar line \(C\mathbf x\) intersects the conic in the point \(\mathbf y\) at
which the tangent line contains \(\mathbf x\).
-->
</p><p>
点 x が円錐曲線に近づくにつれて、接線は一直線に近づき、円錐曲線上の接点も近づきます。x が \(C\) 上にある極限では、極線は \(\mathbf x\) で2点接触し、以下の関係が成り立ちます。

• 点 \(\mathbf x\) が \(C\) 上にある場合、極線は \(\mathbf x\) における円錐曲線の接線です。
結果 2.7 を参照してください。
<!--
As the point x approaches the conic the tangent lines become closer to collinear, and their contact points on the conic also become closer. In the limit that x lies on \(C\), the
polar line has two-point contact at \(\mathbf x\), and we have:


• If the point \(\mathbf x\) is on \(C\) then the polar is the tangent line to the conic at \(\mathbf x\).
See result 2.7.
-->
</p><p>
<strong>例 2.28</strong>　\(x\)軸を中心とし\(x = a\)にある半径\(r\)の円は、方程式\((x − a)^2 + y^2 = r^2\)を持ち、円錐行列で表される。
<!--
<strong>Example 2.28</strong>　A circle of radius \(r\) centred on the \(x\)-axis at \(x = a\) has the equation \((x − a)^2 + y^2 = r^2\), and is represented by the conic matrix
-->
\[
C =
\begin{bmatrix}
1 & 0 & -a \\
0 & 1 & 0 \\
-a & 0 & a^2-r^2
\end{bmatrix}
\]
原点の極線は \(\mathbf l = C(0, 0, 1)^T = (−a, 0, a2 − r2)^T\) で与えられます。これは \(x = (a^2 − r^2)/a\) における垂直線です。\(r = a\) の場合、原点は円周上にあります。この場合、極線は \(y\) 軸であり、円周に接します。△
<!--
The polar line of the origin is given by \(\mathbf l = C(0, 0, 1)^T = (−a, 0, a2 − r2)^T\). This is a vertical line at \(x = (a^2 − r^2)/a\). If \(r = a\) the origin lies on the circle. In this case the
polar line is the \(y\)-axis and is tangent to the circle. △
-->
</p><p>
明らかに、円錐曲線は点と直線の間に \(\mathbb P^2\) の写像を誘導します。この写像は交差と接線のみを含むため射影的構成であり、どちらの性質も射影変換によって保存されます。点と直線の間の射影写像は相関と呼ばれます（より一般的な用法を考えると、これは不都合な名称です）。
<!--
It is evident that the conic induces a map between points and lines of \(\mathbb P^2\). This map is a projective construction since it involves only intersections and tangency, both properties
that are preserved under projective transformations. A projective map between
points and lines is termed a correlation (an unfortunate name, given its more common
usage).
-->
</p><p>
<strong>定義 2.29</strong> 相関とは、\(\mathbb P^2\) の点から \(\mathbb P^2\) の直線への可逆な写像である。これは 3 × 3 の非特異行列 \(A\) によって \(\mathbf l = A\mathbf x\) と表される。
<!--
<strong>Definition 2.29</strong>　A correlation is an invertible mapping from points of \(\mathbb P^2\) to lines of \(\mathbb P^2\). It is represented by a 3 × 3 non-singular matrix \(A\) as \(\mathbf l = A\mathbf x\).
-->
</p><p>
相関は、点と直線の関係を双対化する体系的な方法を提供します。相関は必ずしも対称行列で表す必要はありませんが、ここでは円錐曲線との関連性から、対称相関のみを扱います。
• 共役点。点 y が直線 \(\mathbf l = C\mathbf x\) 上にある場合、\(\mathbf y^T\mathbf l = \mathbf y^TC\mathbf x = 0\) となります。\(\mathbf y^TC\mathbf x = 0\) を満たす任意の2点 \(\mathbf x, \mathbf y\) は、円錐曲線 \(C\) に関して共役です。
共役関係は対称的です。
• \(\mathbf x\) が \(\mathbf y\) の極座標上にある場合、\(\mathbf y\) は \(\mathbf x\) の極座標上にあります。
<!--
A correlation provides a systematic way to dualize relations involving points and lines. It need not be represented by a symmetric matrix, but we will only consider symmetric correlations here, because of the association with conics.
• Conjugate points. If the point y is on the line \(\mathbf l = C\mathbf x\) then \(\mathbf y^T\mathbf l = \mathbf y^TC\mathbf x = 0\). Any
two points \(\mathbf x, \mathbf y\) satisfying \(\mathbf y^TC\mathbf x = 0\) are conjugate with respect to the conic \(C\).
The conjugacy relation is symmetric:
• If \(\mathbf x\) is on the polar of \(\mathbf y\) then \(\mathbf y\) is on the polar of \(\mathbf x\).
-->
</p><p>
これは、円錐行列の対称性から単純に導かれます。つまり、\(\mathbf x^TC\mathbf y = 0\) のとき、点 \(\mathbf x\) は \(\mathbf y\) の極座標上にあり、\(\mathbf y^TC\mathbf x = 0\) のとき、点 \(\mathbf y\) は \(\mathbf x\) の極座標上にあります。\(\mathbf x^TC\mathbf y = \mathbf y^TC\mathbf x\) であるため、一方の形式がゼロであれば、もう一方もゼロです。直線には双対共役関係があります。つまり、2つの直線 \(\mathbf l\) と \(\mathbf m\) は、\(\mathbf l^TC^∗\mathbf m = 0\) のとき共役です。
<!--
This follows simply because of the symmetry of the conic matrix – the point \(\mathbf x\) is on the polar of \(\mathbf y\) if \(\mathbf x^TC\mathbf y = 0\), and the point \(\mathbf y\) is on the polar of \(\mathbf x\) if \(\mathbf y^TC\mathbf x = 0\). Since \(\mathbf x^TC\mathbf y = \mathbf y^TC\mathbf x\), if one form is zero, then so is the other. There is a dual conjugacy relationship for lines: two lines \(\mathbf l\) and \(\mathbf m\) are conjugate if \(\mathbf l^TC^∗\mathbf m = 0\).
-->
</p>
<h4>2.8.2 円錐曲線の分類</h4>
<!--
<h4>2.8.2 Classification of conics</h4>
-->
<p>
この節では、円錐曲線の射影変換とアフィン変換について説明します。
円錐曲線の射影正規形。\(C\) は対称行列であるため、実固有値を持ち、積 \(C = U^TDU\) に分解できます (A4.2 節を参照)。
ここで \(U\) は直交行列、\(D\) は対角行列です。\(U\) で表される射影変換を適用すると、円錐曲線 \(C\) は別の円錐曲線 \(C^\prime = U^{−T}CU^{−1} =U^{−T}U^TDUU^{−1} = D\) に変換されます。これは、任意の円錐曲線が射影変換によって対角行列を持つ円錐曲線と等価であることを示しています。 \(D = diag(\epsilon_1d_1, \epsilon_2d_2, \epsilon_3d_3)\) とします。ただし、\(\epsilon_i = ±1\) または 0
かつ各 \(d_i > 0\) です。したがって、\(D\) は次の式で表されます。
<!--
This section describes the projective and affine classification of conics.
Projective normal form for a conic. Since \(C\) is a symmetric matrix it has real eigenvalues,
and may be decomposed as a product \(C = U^TDU\) (see section A4.2),
where \(U\) is an orthogonal matrix, and \(D\) is diagonal. Applying the projective transformation represented by \(U\), conic \(C\) is transformed to another conic \(C^\prime = U^{−T}CU^{−1} =U^{−T}U^TDUU^{−1} = D\). This shows that any conic is equivalent under projective transformation
to one with a diagonal matrix. Let \(D = diag(\epsilon_1d_1, \epsilon_2d_2, \epsilon_3d_3)\) where \(\epsilon_i = ±1\) or 0
and each \(d_i > 0\). Thus, \(D\) may be written in the form
-->
\[
D = diag(s_1, s_2, s_3)^Tdiag(\epsilon_1, \epsilon_2, \epsilon_3)diag(s_1, s_2, s_3)
\]
ここで \(s_i^2 = d_i\) です。\(diag(s_1, s_2, s_3)^T = diag(s_1, s_2, s_3)\) であることに注意してください。ここで、変換 \(diag(s_1, s_2, s_3)\) によってもう一度変換すると、円錐曲線 \(D\) は、各 \(\epsilon_i = ±1\) または 0 を持つ行列 \(diag(\epsilon_1, \epsilon_2, \epsilon_3)\) を持つ円錐曲線に変換されます。さらに、順列行列による変換を実行して、値 \(\epsilon_i = 1\) が値 \(\epsilon_i = −1\) の前に出現し、値が値 \(\epsilon_i = 0\) の前に出現するようにすることができます。最後に、必要であれば-1を掛けることで、+1の要素が-1の要素と少なくとも同数になるようにします。様々な種類の双曲線を列挙することができ、表2.2に示します。
<!--
where \(s_i^2 = d_i\). Note that \(diag(s_1, s_2, s_3)^T = diag(s_1, s_2, s_3)\). Now, transforming once
more by the transformation \(diag(s_1, s_2, s_3)\), the conic \(D\) is transformed to a conic with
matrix \(diag(\epsilon_1, \epsilon_2, \epsilon_3)\), with each \(\epsilon_i = ±1\) or 0. Further transformation by permutation
matrices may be carried out to ensure that values \(\epsilon_i = 1\) occur before values \(\epsilon_i = −1\) which in turn precede values \(\epsilon_i = 0\). Finally, by multiplying by −1 if necessary, one
may ensure that there are at least as many +1 entries as −1. The various types of conics
may now be enumerated, and are shown in table 2.2.
-->


\[
\begin{array}{l}
\hline
Diagonal & Equation & Conic\;type \\
\hline
(1, 1, 1) & x^2 + y^2 + w^2 = 0 & Improper\; conic\; –\; no\; real\; points. \\
(1, 1,−1) & x^2 + y^2 − w^2 = 0 & Circle \\
(1, 1, 0) & x^2 + y^2 = 0 & Single\; real\; point\; (0, 0, 1)^T \\
(1,−1, 0) & x^2 − y^2 = 0 & Two\; lines\; x = ±y \\
(1, 0, 0) & x^2 = 0 & Single\; line\; x = 0\; counted\; twice.　\\
\hline
\end{array}
\]
</P>
<center><img src="images/table2_2.png"></center>
<p>
表2.2. 点円錐曲線の射影分類。任意の平面円錐曲線は、この表に示すいずれかのタイプと射影的に同値です。ある\(i\)に対して\(\epsilon_i = 0\)となる円錐曲線は退化円錐曲線と呼ばれ、階数が3未満の行列で表されます。円錐曲線のタイプの列は、円錐曲線の実数点のみを記述します。例えば、複素円錐曲線\(x^2+y^2 = 0\)は直線対\(x = ±iy\)で構成されます。
<!--
Table 2.2. Projective classification of point conics. Any plane conic is projectively equivalent to one
of the types shown in this table. Those conics for which \(\epsilon_i = 0\) for some \(i\) are known as degenerate
conics, and are represented by a matrix of rank less than 3. The conic type column only describes the
real points of the conics – for example as a complex conic \(x^2+y^2 = 0\) consists of the line pair \(x = ±iy\).
-->
</p><p>
<strong>円錐曲線のアフィン分類</strong>　ユークリッド幾何学における（非退化、真円）円錐曲線の双曲線、楕円、放物線への分類はよく知られています。上に示したように、射影幾何学では、これら3種類の円錐曲線は円に射影的に同値です。しかし、アフィン幾何学においてもユークリッド分類は有効です。なぜなら、それは円錐曲線に対する\(\mathbf l_∞\)の関係のみに依存するからです。3種類の円錐曲線の関係は図2.20に示されています。
<!--
<strong>Affine classification of conics</strong>　The classification of (non-degenerate, proper) conics
in Euclidean geometry into hyperbola, ellipse and parabola is well known. As shown
above in projective geometry these three types of conic are projectively equivalent to
a circle. However, in affine geometry the Euclidean classification is still valid because
it depends only on the relation of \(\mathbf l_∞\) to the conic. The relation for the three types of
conic is illustrated in figure 2.20.
-->
</p>
<center><img src="images/fig2_20.png"></center>
<p>
図2.20. 点円錐曲線のアフィン分類。円錐曲線は、(a) 楕円、(b) 放物線、(c) 双曲線のいずれかに分類されます。これは、(a) 実交点を持たないか、(b) 接線（2点接触）を持つか、(c) \(\mathbf l_∞\) と2つの実交点を持つかによって分類されます。アフィン変換において、\(\mathbf l_∞\) は固定直線となり、交点は保存されます。したがって、この分類はアフィン変換によって変更されません。
<!--
Fig. 2.20. Affine classification of point conics. A conic is an (a) ellipse, (b) parabola, or (c) hyperbola;
according to whether it (a) has no real intersection, (b) is tangent to (2-point contact), or (c) has 2 real
intersections with \(\mathbf l_∞\). Under an affine transformation \(\mathbf l_∞\) is a fixed line, and intersections are preserved.
Thus this classification is unaltered by an affinity.
-->

</p><p>
<h2><center>2.9 固定点と固定線</center></h2>
<!--
<h2><center>2.9 Fixed points and lines</center></h2>
-->
<p>
\(\mathbf l_∞\) と円点の例から、点と直線は射影変換によって固定できることを見てきました。この節では、この考え方をさらに詳しく検討します。
<!--
We have seen, by the examples of \(\mathbf l_∞\) and the circular points, that points and lines may
be fixed under a projective transformation. In this section the idea is investigated more
thoroughly.
-->
</p><p>
ここで、変換元と変換先の平面は同一であると識別されるため、変換は点 \(\mathbf x\) を同じ座標系の点 \(\mathbf x^\prime\) に写像します。重要な考え方は、固有ベクトルが変換の固定点に対応するということです。固有値 λ を持つ固有ベクトル e に対して、
<!--
Here, the source and destination planes are identified (the same) so that the transformation
maps points \(\mathbf x\) to points \(\mathbf x^\prime\) in the same coordinate system. The key idea
is that an eigenvector corresponds to a fixed point of the transformation, since for an
eigenvector e with eigenvalue λ,
-->
\[
H_{\mathbf e} = λ_{\mathbf e}
\]
そして、\(\mathbf e\) と \(λ\mathbf e\) は同じ点を表します。コンピュータービジョンアプリケーションでは、固有ベクトルと固有値が物理的または幾何学的な意味を持つことがよくあります。
<!--
and \(\mathbf e\) and \(λ\mathbf e\) represent the same point. Often the eigenvector and eigenvalue have
physical or geometric significance in computer vision applications.
-->
</p><p>
3×3行列は3つの固有値を持ち、その結果、平面射影変換は、固有値が互いに異なる場合、最大3つの固定点を持つ。この場合、特性方程式は3次方程式であるため、固有値とそれに対応する固有ベクトルの1つまたは3つは実数である。同様の展開は固定直線についても可能であり、直線は(2.6) \(\mathbf l^\prime = H^{−T}\mathbf l\) と変換されるため、\(H^T\)の固有ベクトルに対応する。
<!--
A 3×3 matrix has three eigenvalues and consequently a plane projective transformation
has up to three fixed points, if the eigenvalues are distinct. Since the characteristic
equation is a cubic in this case, one or three of the eigenvalues, and corresponding
eigenvectors, is real. A similar development can be given for fixed lines, which, since
lines transform as (2.6) \(\mathbf l^\prime = H^{−T}\mathbf l\), correspond to the eigenvectors of \(H^T\).
-->
</p><p>
固定点と固定直線の関係は図2.21に示されています。
直線は点ごとに固定されるのではなく、集合として固定されていることに注意してください。つまり、直線上の点は直線上の別の点に写像されますが、一般に、始点と終点は異なります。
ここには不思議な点はありません。平面の射影変換は、直線上に1次元の射影変換を誘導します。1次元の射影変換は、2×2同次行列で表されます（セクション2.5）。この1次元の射影性は、2×2行列の2つの固有ベクトルに対応する2つの固定点を持ちます。これらの固定点は、2次元の射影変換の固定点です。
<!--
The relationship between the fixed points and fixed lines is shown in figure 2.21.
Note the lines are fixed as a set, not fixed pointwise, i.e. a point on the line is mapped
to another point on the line, but in general the source and destination points will differ.
There is nothing mysterious here: The projective transformation of the plane induces a
1D projective transformation on the line. A 1D projective transformation is represented
by a 2×2 homogeneous matrix (section 2.5). This 1D projectivity has two fixed points
corresponding to the two eigenvectors of the 2×2 matrix. These fixed points are those
of the 2D projective transformation.
-->
</p>
<center><img src="images/fig2_21.png"></center>
<p>
図2.21. 平面射影変換における不動点と不動直線。3つの不動点と、これらの点を通る3本の固定直線があります。固定直線​​と点は複素数になる場合があります。代数的には、不動点は点変換の固有ベクトル (\(\mathbf x^\prime = H\mathbf x\)) であり、固定直線は直線変換の固有ベクトル (\(\mathbf l^\prime = H^{−T}\mathbf l\)) です。固定直線​​は点ごとに固定されているわけではないことに注意してください。変換においては、直線上の点は直線上の他の点に写像されますが、固定点のみが自分自身に写像されます。
<!--
Fig. 2.21. Fixed points and lines of a plane projective transformation. There are three fixed points,
and three fixed lines through these points. The fixed lines and points may be complex. Algebraically,
the fixed points are the eigenvectors, \(e_i\), of the point transformation (\(\mathbf x^\prime = H\mathbf x\)), and the fixed lines
eigenvectors of the line transformation (\(\mathbf  l^\prime = H^{−T}\mathbf l\)). Note, the fixed line is not fixed pointwise: under
the transformation, points on the line are mapped to other points on the line; only the fixed points are
mapped to themselves.
-->
</p><p>
さらに特殊化して、重複する固有値について考察します。2つの固有値(\(λ_2, λ_3\)とします)が同一であり、2つの異なる固有ベクトル(\(\mathbf e_2, \mathbf e_3\))があり、\(λ_2 = λ_3\)に対応するとします。この場合、固有ベクトル\(\mathbf e_2, \mathbf e_3\)を含む直線は、点ごとに固定されます。つまり、固定点の直線となります。\(\mathbf x = α\mathbf e_2 + β\mathbf e_3\)とします。
<!--
A further specialization concerns repeated eigenvalues. Suppose two of the eigenvalues
(\(λ_2, λ_3\) say) are identical, and that there are two distinct eigenvectors (\(\mathbf e_2, \mathbf e_3\)),
corresponding to \(λ_2 = λ_3\). Then the line containing the eigenvectors \(\mathbf e_2, \mathbf e_3\) will be
fixed pointwise, i.e. it is a line of fixed points. For suppose \(\mathbf x = α\mathbf e_2 + β\mathbf e_3\); then
-->
\[
H\mathbf x = λ_2α\mathbf e_2 + λ_2β\mathbf e_3 = λ_2\mathbf x
\]
すなわち、2つの退化した固有ベクトルを通る直線上の点は、（スケールのみが異なる）それ自身に写像されます。別の可能性として、\(λ_2 = λ_3\) ですが、対応する固有ベクトルは1つしかありません。この場合、固有ベクトルの代数次元は2ですが、幾何学的次元は1です。そのため、固定点は1つ少なくなります（3つではなく2つ）。重複する固有値の様々なケースについては、付録7でさらに詳しく説明します。
<!--
i.e. a point on the line through two degenerate eigenvectors is mapped to itself (only
differing by scale). Another possibility is that \(λ_2 = λ_3\), but that there is only one
corresponding eigenvector. In this case, the eigenvector has algebraic dimension equal
to two, but geometric dimension equal to one. Then there is one fewer fixed point (2
instead of 3). Various cases of repeated eigenvalues are discussed further in appendix 7.
-->
</p><p>
ここで、第2.4節の射影変換部分群の階層構造における不動点と不動直線について考察する。アフィン変換、およびより特殊化された形式は、理想点 (\(x_3 = 0\)) である2つの固有ベクトルを持ち、これらは左上の2×2行列の固有ベクトルに対応する。3つ目の固有ベクトルは一般に有限である。
<!--
We now examine the fixed points and lines of the hierarchy of projective transformation
subgroups of section 2.4. Affine transformations, and the more specialized forms,
have two eigenvectors which are ideal points (\(x_3 = 0\)), and which correspond to the
eigenvectors of the upper left 2 × 2 matrix. The third eigenvector is finite in general.
-->
</p><p>
<strong>ユークリッド行列</strong>　2つの理想的な固定点は、複素共役な円点のペア\(\mathbf I, \mathbf J\)であり、対応する固有値は{\(e^{i\theta}, e^{−i\theta}\)}です。ここで、\(θ\)は回転角です。
単位固有値を持つ3番目の固有ベクトルは極と呼ばれます。ユークリッド変換は、この点を中心に\(θ\)だけ回転することと等しく、平行移動は行いません。
<!--
<strong>A Euclidean matrix</strong>　The two ideal fixed points are the complex conjugate pair of circular
points \(\mathbf I, \mathbf J\), with corresponding eigenvalues {\(e^{i\theta}, e^{−i\theta}\)}, where \(θ\) is the rotation angle.
The third eigenvector, which has unit eigenvalue, is called the pole. The Euclidean
transformation is equal to a pure rotation by \(θ\) about this point with no translation.
-->
</p><p>
特別なケースとして、純粋な並進（すなわち \(θ = 0\) の場合）があります。ここでは固有値は三重に退化しています。無限遠直線は各点ごとに固定され、並進方向に対応する点 \((t_x, t_y, 0)^T\) を通る固定直線の束が存在します。結果として、t に平行な直線は固定されます。これは elation の例です（セクション A7.3 を参照）。
<!--
A special case is that of a pure translation (i.e. where \(θ = 0\)). Here the eigenvalues
are triply degenerate. The line at infinity is fixed pointwise, and there is a pencil of
fixed lines through the point \((t_x, t_y, 0)^T\) which corresponds to the translation direction.
Consequently lines parallel to t are fixed. This is an example of an elation (see section
A7.3).
-->
</p><p>
<strong>相似行列</strong>　2つの理想的な固定点は、再び円点です。固有値は{\(1, se^{i\theta}, se^{−i\theta}\)}です。作用は、有限の固定点を中心としたsによる回転と等方的なスケーリングとして理解できます。円点の固有値は、再び回転角度を符号化していることに注意してください。
<!--
<strong>A similarity matrix</strong>　The two ideal fixed points are again the circular points. The
eigenvalues are {\(1, se^{i\theta}, se^{−i\theta}\)}. The action can be understood as a rotation and
isotropic scaling by s about the finite fixed point. Note that the eigenvalues of the
circular points again encode the angle of rotation.
-->
</p><p>
<strong>アフィン行列</strong>　2つの理想的な固定点は実共役でも複素共役でも構いませんが、これらの点を通る固定直線 \(\mathbf l_∞ = (0, 0, 1)^T\) はどちらの場合でも実数です。
<!--
<strong>An affine matrix</strong>　The two ideal fixed points can be real or complex conjugates, but
the fixed line \(\mathbf l_∞ = (0, 0, 1)^T\) through these points is real in either case.
-->
</p>
<h2><center>2.10 むすび</center></h2>
<h3>2.10.1 文献</h3>
<!--
<h2><center>2.10 Closure</center></h2>
<h3>2.10.1 The literature</h3>
-->
<p>
コンピュータビジョン研究者向けに書かれた平面射影幾何学の分かりやすい入門書が、MundyとZisserman [Mundy-92]の付録に掲載されています。より正式なアプローチはSempleとKneebone [Semple-79]によるものですが、[Springer-64]の方が読みやすいです。
<!--
A gentle introduction to plane projective geometry, written for computer vision researchers,
is given in the appendix of Mundy and Zisserman [Mundy-92]. A more
formal approach is that of Semple and Kneebone [Semple-79], but [Springer-64] is
more readable.
-->
</p><p>
画像化された平面のアフィンおよびメトリックシーン特性の復元に関して、CollinsとBeveridge [Collins-93]は消失線を用いて衛星画像からアフィン特性を復元し、LiebowitzとZisserman [Liebowitz-98]は直角などの平面上のメトリック情報を用いてメトリック幾何学を復元した。
<!--
On the recovery of affine and metric scene properties for an imaged plane, Collins
and Beveridge [Collins-93] use the vanishing line to recover affine properties from
satellite images, and Liebowitz and Zisserman [Liebowitz-98] use metric information
on the plane, such as right angles, to recover the metric geometry.
-->
</p>
<h3>2.10.2 ノートと演習</h3>
<!--
<h3>2.10.2 Notes and exercises</h3>
-->
<p>
<div class="styleBullet">
<ul>
<li>(i) <strong>アフィン変換</strong>
<ul>
<li>(a) アフィン変換は円を楕円に写像できるが、楕円を双曲線や放物線に写像することはできないことを示せ。
</li><br><li>(b) アフィン変換において、平行線上の長さの比は不変であるが、平行でない2つの長さの比は不変ではないことを証明せよ。</li>
</ul>
</li><br><li>(ii) <strong>射影変換</strong>　原点に単位円を（集合として）固定する、つまり原点の単位円が原点の単位円に写像される、3パラメータの射影変換族が存在することを示せ（ヒント：結果2.13を用いて変換を計算せよ）。この族の幾何学的解釈は何か？
</li><br><li>(iii) <strong>等方性</strong>　二直線は相似変換に対して不変量を持つこと、また二直線と二点は射影変換に対して不変量を持つことを示せ。どちらの場合も、計数論の等式ケース（結果2.16）は破れている。これら2つの場合において、それぞれの変換は部分的には決定されるものの、完全には決定できないことを示せ。 </li><br><li>(iv) <strong>不変式</strong>　点、直線、円錐曲線の変換規則を用いて、次の式を示します。
<ul>
<li>(a) 2直線 \(\mathbf l_1, \mathbf l_2\) と、それらの直線上にない2点 \(\mathbf x_1, \mathbf x_2\) には、不変式があります。
\[
I =\frac{(\mathbf l_1^T\mathbf x_1)(\mathbf l_2^T\mathbf x_2)}{(\mathbf l_1^T\mathbf x_2)(\mathbf l_2^T\mathbf x_1)}
\]
(前の質問を参照)。
</li><br><li>(b) 円錐曲線 C と一般位置にある2点 x1、x2 には、不変量
\[
I=\frac{(\mathbf x_1^TC\mathbf x_2)^2}{(\mathbf x_1^TC\mathbf x_1)(\mathbf x_2^TC\mathbf x_2)}
\]
</li><br><li>(c) 角度の測定に関する射影不変式 (2.22) が、円周点との複比を含むラゲールの射影不変式 ([Springer-64] 参照) と等価であることを示す。</li>
</ul>
</li><br><li>(v) <strong>複比</strong>　直線 (2.18) の射影変換に対して、同一線上にある4点の複比が不変であることを証明せよ。ヒント：直線上の2点の変換から始めてください。\(\overline{\mathbf x}_i^\prime = λ_iH_{2×2}\overline{\mathbf x}_i\) と \(\overline{\mathbf x}_j^\prime=\lambda_jH_{2\times 2}\overline{\mathbf x}_j\) ですが、等式はスケールどおりではありません。次に、行列式の性質から、\(|\overline{\mathbf x}_i^\prime\overline{x}_j^\prime|=\lambda_i\lambda_j det\,H_{2\times 2}|\overline{\mathbf x}_i\overline{\mathbf x}_j|\) であることを示します。
ここから続けてください。別の導出法は [Semple-79] に示されている。
</li><br><li>(vi) <strong>極性</strong> 図 2.19 は、楕円の外側にある点 \(\mathbf x\) に対する極直線の幾何学的作図を示している。点が楕円の内側にある場合の極直線の幾何学的作図を記述せよ。ヒント：まず \(\mathbf x\) を通る任意の直線を選ぶ。この直線の極は、\(\mathbf x\) の極上の点である。
</li><br><li>(vii) <strong>円錐曲線</strong>　円錐行列 \(C\) の符号が、2つの固有値が正で1つが負となるように選ばれる場合、\(\mathbf x^TC\mathbf x\) の符号によって内部点と外部点を区別することができる。\(\mathbf x^TC\mathbf x\) が負/ゼロ/正のとき、点 \(\mathbf x\) は円錐曲線 \(C\) の内側/上/外側にある。これは、円 \(C = diag(1, 1,−1)\) の例でわかる。射影変換のもとでは内部性は不変であるが、楕円を双曲線に変換する場合にはその解釈に注意が必要である（図2.20 参照）。
</li><br><li>(viii) <strong>双対円錐曲線</strong>　行列 \([\mathbf l]_×C[\mathbf l]_×\) が、直線 l が（点）円錐曲線 \(C\) と交差する2点からなる階数2の双対円錐曲線を表すことを示せ（表記 \([\mathbf l]_×\) は (A4.5) で定義されている）。
</li><br><li>(ix) <strong>特殊な射影変換</strong>　例えば左右対称の平面物体など、ある場面の平面上の点が直線の鏡映によって関連しているとしよう。
平面の透視図において、点は射影性によって関連し、\(H\) が \(H^2 = I\) を満たすことを示す。さらに、H の下には、像反射線に対応する不動点の直線が存在し、H はこの直線上にない固有ベクトル（反射方向の消失点）を持つことを示します（\(H\) は平面調和ホモロジーです。A7.2 節を参照）。
ここで、点が有限回転対称性によって関連していると仮定します。例えば、六角形のボルトの頭上の点です。この場合、\(H^n = I\) であることを示します。ここで、\(n\) は回転対称性の次数（六角対称の場合は 6）です。
H の固有値が回転角を決定し、実固有値に対応する固有ベクトルが回転対称の中心の像であることを示します。</li>
<!--
<li>(i) <strong>Affine transformations</strong>
<ul>
<li>(a) Show that an affine transformation can map a circle to an ellipse, but
cannot map an ellipse to a hyperbola or parabola.
</li><br><li>(b) Prove that under an affine transformation the ratio of lengths on parallel
line segments is an invariant, but that the ratio of two lengths that are
not parallel is not.</li>
</ul>
</li><br><li>(ii) <strong>Projective transformations</strong>　Show that there is a three-parameter family of
projective transformations which fix (as a set) a unit circle at the origin, i.e. a
unit circle at the origin is mapped to a unit circle at the origin (hint, use result
2.13 to compute the transformation). What is the geometric interpretation
of this family?
</li><br><li>(iii) <strong>Isotropies</strong>　Show that two lines have an invariant under a similarity transformation;
and that two lines and two points have an invariant under a projective
transformation. In both cases the equality case of the counting argument (result
2.16) is violated. Show that for these two cases the respective transformation
cannot be fully determined, although it is partially determined.
</li><br><li>(iv) <strong>Invariants</strong>　Using the transformation rules for points, lines and conics show:
<ul>
<li>(a) Two lines, \(\mathbf l_1, \mathbf l_2\), and two points, \(\mathbf x_1,\mathbf  x_2\), not lying on the lines have the invariant
\[
I =\frac{(\mathbf l_1^T\mathbf x_1)(\mathbf l_2^T\mathbf x_2)}{(\mathbf l_1^T\mathbf x_2)(\mathbf l_2^T\mathbf x_1)}
\]
(see the previous question).
</li><br><li>(b) A conic C and two points, x1 and x2, in general position have the invariant
\[
I=\frac{(\mathbf x_1^TC\mathbf x_2)^2}{(\mathbf x_1^TC\mathbf x_1)(\mathbf x_2^TC\mathbf x_2)}
\]
</li><br><li>(c) Show that the projectively invariant expression for measuring angles
(2.22) is equivalent to Laguerre's projectively invariant expression
involving a cross ratio with the circular points (see [Springer-64]).</li>
</ul>
</li><br><li>(v) <strong>The cross ratio</strong>　Prove the invariance of the cross ratio of four collinear
points under projective transformations of the line (2.18). Hint, start with
the transformation of two points on the line written as \(\overline{\mathbf x}_i^\prime = λ_iH_{2×2}\overline{\mathbf x}_i\) and \(\overline{\mathbf x}_j^\prime=\lambda_jH_{2\times 2}\overline{\mathbf x}_j\), where equality is not up to scale, then from the properties of determinants show that \(|\overline{\mathbf x}_i^\prime\overline{x}_j^\prime|=\lambda_i\lambda_j det\,H_{2\times 2}|\overline{\mathbf x}_i\overline{\mathbf x}_j|\)
and continue from here.
An alternative derivation method is given in [Semple-79].
</li><br><li>(vi) <strong>Polarity</strong>　Figure 2.19 shows the geometric construction of the polar line for a
point \(\mathbf x\) outside an ellipse. Give a geometric construction for the polar when the
point is inside. Hint, start by choosing any line through \(\mathbf x\). The pole of this line
is a point on the polar of \(\mathbf x\).
</li><br><li>(vii) <strong>Conics</strong>　If the sign of the conic matrix \(C\) is chosen such that two eigenvalues
are positive and one negative, then internal and external points may be distinguished
according to the sign of \(\mathbf x^TC\mathbf x\): the point \(\mathbf x\) is inside/on/outside the conic
\(C\) if \(\mathbf x^TC\mathbf x\) is negative/zero/positive respectively. This can seen by example from
a circle \(C = diag(1, 1,−1)\). Under projective transformations internality is invariant,
though its interpretation requires care in the case of an ellipse being
transformed to a hyperbola (see figure 2.20).
</li><br><li>(viii) <strong>Dual conics</strong>　Show that the matrix \([\mathbf l]_×C[\mathbf l]_×\) represents a rank 2 dual conic
which consists of the two points at which the line l intersects the (point) conic
\(C\) (the notation \([\mathbf l]_×\) is defined in (A4.5)).
</li><br><li>(ix) <strong>Special projective transformations</strong>　Suppose points on a scene plane are related
by reflection in a line: for example, a plane object with bilateral symmetry.
Show that in a perspective image of the plane the points are related by a projectivity
\(H\) satisfying \(H^2 = I\). Furthermore, show that under H there is a line
of fixed points corresponding to the imaged reflection line, and that H has an
eigenvector, not lying on this line, which is the vanishing point of the reflection
direction (\(H\) is a planar harmonic homology, see section A7.2).
Now suppose that the points are related by a finite rotational symmetry: for
example, points on a hexagonal bolt head. Show in this case that \(H^n = I\),
where \(n\) is the order of rotational symmetry (6 for a hexagonal symmetry),
that the eigenvalues of H determine the rotation angle, and that the eigenvector
corresponding to the real eigenvalue is the image of the centre of the rotational
symmetry.</li>
-->
</ul>
</div>
</p><p>
    </body>
</html>
